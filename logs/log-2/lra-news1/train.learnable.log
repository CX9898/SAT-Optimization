GPU list: [0, 1, 2, 3]
[
    {
        "learn_pos_emb": true,
        "tied_weights": false,
        "embedding_dim": 64,
        "transformer_dim": 64,
        "transformer_hidden_dim": 128,
        "head_dim": 32,
        "num_head": 2,
        "num_layers": 4,
        "vocab_size": 512,
        "max_seq_len": 1024,
        "dropout_prob": 0.1,
        "attention_dropout": 0.1,
        "pooling_mode": "MEAN",
        "num_classes": 4,
        "block_size": 32,
        "batch_size": 128,
        "density": 0.08,
        "mixed_precision": true,
        "random_seed": 2,
        "task": "lra-news1"
    },
    {
        "batch_size": 512,
        "learning_rate": 0.0009,
        "warmup": 80,
        "lr_decay": "linear",
        "weight_decay": 0,
        "eval_frequency": 200,
        "num_train_steps": 30000,
        "num_init_steps": 3000,
        "num_eval_steps": 200,
        "num_dense_train_steps": 1000,
        "patience": 10,
        "attn_loss_scale": 0.01
    }
]
attn_mask compile
attn_mask compile
attn_mask compile
attn_mask compile
DataParallel(
  (module): ModelForSC(
    (model): Model(
      (embeddings): Embeddings(
        (word_embeddings): Embedding(512, 64)
        (position_embeddings): Embedding(1024, 64)
        (dropout): Dropout(p=0.1, inplace=False)
      )
      (transformer_0): TransformerLayer(
        (norm1): LayerNorm((64,), eps=1e-05, elementwise_affine=True)
        (mha): Attention(
          (W_q): Linear(in_features=64, out_features=64, bias=True)
          (W_k): Linear(in_features=64, out_features=64, bias=True)
          (W_v): Linear(in_features=64, out_features=64, bias=True)
          (avg_pool): AvgPool2d(kernel_size=32, stride=32, padding=0)
          (MSEloss): MSELoss()
          (attn): CUDAMaskAttention()
          (ff): Linear(in_features=64, out_features=64, bias=True)
        )
        (dropout1): Dropout(p=0.1, inplace=False)
        (norm2): LayerNorm((64,), eps=1e-05, elementwise_affine=True)
        (mlpblock): Sequential(
          (0): Linear(in_features=64, out_features=128, bias=True)
          (1): GELU(approximate='none')
          (2): Dropout(p=0.1, inplace=False)
          (3): Linear(in_features=128, out_features=64, bias=True)
          (4): Dropout(p=0.1, inplace=False)
        )
      )
      (transformer_1): TransformerLayer(
        (norm1): LayerNorm((64,), eps=1e-05, elementwise_affine=True)
        (mha): Attention(
          (W_q): Linear(in_features=64, out_features=64, bias=True)
          (W_k): Linear(in_features=64, out_features=64, bias=True)
          (W_v): Linear(in_features=64, out_features=64, bias=True)
          (avg_pool): AvgPool2d(kernel_size=32, stride=32, padding=0)
          (MSEloss): MSELoss()
          (attn): CUDAMaskAttention()
          (ff): Linear(in_features=64, out_features=64, bias=True)
        )
        (dropout1): Dropout(p=0.1, inplace=False)
        (norm2): LayerNorm((64,), eps=1e-05, elementwise_affine=True)
        (mlpblock): Sequential(
          (0): Linear(in_features=64, out_features=128, bias=True)
          (1): GELU(approximate='none')
          (2): Dropout(p=0.1, inplace=False)
          (3): Linear(in_features=128, out_features=64, bias=True)
          (4): Dropout(p=0.1, inplace=False)
        )
      )
      (transformer_2): TransformerLayer(
        (norm1): LayerNorm((64,), eps=1e-05, elementwise_affine=True)
        (mha): Attention(
          (W_q): Linear(in_features=64, out_features=64, bias=True)
          (W_k): Linear(in_features=64, out_features=64, bias=True)
          (W_v): Linear(in_features=64, out_features=64, bias=True)
          (avg_pool): AvgPool2d(kernel_size=32, stride=32, padding=0)
          (MSEloss): MSELoss()
          (attn): CUDAMaskAttention()
          (ff): Linear(in_features=64, out_features=64, bias=True)
        )
        (dropout1): Dropout(p=0.1, inplace=False)
        (norm2): LayerNorm((64,), eps=1e-05, elementwise_affine=True)
        (mlpblock): Sequential(
          (0): Linear(in_features=64, out_features=128, bias=True)
          (1): GELU(approximate='none')
          (2): Dropout(p=0.1, inplace=False)
          (3): Linear(in_features=128, out_features=64, bias=True)
          (4): Dropout(p=0.1, inplace=False)
        )
      )
      (transformer_3): TransformerLayer(
        (norm1): LayerNorm((64,), eps=1e-05, elementwise_affine=True)
        (mha): Attention(
          (W_q): Linear(in_features=64, out_features=64, bias=True)
          (W_k): Linear(in_features=64, out_features=64, bias=True)
          (W_v): Linear(in_features=64, out_features=64, bias=True)
          (avg_pool): AvgPool2d(kernel_size=32, stride=32, padding=0)
          (MSEloss): MSELoss()
          (attn): CUDAMaskAttention()
          (ff): Linear(in_features=64, out_features=64, bias=True)
        )
        (dropout1): Dropout(p=0.1, inplace=False)
        (norm2): LayerNorm((64,), eps=1e-05, elementwise_affine=True)
        (mlpblock): Sequential(
          (0): Linear(in_features=64, out_features=128, bias=True)
          (1): GELU(approximate='none')
          (2): Dropout(p=0.1, inplace=False)
          (3): Linear(in_features=128, out_features=64, bias=True)
          (4): Dropout(p=0.1, inplace=False)
        )
      )
      (norm): LayerNorm((64,), eps=1e-05, elementwise_affine=True)
    )
    (seq_classifer): SCHead(
      (mlpblock): Sequential(
        (0): Linear(in_features=64, out_features=128, bias=True)
        (1): ReLU()
        (2): Linear(in_features=128, out_features=4, bias=True)
      )
    )
  )
)
parameter_size: [torch.Size([512, 64]), torch.Size([1024, 64]), torch.Size([64]), torch.Size([64]), torch.Size([32, 32]), torch.Size([64, 64]), torch.Size([64]), torch.Size([64, 64]), torch.Size([64]), torch.Size([64, 64]), torch.Size([64]), torch.Size([64, 64]), torch.Size([64]), torch.Size([64]), torch.Size([64]), torch.Size([128, 64]), torch.Size([128]), torch.Size([64, 128]), torch.Size([64]), torch.Size([64]), torch.Size([64]), torch.Size([32, 32]), torch.Size([64, 64]), torch.Size([64]), torch.Size([64, 64]), torch.Size([64]), torch.Size([64, 64]), torch.Size([64]), torch.Size([64, 64]), torch.Size([64]), torch.Size([64]), torch.Size([64]), torch.Size([128, 64]), torch.Size([128]), torch.Size([64, 128]), torch.Size([64]), torch.Size([64]), torch.Size([64]), torch.Size([32, 32]), torch.Size([64, 64]), torch.Size([64]), torch.Size([64, 64]), torch.Size([64]), torch.Size([64, 64]), torch.Size([64]), torch.Size([64, 64]), torch.Size([64]), torch.Size([64]), torch.Size([64]), torch.Size([128, 64]), torch.Size([128]), torch.Size([64, 128]), torch.Size([64]), torch.Size([64]), torch.Size([64]), torch.Size([32, 32]), torch.Size([64, 64]), torch.Size([64]), torch.Size([64, 64]), torch.Size([64]), torch.Size([64, 64]), torch.Size([64]), torch.Size([64, 64]), torch.Size([64]), torch.Size([64]), torch.Size([64]), torch.Size([128, 64]), torch.Size([128]), torch.Size([64, 128]), torch.Size([64]), torch.Size([64]), torch.Size([64]), torch.Size([128, 64]), torch.Size([128]), torch.Size([4, 128]), torch.Size([4])]
num_parameter: 245252
Loaded ../Skyformer/data/lra_processed/lra-news1.train.pickle... size=120000
Loaded ../Skyformer/data/lra_processed/lra-news1.dev.pickle... size=7600
Loaded ../Skyformer/data/lra_processed/lra-news1.test.pickle... size=7600
accumu_steps=1
[tensor([23.7259, 23.7259, 23.7259, 23.7259], device='cuda:0',
       grad_fn=<GatherBackward>), tensor([24.1806, 24.1806, 24.1806, 24.1806], device='cuda:0',
       grad_fn=<GatherBackward>), tensor([20.7154, 20.7154, 20.7154, 20.7154], device='cuda:0',
       grad_fn=<GatherBackward>), tensor([23.9872, 23.9872, 23.9872, 23.9872], device='cuda:0',
       grad_fn=<GatherBackward>)]
best model saved: step =  199 dev accu =  tensor(0.5941, device='cuda:0')

Validation Results
Global Steps: 199
Valid Loss: 0.99049
Valid Accuracy: 0.59410
time stamp: 158.98389315605164
[tensor([8.8337, 8.8337, 8.8337, 8.8337], device='cuda:0',
       grad_fn=<GatherBackward>), tensor([9.0168, 9.0168, 9.0168, 9.0168], device='cuda:0',
       grad_fn=<GatherBackward>), tensor([7.5718, 7.5718, 7.5718, 7.5718], device='cuda:0',
       grad_fn=<GatherBackward>), tensor([8.9602, 8.9602, 8.9602, 8.9602], device='cuda:0',
       grad_fn=<GatherBackward>)]
best model saved: step =  399 dev accu =  tensor(0.6120, device='cuda:0')

Validation Results
Global Steps: 399
Valid Loss: 0.94688
Valid Accuracy: 0.61199
time stamp: 315.48316168785095
[tensor([4.1093, 4.1093, 4.1093, 4.1093], device='cuda:0',
       grad_fn=<GatherBackward>), tensor([4.1849, 4.1849, 4.1849, 4.1849], device='cuda:0',
       grad_fn=<GatherBackward>), tensor([3.4856, 3.4856, 3.4856, 3.4856], device='cuda:0',
       grad_fn=<GatherBackward>), tensor([4.1647, 4.1647, 4.1647, 4.1647], device='cuda:0',
       grad_fn=<GatherBackward>)]

Validation Results
Global Steps: 599
Valid Loss: 0.95534
Valid Accuracy: 0.61015
time stamp: 472.5132839679718
[tensor([2.2519, 2.2519, 2.2519, 2.2519], device='cuda:0',
       grad_fn=<GatherBackward>), tensor([2.2805, 2.2805, 2.2805, 2.2805], device='cuda:0',
       grad_fn=<GatherBackward>), tensor([1.8980, 1.8980, 1.8980, 1.8980], device='cuda:0',
       grad_fn=<GatherBackward>), tensor([2.2712, 2.2713, 2.2712, 2.2713], device='cuda:0',
       grad_fn=<GatherBackward>)]
best model saved: step =  799 dev accu =  tensor(0.6253, device='cuda:0')

Validation Results
Global Steps: 799
Valid Loss: 0.91121
Valid Accuracy: 0.62526
time stamp: 629.179929971695
[tensor([1.3940, 1.3940, 1.3940, 1.3940], device='cuda:0',
       grad_fn=<GatherBackward>), tensor([1.4003, 1.4003, 1.4003, 1.4003], device='cuda:0',
       grad_fn=<GatherBackward>), tensor([1.1696, 1.1697, 1.1697, 1.1697], device='cuda:0',
       grad_fn=<GatherBackward>), tensor([1.3949, 1.3949, 1.3949, 1.3949], device='cuda:0',
       grad_fn=<GatherBackward>)]
best model saved: step =  999 dev accu =  tensor(0.6306, device='cuda:0')

Validation Results
Global Steps: 999
Valid Loss: 0.89973
Valid Accuracy: 0.63060
time stamp: 785.8028085231781
module.model.transformer_0.mha.pattern saved
module.model.transformer_1.mha.pattern saved
module.model.transformer_2.mha.pattern saved
module.model.transformer_3.mha.pattern saved
./pickle/lra-news1/module.model.transformer_0.mha.pattern.pickle
tensor([  66,  231,  198,  363,  726,  297,  132,  957,  396,    0, 1023,  627,
          99,  693,  924,  825,  330,   33,  264,  759,  990,  594,  660,  528,
         165,  561,  891,  429,  858,  236,  391,  139,  356,  792,  495,  147,
         612,  267,  360,  135,  228,  462,   75,  354,  150,  708,   19,  608,
         136,  260,  205,  422,  217,  806,   60,  897,  828,  921,  405,  684,
         798,  984,  310,  713,  529,  560,  140,  388,   68,  130,   92,  898,
          85,  674,  149,  676,  213,  678,   61,  929,   16], device='cuda:0')
tensor(81, device='cuda:0')
block_attn_mask compile
./pickle/lra-news1/module.model.transformer_1.mha.pattern.pickle
tensor([ 990,  495,  660,  462,  165,  825,  132,  891,  330,  528,  627,    0,
         693,  264, 1023,  363,  429,   99,  198,  957,  759,  792,  561,  231,
         396,  924,  858,  297,  726,   66,  143,  484,   33,  473,  814,  171,
         357,  382,  971,  670,  980,  463,  494,  894,  987,  668,  916,  661,
         692,    5,  160,  148,  644,  398,  460,  594,  187,  869,  510,  975,
         475,  878,  173,  421,   79,  482,  174,  453,  304,  521,   19,  608,
         535,  752,  366,  459,   26,  832,  144,  516,  333], device='cuda:0')
tensor(81, device='cuda:0')
block_attn_mask compile
./pickle/lra-news1/module.model.transformer_2.mha.pattern.pickle
tensor([ 396,  297, 1023,  858,  726,  462,  561,  957,  825,  660,   66,  363,
         264,   99,  429,  495,  330,  528,  891,  594,  132,  231,   33,  792,
         990,  627,  165,  924,  693,    0,  759,  198,  404,  652,  401,  556,
         409,  812,  118,  707,  332,  394,  735, 1014,  108,  387,  150,  708,
          46,  449,  400,  524,  159,  996,  413,  940,  397,  428,  302,  457,
         310,  713,   76,  386,  140,  388,   87,  738,  731,  886,  398,  460,
         364,  395,  826,  857,   73,  290,  529,  560,  564], device='cuda:0')
tensor(81, device='cuda:0')
block_attn_mask compile
./pickle/lra-news1/module.model.transformer_3.mha.pattern.pickle
tensor([ 858,  363,   99,  330,  198,  693,  924,  792,  660,  825,   66,    0,
         132,  429,  462,  297,  990,  231,  891,   33,  957,  759,  396,  165,
        1023,  264,  561,  495,  594,  726,  528,  331,  362,   28,  896,  661,
         692,  627,  760,  791,  203,  358,  121,  803,  110,  451,  341,  682,
         205,  422,  372,  651,    4,  128,  344,  778,  235,  359,  116,  643,
          84,  642,   10,  320,    2,   64,   74,  322,  148,  644,  668,  916,
         666,  852,  212,  646,  382,  971,   67,   98,  152], device='cuda:0')
tensor(81, device='cuda:0')
block_attn_mask compile
total pattern searching time (s): 0.09749889373779297
[]

Validation Results
Global Steps: 1199
Valid Loss: 0.92235
Valid Accuracy: 0.62389
time stamp: 826.8606998920441
[]
best model saved: step =  1399 dev accu =  tensor(0.6413, device='cuda:0')

Validation Results
Global Steps: 1399
Valid Loss: 0.88898
Valid Accuracy: 0.64133
time stamp: 867.6916198730469
[]
best model saved: step =  1599 dev accu =  tensor(0.6420, device='cuda:0')

Validation Results
Global Steps: 1599
Valid Loss: 0.89024
Valid Accuracy: 0.64204
time stamp: 908.6266810894012
[]
best model saved: step =  1799 dev accu =  tensor(0.6529, device='cuda:0')

Validation Results
Global Steps: 1799
Valid Loss: 0.86467
Valid Accuracy: 0.65295
time stamp: 949.5412919521332
[]

Validation Results
Global Steps: 1999
Valid Loss: 0.87650
Valid Accuracy: 0.64766
time stamp: 990.2439568042755
[]
best model saved: step =  2199 dev accu =  tensor(0.6604, device='cuda:0')

Validation Results
Global Steps: 2199
Valid Loss: 0.84928
Valid Accuracy: 0.66038
time stamp: 1031.4306876659393
[]
best model saved: step =  2399 dev accu =  tensor(0.6613, device='cuda:0')

Validation Results
Global Steps: 2399
Valid Loss: 0.84548
Valid Accuracy: 0.66133
time stamp: 1072.3476779460907
[]
best model saved: step =  2599 dev accu =  tensor(0.6619, device='cuda:0')

Validation Results
Global Steps: 2599
Valid Loss: 0.84508
Valid Accuracy: 0.66186
time stamp: 1113.217586517334
[]

Validation Results
Global Steps: 2799
Valid Loss: 0.85864
Valid Accuracy: 0.65698
time stamp: 1153.9187707901
[]

Validation Results
Global Steps: 2999
Valid Loss: 0.84726
Valid Accuracy: 0.65909
time stamp: 1194.6811151504517
[]
best model saved: step =  3199 dev accu =  tensor(0.6747, device='cuda:0')

Validation Results
Global Steps: 3199
Valid Loss: 0.81589
Valid Accuracy: 0.67466
time stamp: 1235.7112746238708
[]

Validation Results
Global Steps: 3399
Valid Loss: 0.83056
Valid Accuracy: 0.67107
time stamp: 1276.6851518154144
[]

Validation Results
Global Steps: 3599
Valid Loss: 0.83157
Valid Accuracy: 0.67230
time stamp: 1317.5750918388367
[]

Validation Results
Global Steps: 3799
Valid Loss: 0.83176
Valid Accuracy: 0.66878
time stamp: 1358.7945444583893
[]

Validation Results
Global Steps: 3999
Valid Loss: 0.83815
Valid Accuracy: 0.66913
time stamp: 1399.6207838058472
[]
best model saved: step =  4199 dev accu =  tensor(0.6757, device='cuda:0')

Validation Results
Global Steps: 4199
Valid Loss: 0.82709
Valid Accuracy: 0.67567
time stamp: 1440.4445774555206
[]

Validation Results
Global Steps: 4399
Valid Loss: 0.83217
Valid Accuracy: 0.66950
time stamp: 1481.106644153595
[]

Validation Results
Global Steps: 4599
Valid Loss: 0.83003
Valid Accuracy: 0.67384
time stamp: 1521.9923717975616
[]
best model saved: step =  4799 dev accu =  tensor(0.6827, device='cuda:0')

Validation Results
Global Steps: 4799
Valid Loss: 0.80758
Valid Accuracy: 0.68274
time stamp: 1562.578008890152
[]

Validation Results
Global Steps: 4999
Valid Loss: 0.80709
Valid Accuracy: 0.68226
time stamp: 1603.5614550113678
[]

Validation Results
Global Steps: 5199
Valid Loss: 0.82074
Valid Accuracy: 0.67713
time stamp: 1644.7168381214142
[]

Validation Results
Global Steps: 5399
Valid Loss: 0.81953
Valid Accuracy: 0.67929
time stamp: 1685.9234671592712
[]
best model saved: step =  5599 dev accu =  tensor(0.6889, device='cuda:0')

Validation Results
Global Steps: 5599
Valid Loss: 0.78445
Valid Accuracy: 0.68886
time stamp: 1726.9322309494019
[]
best model saved: step =  5799 dev accu =  tensor(0.6939, device='cuda:0')

Validation Results
Global Steps: 5799
Valid Loss: 0.78324
Valid Accuracy: 0.69389
time stamp: 1768.0017552375793
[]

Validation Results
Global Steps: 5999
Valid Loss: 0.80826
Valid Accuracy: 0.68814
time stamp: 1808.8239488601685
[]

Validation Results
Global Steps: 6199
Valid Loss: 0.80428
Valid Accuracy: 0.68173
time stamp: 1849.6995875835419
[]

Validation Results
Global Steps: 6399
Valid Loss: 0.79518
Valid Accuracy: 0.68920
time stamp: 1890.8930139541626
[]
best model saved: step =  6599 dev accu =  tensor(0.6943, device='cuda:0')

Validation Results
Global Steps: 6599
Valid Loss: 0.78405
Valid Accuracy: 0.69435
time stamp: 1931.8601670265198
[]
best model saved: step =  6799 dev accu =  tensor(0.6977, device='cuda:0')

Validation Results
Global Steps: 6799
Valid Loss: 0.77620
Valid Accuracy: 0.69769
time stamp: 1972.5916950702667
[]

Validation Results
Global Steps: 6999
Valid Loss: 0.79882
Valid Accuracy: 0.68979
time stamp: 2013.7460751533508
[]

Validation Results
Global Steps: 7199
Valid Loss: 0.77603
Valid Accuracy: 0.69585
time stamp: 2054.7811522483826
[]

Validation Results
Global Steps: 7399
Valid Loss: 0.80839
Valid Accuracy: 0.68968
time stamp: 2095.9349389076233
[]

Validation Results
Global Steps: 7599
Valid Loss: 0.77843
Valid Accuracy: 0.69483
time stamp: 2136.7966289520264
[]

Validation Results
Global Steps: 7799
Valid Loss: 0.78033
Valid Accuracy: 0.68977
time stamp: 2177.6287953853607
[]
best model saved: step =  7999 dev accu =  tensor(0.7027, device='cuda:0')

Validation Results
Global Steps: 7999
Valid Loss: 0.76927
Valid Accuracy: 0.70271
time stamp: 2218.740250110626
[]
best model saved: step =  8199 dev accu =  tensor(0.7053, device='cuda:0')

Validation Results
Global Steps: 8199
Valid Loss: 0.76245
Valid Accuracy: 0.70534
time stamp: 2259.6540472507477
[]

Validation Results
Global Steps: 8399
Valid Loss: 0.78002
Valid Accuracy: 0.69805
time stamp: 2300.5348744392395
[]

Validation Results
Global Steps: 8599
Valid Loss: 0.76601
Valid Accuracy: 0.70395
time stamp: 2341.4134907722473
[]

Validation Results
Global Steps: 8799
Valid Loss: 0.77113
Valid Accuracy: 0.70504
time stamp: 2382.563244819641
[]

Validation Results
Global Steps: 8999
Valid Loss: 0.78008
Valid Accuracy: 0.69800
time stamp: 2423.6762244701385
[]
best model saved: step =  9199 dev accu =  tensor(0.7140, device='cuda:0')

Validation Results
Global Steps: 9199
Valid Loss: 0.75302
Valid Accuracy: 0.71398
time stamp: 2464.648688554764
[]

Validation Results
Global Steps: 9399
Valid Loss: 0.76487
Valid Accuracy: 0.70508
time stamp: 2505.5761795043945
[]

Validation Results
Global Steps: 9599
Valid Loss: 0.77630
Valid Accuracy: 0.69954
time stamp: 2546.6440014839172
[]

Validation Results
Global Steps: 9799
Valid Loss: 0.77325
Valid Accuracy: 0.71137
time stamp: 2587.8778145313263
[]
best model saved: step =  9999 dev accu =  tensor(0.7148, device='cuda:0')

Validation Results
Global Steps: 9999
Valid Loss: 0.75019
Valid Accuracy: 0.71483
time stamp: 2628.708442211151
[]

Validation Results
Global Steps: 10199
Valid Loss: 0.74628
Valid Accuracy: 0.71426
time stamp: 2669.6733407974243
[]

Validation Results
Global Steps: 10399
Valid Loss: 0.75641
Valid Accuracy: 0.71357
time stamp: 2710.779101371765
[]

Validation Results
Global Steps: 10599
Valid Loss: 0.75991
Valid Accuracy: 0.70695
time stamp: 2751.4423208236694
[]
best model saved: step =  10799 dev accu =  tensor(0.7149, device='cuda:0')

Validation Results
Global Steps: 10799
Valid Loss: 0.74776
Valid Accuracy: 0.71486
time stamp: 2792.3950395584106
[]
best model saved: step =  10999 dev accu =  tensor(0.7174, device='cuda:0')

Validation Results
Global Steps: 10999
Valid Loss: 0.74067
Valid Accuracy: 0.71736
time stamp: 2833.635665655136
[]

Validation Results
Global Steps: 11199
Valid Loss: 0.74589
Valid Accuracy: 0.71677
time stamp: 2874.4049463272095
[]
best model saved: step =  11399 dev accu =  tensor(0.7214, device='cuda:0')

Validation Results
Global Steps: 11399
Valid Loss: 0.73485
Valid Accuracy: 0.72145
time stamp: 2915.157419204712
[]

Validation Results
Global Steps: 11599
Valid Loss: 0.75703
Valid Accuracy: 0.71798
time stamp: 2956.156362771988
[]

Validation Results
Global Steps: 11799
Valid Loss: 0.73550
Valid Accuracy: 0.72092
time stamp: 2997.1793410778046
[]

Validation Results
Global Steps: 11999
Valid Loss: 0.74889
Valid Accuracy: 0.71918
time stamp: 3037.790700674057
[]
best model saved: step =  12199 dev accu =  tensor(0.7222, device='cuda:0')

Validation Results
Global Steps: 12199
Valid Loss: 0.74119
Valid Accuracy: 0.72225
time stamp: 3078.5987935066223
[]
best model saved: step =  12399 dev accu =  tensor(0.7245, device='cuda:0')

Validation Results
Global Steps: 12399
Valid Loss: 0.73072
Valid Accuracy: 0.72447
time stamp: 3119.946056127548
[]

Validation Results
Global Steps: 12599
Valid Loss: 0.72360
Valid Accuracy: 0.72402
time stamp: 3161.008312225342
[]
best model saved: step =  12799 dev accu =  tensor(0.7291, device='cuda:0')

Validation Results
Global Steps: 12799
Valid Loss: 0.73543
Valid Accuracy: 0.72913
time stamp: 3201.8621623516083
[]

Validation Results
Global Steps: 12999
Valid Loss: 0.72744
Valid Accuracy: 0.72443
time stamp: 3242.5931153297424
[]
best model saved: step =  13199 dev accu =  tensor(0.7315, device='cuda:0')

Validation Results
Global Steps: 13199
Valid Loss: 0.71955
Valid Accuracy: 0.73147
time stamp: 3283.651168823242
[]

Validation Results
Global Steps: 13399
Valid Loss: 0.75035
Valid Accuracy: 0.72491
time stamp: 3324.6879069805145
[]
best model saved: step =  13599 dev accu =  tensor(0.7321, device='cuda:0')

Validation Results
Global Steps: 13599
Valid Loss: 0.72391
Valid Accuracy: 0.73210
time stamp: 3365.816255092621
[]
best model saved: step =  13799 dev accu =  tensor(0.7341, device='cuda:0')

Validation Results
Global Steps: 13799
Valid Loss: 0.70581
Valid Accuracy: 0.73407
time stamp: 3406.7904908657074
[]

Validation Results
Global Steps: 13999
Valid Loss: 0.71079
Valid Accuracy: 0.72824
time stamp: 3447.5534760951996
[]

Validation Results
Global Steps: 14199
Valid Loss: 0.71203
Valid Accuracy: 0.73295
time stamp: 3488.4676835536957
[]
best model saved: step =  14399 dev accu =  tensor(0.7350, device='cuda:0')

Validation Results
Global Steps: 14399
Valid Loss: 0.71161
Valid Accuracy: 0.73502
time stamp: 3529.4179952144623
[]

Validation Results
Global Steps: 14599
Valid Loss: 0.72594
Valid Accuracy: 0.73108
time stamp: 3570.402820110321
[]
best model saved: step =  14799 dev accu =  tensor(0.7396, device='cuda:0')

Validation Results
Global Steps: 14799
Valid Loss: 0.70633
Valid Accuracy: 0.73962
time stamp: 3611.5764813423157
[]
best model saved: step =  14999 dev accu =  tensor(0.7451, device='cuda:0')

Validation Results
Global Steps: 14999
Valid Loss: 0.67825
Valid Accuracy: 0.74508
time stamp: 3652.569414615631
[]

Validation Results
Global Steps: 15199
Valid Loss: 0.70922
Valid Accuracy: 0.74344
time stamp: 3693.7998836040497
[]
best model saved: step =  15399 dev accu =  tensor(0.7462, device='cuda:0')

Validation Results
Global Steps: 15399
Valid Loss: 0.69576
Valid Accuracy: 0.74623
time stamp: 3734.9346163272858
[]

Validation Results
Global Steps: 15599
Valid Loss: 0.71631
Valid Accuracy: 0.73479
time stamp: 3775.7097685337067
[]

Validation Results
Global Steps: 15799
Valid Loss: 0.70382
Valid Accuracy: 0.74186
time stamp: 3817.00839304924
[]

Validation Results
Global Steps: 15999
Valid Loss: 0.69570
Valid Accuracy: 0.74011
time stamp: 3857.8205013275146
[]
best model saved: step =  16199 dev accu =  tensor(0.7497, device='cuda:0')

Validation Results
Global Steps: 16199
Valid Loss: 0.70538
Valid Accuracy: 0.74971
time stamp: 3899.078361272812
[]
best model saved: step =  16399 dev accu =  tensor(0.7518, device='cuda:0')

Validation Results
Global Steps: 16399
Valid Loss: 0.68238
Valid Accuracy: 0.75180
time stamp: 3940.057468175888
[]

Validation Results
Global Steps: 16599
Valid Loss: 0.69633
Valid Accuracy: 0.74705
time stamp: 3981.2033174037933
[]

Validation Results
Global Steps: 16799
Valid Loss: 0.68407
Valid Accuracy: 0.74652
time stamp: 4022.576245069504
[]

Validation Results
Global Steps: 16999
Valid Loss: 0.68443
Valid Accuracy: 0.74832
time stamp: 4063.6741061210632
[]
best model saved: step =  17199 dev accu =  tensor(0.7550, device='cuda:0')

Validation Results
Global Steps: 17199
Valid Loss: 0.66949
Valid Accuracy: 0.75495
time stamp: 4104.721362113953
[]
best model saved: step =  17399 dev accu =  tensor(0.7560, device='cuda:0')

Validation Results
Global Steps: 17399
Valid Loss: 0.68278
Valid Accuracy: 0.75597
time stamp: 4146.048159360886
[]

Validation Results
Global Steps: 17599
Valid Loss: 0.67651
Valid Accuracy: 0.75460
time stamp: 4187.058575868607
[]
best model saved: step =  17799 dev accu =  tensor(0.7597, device='cuda:0')

Validation Results
Global Steps: 17799
Valid Loss: 0.66282
Valid Accuracy: 0.75975
time stamp: 4228.370991706848
[]

Validation Results
Global Steps: 17999
Valid Loss: 0.66669
Valid Accuracy: 0.75970
time stamp: 4269.453763008118
[]
best model saved: step =  18199 dev accu =  tensor(0.7632, device='cuda:0')

Validation Results
Global Steps: 18199
Valid Loss: 0.65484
Valid Accuracy: 0.76324
time stamp: 4310.278496980667
[]

Validation Results
Global Steps: 18399
Valid Loss: 0.66275
Valid Accuracy: 0.76088
time stamp: 4351.2555141448975
[]
best model saved: step =  18599 dev accu =  tensor(0.7642, device='cuda:0')

Validation Results
Global Steps: 18599
Valid Loss: 0.66531
Valid Accuracy: 0.76423
time stamp: 4392.310930967331
[]
best model saved: step =  18799 dev accu =  tensor(0.7673, device='cuda:0')

Validation Results
Global Steps: 18799
Valid Loss: 0.65534
Valid Accuracy: 0.76727
time stamp: 4433.239073038101
[]
best model saved: step =  18999 dev accu =  tensor(0.7701, device='cuda:0')

Validation Results
Global Steps: 18999
Valid Loss: 0.65270
Valid Accuracy: 0.77006
time stamp: 4474.198831796646
[]
best model saved: step =  19199 dev accu =  tensor(0.7726, device='cuda:0')

Validation Results
Global Steps: 19199
Valid Loss: 0.64129
Valid Accuracy: 0.77257
time stamp: 4515.3998503685
[]

Validation Results
Global Steps: 19399
Valid Loss: 0.64365
Valid Accuracy: 0.76964
time stamp: 4556.497344017029
[]

Validation Results
Global Steps: 19599
Valid Loss: 0.65102
Valid Accuracy: 0.76719
time stamp: 4597.570492982864
[]

Validation Results
Global Steps: 19799
Valid Loss: 0.64706
Valid Accuracy: 0.76521
time stamp: 4638.579100847244
[]
best model saved: step =  19999 dev accu =  tensor(0.7730, device='cuda:0')

Validation Results
Global Steps: 19999
Valid Loss: 0.63173
Valid Accuracy: 0.77301
time stamp: 4679.56291270256
[]
best model saved: step =  20199 dev accu =  tensor(0.7742, device='cuda:0')

Validation Results
Global Steps: 20199
Valid Loss: 0.63405
Valid Accuracy: 0.77420
time stamp: 4721.145172119141
[]
best model saved: step =  20399 dev accu =  tensor(0.7748, device='cuda:0')

Validation Results
Global Steps: 20399
Valid Loss: 0.61866
Valid Accuracy: 0.77478
time stamp: 4762.146454334259
[]

Validation Results
Global Steps: 20599
Valid Loss: 0.63623
Valid Accuracy: 0.77273
time stamp: 4803.232483386993
[]
best model saved: step =  20799 dev accu =  tensor(0.7781, device='cuda:0')

Validation Results
Global Steps: 20799
Valid Loss: 0.62971
Valid Accuracy: 0.77808
time stamp: 4844.1735463142395
[]
best model saved: step =  20999 dev accu =  tensor(0.7782, device='cuda:0')

Validation Results
Global Steps: 20999
Valid Loss: 0.60816
Valid Accuracy: 0.77824
time stamp: 4885.3357191085815
[]

Validation Results
Global Steps: 21199
Valid Loss: 0.63844
Valid Accuracy: 0.77465
time stamp: 4926.764320611954
[]
best model saved: step =  21399 dev accu =  tensor(0.7792, device='cuda:0')

Validation Results
Global Steps: 21399
Valid Loss: 0.61488
Valid Accuracy: 0.77919
time stamp: 4967.811639547348
[]
best model saved: step =  21599 dev accu =  tensor(0.7840, device='cuda:0')

Validation Results
Global Steps: 21599
Valid Loss: 0.60214
Valid Accuracy: 0.78398
time stamp: 5008.563507795334
[]

Validation Results
Global Steps: 21799
Valid Loss: 0.60776
Valid Accuracy: 0.78045
time stamp: 5049.754861116409
[]

Validation Results
Global Steps: 21999
Valid Loss: 0.60533
Valid Accuracy: 0.78384
time stamp: 5090.853956699371
[]
best model saved: step =  22199 dev accu =  tensor(0.7890, device='cuda:0')

Validation Results
Global Steps: 22199
Valid Loss: 0.59314
Valid Accuracy: 0.78904
time stamp: 5131.876583099365
[]

Validation Results
Global Steps: 22399
Valid Loss: 0.60273
Valid Accuracy: 0.78324
time stamp: 5172.854286670685
[]

Validation Results
Global Steps: 22599
Valid Loss: 0.60755
Valid Accuracy: 0.78560
time stamp: 5213.98250746727
[]

Validation Results
Global Steps: 22799
Valid Loss: 0.58930
Valid Accuracy: 0.78484
time stamp: 5255.011552810669
[]
best model saved: step =  22999 dev accu =  tensor(0.7907, device='cuda:0')

Validation Results
Global Steps: 22999
Valid Loss: 0.59300
Valid Accuracy: 0.79070
time stamp: 5296.255199432373
[]

Validation Results
Global Steps: 23199
Valid Loss: 0.58586
Valid Accuracy: 0.78639
time stamp: 5337.39802479744
[]
best model saved: step =  23399 dev accu =  tensor(0.7943, device='cuda:0')

Validation Results
Global Steps: 23399
Valid Loss: 0.57904
Valid Accuracy: 0.79431
time stamp: 5378.564752340317
[]

Validation Results
Global Steps: 23599
Valid Loss: 0.57141
Valid Accuracy: 0.79394
time stamp: 5419.646566152573
[]
best model saved: step =  23799 dev accu =  tensor(0.7948, device='cuda:0')

Validation Results
Global Steps: 23799
Valid Loss: 0.57390
Valid Accuracy: 0.79479
time stamp: 5460.763309001923
[]
best model saved: step =  23999 dev accu =  tensor(0.7953, device='cuda:0')

Validation Results
Global Steps: 23999
Valid Loss: 0.56902
Valid Accuracy: 0.79527
time stamp: 5501.6270406246185
[]
best model saved: step =  24199 dev accu =  tensor(0.7977, device='cuda:0')

Validation Results
Global Steps: 24199
Valid Loss: 0.57145
Valid Accuracy: 0.79771
time stamp: 5542.787178993225
[]

Validation Results
Global Steps: 24399
Valid Loss: 0.57681
Valid Accuracy: 0.79768
time stamp: 5583.880369186401
[]
best model saved: step =  24599 dev accu =  tensor(0.7980, device='cuda:0')

Validation Results
Global Steps: 24599
Valid Loss: 0.57594
Valid Accuracy: 0.79800
time stamp: 5624.860508918762
[]
best model saved: step =  24799 dev accu =  tensor(0.8017, device='cuda:0')

Validation Results
Global Steps: 24799
Valid Loss: 0.55895
Valid Accuracy: 0.80175
time stamp: 5665.6790471076965
[]
best model saved: step =  24999 dev accu =  tensor(0.8026, device='cuda:0')

Validation Results
Global Steps: 24999
Valid Loss: 0.55132
Valid Accuracy: 0.80265
time stamp: 5706.639759063721
[]

Validation Results
Global Steps: 25199
Valid Loss: 0.56091
Valid Accuracy: 0.80174
time stamp: 5747.49573469162
[]
best model saved: step =  25399 dev accu =  tensor(0.8030, device='cuda:0')

Validation Results
Global Steps: 25399
Valid Loss: 0.56483
Valid Accuracy: 0.80302
time stamp: 5788.74306678772
[]
best model saved: step =  25599 dev accu =  tensor(0.8049, device='cuda:0')

Validation Results
Global Steps: 25599
Valid Loss: 0.55628
Valid Accuracy: 0.80491
time stamp: 5829.965708971024
[]
best model saved: step =  25799 dev accu =  tensor(0.8100, device='cuda:0')

Validation Results
Global Steps: 25799
Valid Loss: 0.54826
Valid Accuracy: 0.80999
time stamp: 5871.25226354599
[]

Validation Results
Global Steps: 25999
Valid Loss: 0.54616
Valid Accuracy: 0.80795
time stamp: 5912.344572544098
[]
best model saved: step =  26199 dev accu =  tensor(0.8106, device='cuda:0')

Validation Results
Global Steps: 26199
Valid Loss: 0.53477
Valid Accuracy: 0.81064
time stamp: 5953.358871936798
[]

Validation Results
Global Steps: 26399
Valid Loss: 0.54543
Valid Accuracy: 0.80746
time stamp: 5994.279639005661
[]

Validation Results
Global Steps: 26599
Valid Loss: 0.53588
Valid Accuracy: 0.80946
time stamp: 6035.149336099625
[]
best model saved: step =  26799 dev accu =  tensor(0.8125, device='cuda:0')

Validation Results
Global Steps: 26799
Valid Loss: 0.54253
Valid Accuracy: 0.81252
time stamp: 6076.271808624268
[]

Validation Results
Global Steps: 26999
Valid Loss: 0.56097
Valid Accuracy: 0.80535
time stamp: 6117.417727470398
[]
best model saved: step =  27199 dev accu =  tensor(0.8153, device='cuda:0')

Validation Results
Global Steps: 27199
Valid Loss: 0.53045
Valid Accuracy: 0.81531
time stamp: 6158.477552652359
[]

Validation Results
Global Steps: 27399
Valid Loss: 0.53005
Valid Accuracy: 0.81389
time stamp: 6199.653223276138
[]
best model saved: step =  27599 dev accu =  tensor(0.8183, device='cuda:0')

Validation Results
Global Steps: 27599
Valid Loss: 0.53297
Valid Accuracy: 0.81827
time stamp: 6240.221446990967
[]
best model saved: step =  27799 dev accu =  tensor(0.8213, device='cuda:0')

Validation Results
Global Steps: 27799
Valid Loss: 0.51431
Valid Accuracy: 0.82128
time stamp: 6281.492799758911
[]

Validation Results
Global Steps: 27999
Valid Loss: 0.54172
Valid Accuracy: 0.81146
time stamp: 6322.3157613277435
[]

Validation Results
Global Steps: 28199
Valid Loss: 0.53104
Valid Accuracy: 0.81825
time stamp: 6363.489068508148
[]

Validation Results
Global Steps: 28399
Valid Loss: 0.52059
Valid Accuracy: 0.81619
time stamp: 6404.333246231079
[]

Validation Results
Global Steps: 28599
Valid Loss: 0.51779
Valid Accuracy: 0.81899
time stamp: 6445.281028032303
[]
best model saved: step =  28799 dev accu =  tensor(0.8250, device='cuda:0')

Validation Results
Global Steps: 28799
Valid Loss: 0.51225
Valid Accuracy: 0.82501
time stamp: 6486.519027233124
[]

Validation Results
Global Steps: 28999
Valid Loss: 0.51395
Valid Accuracy: 0.82397
time stamp: 6527.747272014618
[]

Validation Results
Global Steps: 29199
Valid Loss: 0.51418
Valid Accuracy: 0.81773
time stamp: 6568.453244686127
[]
best model saved: step =  29399 dev accu =  tensor(0.8276, device='cuda:0')

Validation Results
Global Steps: 29399
Valid Loss: 0.50233
Valid Accuracy: 0.82758
time stamp: 6609.698561906815
[]

Validation Results
Global Steps: 29599
Valid Loss: 0.50655
Valid Accuracy: 0.82597
time stamp: 6650.30250120163
[]
best model saved: step =  29799 dev accu =  tensor(0.8306, device='cuda:0')

Validation Results
Global Steps: 29799
Valid Loss: 0.49429
Valid Accuracy: 0.83059
time stamp: 6691.098531007767
[]

Validation Results
Global Steps: 29999
Valid Loss: 0.48981
Valid Accuracy: 0.82758
time stamp: 6732.203570127487
total training step (k): 30.0
total training time (s): 6732.204196214676
total training time (ms): 1683895.1513671875
peak memory usage (MB): 12858
allocated memory usage (MB): 434164178
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |   12031 KB |   12858 MB |  423988 GB |  423988 GB |
|       from large pool |    6144 KB |   12846 MB |  420596 GB |  420596 GB |
|       from small pool |    5887 KB |      27 MB |    3391 GB |    3391 GB |
|---------------------------------------------------------------------------|
| Active memory         |   12031 KB |   12858 MB |  423988 GB |  423988 GB |
|       from large pool |    6144 KB |   12846 MB |  420596 GB |  420596 GB |
|       from small pool |    5887 KB |      27 MB |    3391 GB |    3391 GB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   13776 MB |   13776 MB |   13776 MB |       0 B  |
|       from large pool |   13748 MB |   13748 MB |   13748 MB |       0 B  |
|       from small pool |      28 MB |      28 MB |      28 MB |       0 B  |
|---------------------------------------------------------------------------|
| Non-releasable memory |   12545 KB |    2073 MB |  467892 GB |  467892 GB |
|       from large pool |   10240 KB |    2070 MB |  464351 GB |  464351 GB |
|       from small pool |    2305 KB |       6 MB |    3540 GB |    3540 GB |
|---------------------------------------------------------------------------|
| Allocations           |     398    |     670    |   35718 K  |   35718 K  |
|       from large pool |       2    |      93    |   13732 K  |   13731 K  |
|       from small pool |     396    |     659    |   21986 K  |   21986 K  |
|---------------------------------------------------------------------------|
| Active allocs         |     398    |     670    |   35718 K  |   35718 K  |
|       from large pool |       2    |      93    |   13732 K  |   13731 K  |
|       from small pool |     396    |     659    |   21986 K  |   21986 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      42    |      42    |      42    |       0    |
|       from large pool |      28    |      28    |      28    |       0    |
|       from small pool |      14    |      14    |      14    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |      10    |      35    |   16734 K  |   16734 K  |
|       from large pool |       1    |      20    |    6206 K  |    6206 K  |
|       from small pool |       9    |      23    |   10527 K  |   10527 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

dense memory(MB) : {} 44615131
dense step : {} 999
dense time : {} 765.6174564361572
sparse memory(MB) : {} 433352155
sparse step : {} 29000
sparse_time : {} 1713072155.8123174
loading the best model from: ./checkpoints/checkpoints-2/lra-news1/learnable.model
Evaluation Results
Loss: 0.49428
Accuracy: 0.83161
