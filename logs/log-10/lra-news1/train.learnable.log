GPU list: [0, 1, 2, 3]
[
    {
        "learn_pos_emb": true,
        "tied_weights": false,
        "embedding_dim": 64,
        "transformer_dim": 64,
        "transformer_hidden_dim": 128,
        "head_dim": 32,
        "num_head": 2,
        "num_layers": 4,
        "vocab_size": 512,
        "max_seq_len": 1024,
        "dropout_prob": 0.1,
        "attention_dropout": 0.1,
        "pooling_mode": "MEAN",
        "num_classes": 4,
        "block_size": 32,
        "batch_size": 128,
        "density": 0.08,
        "mixed_precision": true,
        "random_seed": 10,
        "task": "lra-news1"
    },
    {
        "batch_size": 512,
        "learning_rate": 0.0009,
        "warmup": 80,
        "lr_decay": "linear",
        "weight_decay": 0,
        "eval_frequency": 200,
        "num_train_steps": 30000,
        "num_init_steps": 3000,
        "num_eval_steps": 200,
        "num_dense_train_steps": 1000,
        "patience": 10,
        "attn_loss_scale": 0.01
    }
]
attn_mask compile
attn_mask compile
attn_mask compile
attn_mask compile
DataParallel(
  (module): ModelForSC(
    (model): Model(
      (embeddings): Embeddings(
        (word_embeddings): Embedding(512, 64)
        (position_embeddings): Embedding(1024, 64)
        (dropout): Dropout(p=0.1, inplace=False)
      )
      (transformer_0): TransformerLayer(
        (norm1): LayerNorm((64,), eps=1e-05, elementwise_affine=True)
        (mha): Attention(
          (W_q): Linear(in_features=64, out_features=64, bias=True)
          (W_k): Linear(in_features=64, out_features=64, bias=True)
          (W_v): Linear(in_features=64, out_features=64, bias=True)
          (avg_pool): AvgPool2d(kernel_size=32, stride=32, padding=0)
          (MSEloss): MSELoss()
          (attn): CUDAMaskAttention()
          (ff): Linear(in_features=64, out_features=64, bias=True)
        )
        (dropout1): Dropout(p=0.1, inplace=False)
        (norm2): LayerNorm((64,), eps=1e-05, elementwise_affine=True)
        (mlpblock): Sequential(
          (0): Linear(in_features=64, out_features=128, bias=True)
          (1): GELU(approximate='none')
          (2): Dropout(p=0.1, inplace=False)
          (3): Linear(in_features=128, out_features=64, bias=True)
          (4): Dropout(p=0.1, inplace=False)
        )
      )
      (transformer_1): TransformerLayer(
        (norm1): LayerNorm((64,), eps=1e-05, elementwise_affine=True)
        (mha): Attention(
          (W_q): Linear(in_features=64, out_features=64, bias=True)
          (W_k): Linear(in_features=64, out_features=64, bias=True)
          (W_v): Linear(in_features=64, out_features=64, bias=True)
          (avg_pool): AvgPool2d(kernel_size=32, stride=32, padding=0)
          (MSEloss): MSELoss()
          (attn): CUDAMaskAttention()
          (ff): Linear(in_features=64, out_features=64, bias=True)
        )
        (dropout1): Dropout(p=0.1, inplace=False)
        (norm2): LayerNorm((64,), eps=1e-05, elementwise_affine=True)
        (mlpblock): Sequential(
          (0): Linear(in_features=64, out_features=128, bias=True)
          (1): GELU(approximate='none')
          (2): Dropout(p=0.1, inplace=False)
          (3): Linear(in_features=128, out_features=64, bias=True)
          (4): Dropout(p=0.1, inplace=False)
        )
      )
      (transformer_2): TransformerLayer(
        (norm1): LayerNorm((64,), eps=1e-05, elementwise_affine=True)
        (mha): Attention(
          (W_q): Linear(in_features=64, out_features=64, bias=True)
          (W_k): Linear(in_features=64, out_features=64, bias=True)
          (W_v): Linear(in_features=64, out_features=64, bias=True)
          (avg_pool): AvgPool2d(kernel_size=32, stride=32, padding=0)
          (MSEloss): MSELoss()
          (attn): CUDAMaskAttention()
          (ff): Linear(in_features=64, out_features=64, bias=True)
        )
        (dropout1): Dropout(p=0.1, inplace=False)
        (norm2): LayerNorm((64,), eps=1e-05, elementwise_affine=True)
        (mlpblock): Sequential(
          (0): Linear(in_features=64, out_features=128, bias=True)
          (1): GELU(approximate='none')
          (2): Dropout(p=0.1, inplace=False)
          (3): Linear(in_features=128, out_features=64, bias=True)
          (4): Dropout(p=0.1, inplace=False)
        )
      )
      (transformer_3): TransformerLayer(
        (norm1): LayerNorm((64,), eps=1e-05, elementwise_affine=True)
        (mha): Attention(
          (W_q): Linear(in_features=64, out_features=64, bias=True)
          (W_k): Linear(in_features=64, out_features=64, bias=True)
          (W_v): Linear(in_features=64, out_features=64, bias=True)
          (avg_pool): AvgPool2d(kernel_size=32, stride=32, padding=0)
          (MSEloss): MSELoss()
          (attn): CUDAMaskAttention()
          (ff): Linear(in_features=64, out_features=64, bias=True)
        )
        (dropout1): Dropout(p=0.1, inplace=False)
        (norm2): LayerNorm((64,), eps=1e-05, elementwise_affine=True)
        (mlpblock): Sequential(
          (0): Linear(in_features=64, out_features=128, bias=True)
          (1): GELU(approximate='none')
          (2): Dropout(p=0.1, inplace=False)
          (3): Linear(in_features=128, out_features=64, bias=True)
          (4): Dropout(p=0.1, inplace=False)
        )
      )
      (norm): LayerNorm((64,), eps=1e-05, elementwise_affine=True)
    )
    (seq_classifer): SCHead(
      (mlpblock): Sequential(
        (0): Linear(in_features=64, out_features=128, bias=True)
        (1): ReLU()
        (2): Linear(in_features=128, out_features=4, bias=True)
      )
    )
  )
)
parameter_size: [torch.Size([512, 64]), torch.Size([1024, 64]), torch.Size([64]), torch.Size([64]), torch.Size([32, 32]), torch.Size([64, 64]), torch.Size([64]), torch.Size([64, 64]), torch.Size([64]), torch.Size([64, 64]), torch.Size([64]), torch.Size([64, 64]), torch.Size([64]), torch.Size([64]), torch.Size([64]), torch.Size([128, 64]), torch.Size([128]), torch.Size([64, 128]), torch.Size([64]), torch.Size([64]), torch.Size([64]), torch.Size([32, 32]), torch.Size([64, 64]), torch.Size([64]), torch.Size([64, 64]), torch.Size([64]), torch.Size([64, 64]), torch.Size([64]), torch.Size([64, 64]), torch.Size([64]), torch.Size([64]), torch.Size([64]), torch.Size([128, 64]), torch.Size([128]), torch.Size([64, 128]), torch.Size([64]), torch.Size([64]), torch.Size([64]), torch.Size([32, 32]), torch.Size([64, 64]), torch.Size([64]), torch.Size([64, 64]), torch.Size([64]), torch.Size([64, 64]), torch.Size([64]), torch.Size([64, 64]), torch.Size([64]), torch.Size([64]), torch.Size([64]), torch.Size([128, 64]), torch.Size([128]), torch.Size([64, 128]), torch.Size([64]), torch.Size([64]), torch.Size([64]), torch.Size([32, 32]), torch.Size([64, 64]), torch.Size([64]), torch.Size([64, 64]), torch.Size([64]), torch.Size([64, 64]), torch.Size([64]), torch.Size([64, 64]), torch.Size([64]), torch.Size([64]), torch.Size([64]), torch.Size([128, 64]), torch.Size([128]), torch.Size([64, 128]), torch.Size([64]), torch.Size([64]), torch.Size([64]), torch.Size([128, 64]), torch.Size([128]), torch.Size([4, 128]), torch.Size([4])]
num_parameter: 245252
Loaded ../Skyformer/data/lra_processed/lra-news1.train.pickle... size=120000
Loaded ../Skyformer/data/lra_processed/lra-news1.dev.pickle... size=7600
Loaded ../Skyformer/data/lra_processed/lra-news1.test.pickle... size=7600
accumu_steps=1
module.model.transformer_0.mha.pattern saved
module.model.transformer_1.mha.pattern saved
module.model.transformer_2.mha.pattern saved
module.model.transformer_3.mha.pattern saved
./pickle/lra-news1/module.model.transformer_0.mha.pattern.pickle
tensor([ 792,    0,   66,  396,   24,  768,  231,  264,   33,  495, 1023,  330,
         363,  660,  297,   75,  354,  165,  594,   71,  226,   99,    2,   64,
          88,  770,   10,  320,   74,  322,   15,  480,  726,  344,  778,   95,
         994,   12,  384,   31,  992,  528,   34,   65,   69,  162,  429,   16,
         512,  440,  781,   77,  418,   84,  642,  319, 1001,   79,  482,  462,
         858,  825,  235,  359,   11,  352,  248,  775,  303,  489,   73,  290,
         415, 1004,  504,  783,   83,  610,  244,  647,  234], device='cuda:0')
tensor(81, device='cuda:0')
block_attn_mask compile
./pickle/lra-news1/module.model.transformer_1.mha.pattern.pickle
tensor([ 33, 330,  66, 759, 198,  99, 363, 924, 693, 396, 858, 297, 264, 792,
         42, 321,  70, 194, 215, 742, 561, 132, 594, 343, 746, 429, 218, 838,
         82, 578,   0,  87, 738,  55, 737, 891, 627, 106, 323,  56, 769,  76,
        386,  74, 322, 201, 294, 957,  90, 834, 695, 757,  73, 290,  53, 673,
         92, 898, 120, 771, 990, 344, 778, 311, 745, 860, 922, 200, 262, 408,
        780, 407, 748,  38, 193, 151, 740,  81, 546, 567, 753],
       device='cuda:0')
tensor(81, device='cuda:0')
block_attn_mask compile
./pickle/lra-news1/module.model.transformer_2.mha.pattern.pickle
tensor([ 66, 627, 495, 297, 264, 132,  83, 610, 198, 594,  99, 726, 462, 147,
        612,  79, 482,  68, 130,   0, 165, 825, 499, 623, 630, 723, 561,  89,
        802,  72, 258, 143, 484, 115, 611, 330,  85, 674, 231, 307, 617, 759,
        595, 626,  67,  98, 207, 486,  91, 866, 270, 456,  70, 194, 792, 275,
        616,  69, 162, 211, 614,  88, 770, 990, 306, 585, 563, 625, 957, 693,
        134, 196, 497, 559,  73, 290,  81, 546, 429, 271, 488],
       device='cuda:0')
tensor(81, device='cuda:0')
block_attn_mask compile
./pickle/lra-news1/module.model.transformer_3.mha.pattern.pickle
tensor([759, 231, 693,  66, 695, 757,   0, 594,  87, 738,  23, 736, 247, 743,
        429,  85, 674, 528, 297, 858, 631, 755, 726,  33, 245, 679, 727, 758,
        535, 752,  71, 226, 375, 747, 599, 754,  55, 737, 627,  21, 672, 698,
        853, 233, 295,   2,  64, 533, 688, 597, 690,  18, 576,  90, 834, 530,
        592,   7, 224, 311, 745, 264, 396, 764, 919, 165, 151, 740, 437, 685,
        246, 711, 119, 739, 439, 749, 183, 741, 762, 855, 242],
       device='cuda:0')
tensor(81, device='cuda:0')
block_attn_mask compile
total pattern searching time (s): 0.10855555534362793
[]
best model saved: step =  199 dev accu =  tensor(0.5241, device='cuda:0')

Validation Results
Global Steps: 199
Valid Loss: 1.10763
Valid Accuracy: 0.52405
time stamp: 52.92983412742615
[]
best model saved: step =  399 dev accu =  tensor(0.5820, device='cuda:0')

Validation Results
Global Steps: 399
Valid Loss: 1.00289
Valid Accuracy: 0.58200
time stamp: 93.70836210250854
[]
best model saved: step =  599 dev accu =  tensor(0.5963, device='cuda:0')

Validation Results
Global Steps: 599
Valid Loss: 0.98067
Valid Accuracy: 0.59635
time stamp: 134.4924807548523
[]
best model saved: step =  799 dev accu =  tensor(0.6155, device='cuda:0')

Validation Results
Global Steps: 799
Valid Loss: 0.93856
Valid Accuracy: 0.61550
time stamp: 175.37747287750244
[]
best model saved: step =  999 dev accu =  tensor(0.6244, device='cuda:0')

Validation Results
Global Steps: 999
Valid Loss: 0.92819
Valid Accuracy: 0.62437
time stamp: 216.75668787956238
[]
best model saved: step =  1199 dev accu =  tensor(0.6341, device='cuda:0')

Validation Results
Global Steps: 1199
Valid Loss: 0.91484
Valid Accuracy: 0.63411
time stamp: 257.7350687980652
[]

Validation Results
Global Steps: 1399
Valid Loss: 0.91612
Valid Accuracy: 0.62668
time stamp: 298.7760896682739
[]
best model saved: step =  1599 dev accu =  tensor(0.6369, device='cuda:0')

Validation Results
Global Steps: 1599
Valid Loss: 0.89943
Valid Accuracy: 0.63688
time stamp: 339.6949861049652
[]
best model saved: step =  1799 dev accu =  tensor(0.6411, device='cuda:0')

Validation Results
Global Steps: 1799
Valid Loss: 0.88674
Valid Accuracy: 0.64105
time stamp: 380.94214701652527
[]

Validation Results
Global Steps: 1999
Valid Loss: 0.89053
Valid Accuracy: 0.63569
time stamp: 422.18089175224304
[]

Validation Results
Global Steps: 2199
Valid Loss: 0.89324
Valid Accuracy: 0.63648
time stamp: 463.1034343242645
[]
best model saved: step =  2399 dev accu =  tensor(0.6456, device='cuda:0')

Validation Results
Global Steps: 2399
Valid Loss: 0.87958
Valid Accuracy: 0.64561
time stamp: 503.95677042007446
[]
best model saved: step =  2599 dev accu =  tensor(0.6469, device='cuda:0')

Validation Results
Global Steps: 2599
Valid Loss: 0.87858
Valid Accuracy: 0.64688
time stamp: 544.9176242351532
[]
best model saved: step =  2799 dev accu =  tensor(0.6532, device='cuda:0')

Validation Results
Global Steps: 2799
Valid Loss: 0.85739
Valid Accuracy: 0.65321
time stamp: 585.8328206539154
[]

Validation Results
Global Steps: 2999
Valid Loss: 0.86534
Valid Accuracy: 0.65043
time stamp: 626.7451145648956
[]

Validation Results
Global Steps: 3199
Valid Loss: 0.86191
Valid Accuracy: 0.65146
time stamp: 667.8842060565948
[]
best model saved: step =  3399 dev accu =  tensor(0.6567, device='cuda:0')

Validation Results
Global Steps: 3399
Valid Loss: 0.85016
Valid Accuracy: 0.65665
time stamp: 709.1731677055359
[]

Validation Results
Global Steps: 3599
Valid Loss: 0.85419
Valid Accuracy: 0.65170
time stamp: 750.5502691268921
[]
best model saved: step =  3799 dev accu =  tensor(0.6626, device='cuda:0')

Validation Results
Global Steps: 3799
Valid Loss: 0.84496
Valid Accuracy: 0.66264
time stamp: 791.6409571170807
[]

Validation Results
Global Steps: 3999
Valid Loss: 0.84864
Valid Accuracy: 0.65715
time stamp: 832.4858345985413
[]
best model saved: step =  4199 dev accu =  tensor(0.6645, device='cuda:0')

Validation Results
Global Steps: 4199
Valid Loss: 0.82866
Valid Accuracy: 0.66445
time stamp: 873.4345369338989
[]

Validation Results
Global Steps: 4399
Valid Loss: 0.84401
Valid Accuracy: 0.66134
time stamp: 914.2167887687683
[]
best model saved: step =  4599 dev accu =  tensor(0.6687, device='cuda:0')

Validation Results
Global Steps: 4599
Valid Loss: 0.81905
Valid Accuracy: 0.66873
time stamp: 955.2902717590332
[]

Validation Results
Global Steps: 4799
Valid Loss: 0.82347
Valid Accuracy: 0.66529
time stamp: 996.7228894233704
[]
best model saved: step =  4999 dev accu =  tensor(0.6709, device='cuda:0')

Validation Results
Global Steps: 4999
Valid Loss: 0.82809
Valid Accuracy: 0.67091
time stamp: 1037.7361860275269
[]

Validation Results
Global Steps: 5199
Valid Loss: 0.83068
Valid Accuracy: 0.66896
time stamp: 1078.6059937477112
[]

Validation Results
Global Steps: 5399
Valid Loss: 0.83051
Valid Accuracy: 0.66829
time stamp: 1119.5666818618774
[]
best model saved: step =  5599 dev accu =  tensor(0.6754, device='cuda:0')

Validation Results
Global Steps: 5599
Valid Loss: 0.82273
Valid Accuracy: 0.67537
time stamp: 1160.5508143901825
[]
best model saved: step =  5799 dev accu =  tensor(0.6788, device='cuda:0')

Validation Results
Global Steps: 5799
Valid Loss: 0.80514
Valid Accuracy: 0.67883
time stamp: 1201.7225785255432
[]
best model saved: step =  5999 dev accu =  tensor(0.6819, device='cuda:0')

Validation Results
Global Steps: 5999
Valid Loss: 0.80505
Valid Accuracy: 0.68194
time stamp: 1242.6301684379578
[]

Validation Results
Global Steps: 6199
Valid Loss: 0.80648
Valid Accuracy: 0.68044
time stamp: 1283.673684835434
[]

Validation Results
Global Steps: 6399
Valid Loss: 0.81811
Valid Accuracy: 0.68146
time stamp: 1324.7549231052399
[]
best model saved: step =  6599 dev accu =  tensor(0.6829, device='cuda:0')

Validation Results
Global Steps: 6599
Valid Loss: 0.80054
Valid Accuracy: 0.68285
time stamp: 1366.0343453884125
[]
best model saved: step =  6799 dev accu =  tensor(0.6839, device='cuda:0')

Validation Results
Global Steps: 6799
Valid Loss: 0.80068
Valid Accuracy: 0.68392
time stamp: 1407.1552221775055
[]
best model saved: step =  6999 dev accu =  tensor(0.6884, device='cuda:0')

Validation Results
Global Steps: 6999
Valid Loss: 0.78947
Valid Accuracy: 0.68840
time stamp: 1447.981273651123
[]
best model saved: step =  7199 dev accu =  tensor(0.6932, device='cuda:0')

Validation Results
Global Steps: 7199
Valid Loss: 0.78811
Valid Accuracy: 0.69316
time stamp: 1489.0929350852966
[]

Validation Results
Global Steps: 7399
Valid Loss: 0.79188
Valid Accuracy: 0.68543
time stamp: 1529.9872057437897
[]

Validation Results
Global Steps: 7599
Valid Loss: 0.78829
Valid Accuracy: 0.68978
time stamp: 1570.8944444656372
[]

Validation Results
Global Steps: 7799
Valid Loss: 0.79293
Valid Accuracy: 0.68769
time stamp: 1612.1161532402039
[]

Validation Results
Global Steps: 7999
Valid Loss: 0.79463
Valid Accuracy: 0.68342
time stamp: 1653.2095141410828
[]
best model saved: step =  8199 dev accu =  tensor(0.6964, device='cuda:0')

Validation Results
Global Steps: 8199
Valid Loss: 0.77948
Valid Accuracy: 0.69643
time stamp: 1694.4454147815704
[]

Validation Results
Global Steps: 8399
Valid Loss: 0.79144
Valid Accuracy: 0.69117
time stamp: 1735.3051290512085
[]

Validation Results
Global Steps: 8599
Valid Loss: 0.78501
Valid Accuracy: 0.69254
time stamp: 1776.456695318222
[]
best model saved: step =  8799 dev accu =  tensor(0.6968, device='cuda:0')

Validation Results
Global Steps: 8799
Valid Loss: 0.78697
Valid Accuracy: 0.69678
time stamp: 1817.3014078140259
[]

Validation Results
Global Steps: 8999
Valid Loss: 0.79326
Valid Accuracy: 0.69343
time stamp: 1858.2068588733673
[]

Validation Results
Global Steps: 9199
Valid Loss: 0.82588
Valid Accuracy: 0.68115
time stamp: 1899.1622121334076
[]

Validation Results
Global Steps: 9399
Valid Loss: 0.77837
Valid Accuracy: 0.69547
time stamp: 1940.4574213027954
[]

Validation Results
Global Steps: 9599
Valid Loss: 0.78652
Valid Accuracy: 0.69588
time stamp: 1981.4329116344452
[]
best model saved: step =  9799 dev accu =  tensor(0.7030, device='cuda:0')

Validation Results
Global Steps: 9799
Valid Loss: 0.76509
Valid Accuracy: 0.70300
time stamp: 2022.5090408325195
[]

Validation Results
Global Steps: 9999
Valid Loss: 0.76739
Valid Accuracy: 0.70090
time stamp: 2063.7211649417877
[]

Validation Results
Global Steps: 10199
Valid Loss: 0.77231
Valid Accuracy: 0.69990
time stamp: 2104.77614235878
[]
best model saved: step =  10399 dev accu =  tensor(0.7083, device='cuda:0')

Validation Results
Global Steps: 10399
Valid Loss: 0.75895
Valid Accuracy: 0.70825
time stamp: 2145.3510551452637
[]

Validation Results
Global Steps: 10599
Valid Loss: 0.75835
Valid Accuracy: 0.70261
time stamp: 2186.2801456451416
[]

Validation Results
Global Steps: 10799
Valid Loss: 0.76928
Valid Accuracy: 0.70509
time stamp: 2227.273698091507
[]

Validation Results
Global Steps: 10999
Valid Loss: 0.76147
Valid Accuracy: 0.70381
time stamp: 2268.1864573955536
[]
best model saved: step =  11199 dev accu =  tensor(0.7113, device='cuda:0')

Validation Results
Global Steps: 11199
Valid Loss: 0.75779
Valid Accuracy: 0.71132
time stamp: 2309.4481604099274
[]

Validation Results
Global Steps: 11399
Valid Loss: 0.78107
Valid Accuracy: 0.70521
time stamp: 2350.3635623455048
[]

Validation Results
Global Steps: 11599
Valid Loss: 0.75671
Valid Accuracy: 0.70677
time stamp: 2391.2347507476807
[]
best model saved: step =  11799 dev accu =  tensor(0.7151, device='cuda:0')

Validation Results
Global Steps: 11799
Valid Loss: 0.74397
Valid Accuracy: 0.71509
time stamp: 2431.964512348175
[]

Validation Results
Global Steps: 11999
Valid Loss: 0.76736
Valid Accuracy: 0.70534
time stamp: 2473.0018644332886
[]
best model saved: step =  12199 dev accu =  tensor(0.7200, device='cuda:0')

Validation Results
Global Steps: 12199
Valid Loss: 0.74610
Valid Accuracy: 0.72004
time stamp: 2514.0431184768677
[]

Validation Results
Global Steps: 12399
Valid Loss: 0.75855
Valid Accuracy: 0.71045
time stamp: 2554.9464094638824
[]

Validation Results
Global Steps: 12599
Valid Loss: 0.72909
Valid Accuracy: 0.71764
time stamp: 2596.072840690613
[]

Validation Results
Global Steps: 12799
Valid Loss: 0.74202
Valid Accuracy: 0.71907
time stamp: 2636.774908542633
[]
best model saved: step =  12999 dev accu =  tensor(0.7219, device='cuda:0')

Validation Results
Global Steps: 12999
Valid Loss: 0.74477
Valid Accuracy: 0.72188
time stamp: 2677.7155010700226
[]

Validation Results
Global Steps: 13199
Valid Loss: 0.75695
Valid Accuracy: 0.71734
time stamp: 2718.6837246418
[]
best model saved: step =  13399 dev accu =  tensor(0.7221, device='cuda:0')

Validation Results
Global Steps: 13399
Valid Loss: 0.73962
Valid Accuracy: 0.72208
time stamp: 2759.603976726532
[]
best model saved: step =  13599 dev accu =  tensor(0.7246, device='cuda:0')

Validation Results
Global Steps: 13599
Valid Loss: 0.72808
Valid Accuracy: 0.72464
time stamp: 2800.4859528541565
[]

Validation Results
Global Steps: 13799
Valid Loss: 0.73337
Valid Accuracy: 0.71925
time stamp: 2841.139206647873
[]

Validation Results
Global Steps: 13999
Valid Loss: 0.74656
Valid Accuracy: 0.71646
time stamp: 2882.2356390953064
[]

Validation Results
Global Steps: 14199
Valid Loss: 0.73254
Valid Accuracy: 0.72228
time stamp: 2923.381418466568
[]
best model saved: step =  14399 dev accu =  tensor(0.7313, device='cuda:0')

Validation Results
Global Steps: 14399
Valid Loss: 0.72283
Valid Accuracy: 0.73134
time stamp: 2964.5004642009735
[]

Validation Results
Global Steps: 14599
Valid Loss: 0.72827
Valid Accuracy: 0.72554
time stamp: 3005.5631036758423
[]

Validation Results
Global Steps: 14799
Valid Loss: 0.72279
Valid Accuracy: 0.72791
time stamp: 3046.7536447048187
[]

Validation Results
Global Steps: 14999
Valid Loss: 0.71719
Valid Accuracy: 0.72968
time stamp: 3087.5017206668854
[]
best model saved: step =  15199 dev accu =  tensor(0.7350, device='cuda:0')

Validation Results
Global Steps: 15199
Valid Loss: 0.70100
Valid Accuracy: 0.73504
time stamp: 3128.200834751129
[]

Validation Results
Global Steps: 15399
Valid Loss: 0.72642
Valid Accuracy: 0.72507
time stamp: 3169.3316311836243
[]

Validation Results
Global Steps: 15599
Valid Loss: 0.73104
Valid Accuracy: 0.73301
time stamp: 3210.494432926178
[]

Validation Results
Global Steps: 15799
Valid Loss: 0.72379
Valid Accuracy: 0.73359
time stamp: 3251.4591360092163
[]

Validation Results
Global Steps: 15999
Valid Loss: 0.71183
Valid Accuracy: 0.73234
time stamp: 3292.4236369132996
[]
best model saved: step =  16199 dev accu =  tensor(0.7376, device='cuda:0')

Validation Results
Global Steps: 16199
Valid Loss: 0.69936
Valid Accuracy: 0.73764
time stamp: 3333.7764389514923
[]

Validation Results
Global Steps: 16399
Valid Loss: 0.70089
Valid Accuracy: 0.73384
time stamp: 3374.730268716812
[]

Validation Results
Global Steps: 16599
Valid Loss: 0.70809
Valid Accuracy: 0.73508
time stamp: 3415.554543733597
[]

Validation Results
Global Steps: 16799
Valid Loss: 0.70505
Valid Accuracy: 0.73197
time stamp: 3456.9979226589203
[]
best model saved: step =  16999 dev accu =  tensor(0.7392, device='cuda:0')

Validation Results
Global Steps: 16999
Valid Loss: 0.70956
Valid Accuracy: 0.73922
time stamp: 3497.9442670345306
[]
best model saved: step =  17199 dev accu =  tensor(0.7392, device='cuda:0')

Validation Results
Global Steps: 17199
Valid Loss: 0.69434
Valid Accuracy: 0.73923
time stamp: 3538.95063328743
[]
best model saved: step =  17399 dev accu =  tensor(0.7442, device='cuda:0')

Validation Results
Global Steps: 17399
Valid Loss: 0.68842
Valid Accuracy: 0.74421
time stamp: 3579.825693130493
[]

Validation Results
Global Steps: 17599
Valid Loss: 0.68718
Valid Accuracy: 0.74319
time stamp: 3620.7489721775055
[]
best model saved: step =  17799 dev accu =  tensor(0.7462, device='cuda:0')

Validation Results
Global Steps: 17799
Valid Loss: 0.67621
Valid Accuracy: 0.74619
time stamp: 3662.1054639816284
[]
best model saved: step =  17999 dev accu =  tensor(0.7481, device='cuda:0')

Validation Results
Global Steps: 17999
Valid Loss: 0.68116
Valid Accuracy: 0.74807
time stamp: 3703.2791924476624
[]
best model saved: step =  18199 dev accu =  tensor(0.7487, device='cuda:0')

Validation Results
Global Steps: 18199
Valid Loss: 0.67519
Valid Accuracy: 0.74873
time stamp: 3744.3774185180664
[]

Validation Results
Global Steps: 18399
Valid Loss: 0.69732
Valid Accuracy: 0.74291
time stamp: 3785.554510116577
[]

Validation Results
Global Steps: 18599
Valid Loss: 0.69636
Valid Accuracy: 0.74259
time stamp: 3826.5505018234253
[]

Validation Results
Global Steps: 18799
Valid Loss: 0.68246
Valid Accuracy: 0.74478
time stamp: 3867.165518283844
[]
best model saved: step =  18999 dev accu =  tensor(0.7522, device='cuda:0')

Validation Results
Global Steps: 18999
Valid Loss: 0.67929
Valid Accuracy: 0.75220
time stamp: 3908.614965438843
[]

Validation Results
Global Steps: 19199
Valid Loss: 0.68140
Valid Accuracy: 0.74684
time stamp: 3949.639502286911
[]
best model saved: step =  19399 dev accu =  tensor(0.7548, device='cuda:0')

Validation Results
Global Steps: 19399
Valid Loss: 0.66463
Valid Accuracy: 0.75481
time stamp: 3990.379581451416
[]
best model saved: step =  19599 dev accu =  tensor(0.7560, device='cuda:0')

Validation Results
Global Steps: 19599
Valid Loss: 0.65293
Valid Accuracy: 0.75597
time stamp: 4031.330242872238
[]

Validation Results
Global Steps: 19799
Valid Loss: 0.66670
Valid Accuracy: 0.75511
time stamp: 4072.6495196819305
[]

Validation Results
Global Steps: 19999
Valid Loss: 0.67029
Valid Accuracy: 0.75156
time stamp: 4114.004089355469
[]
best model saved: step =  20199 dev accu =  tensor(0.7575, device='cuda:0')

Validation Results
Global Steps: 20199
Valid Loss: 0.66398
Valid Accuracy: 0.75754
time stamp: 4155.006862878799
[]

Validation Results
Global Steps: 20399
Valid Loss: 0.68422
Valid Accuracy: 0.75189
time stamp: 4196.228285312653
[]
best model saved: step =  20599 dev accu =  tensor(0.7594, device='cuda:0')

Validation Results
Global Steps: 20599
Valid Loss: 0.65236
Valid Accuracy: 0.75937
time stamp: 4237.301062822342
[]
best model saved: step =  20799 dev accu =  tensor(0.7618, device='cuda:0')

Validation Results
Global Steps: 20799
Valid Loss: 0.65258
Valid Accuracy: 0.76182
time stamp: 4278.316330432892
[]

Validation Results
Global Steps: 20999
Valid Loss: 0.65067
Valid Accuracy: 0.75940
time stamp: 4319.288237571716
[]
best model saved: step =  21199 dev accu =  tensor(0.7650, device='cuda:0')

Validation Results
Global Steps: 21199
Valid Loss: 0.64537
Valid Accuracy: 0.76504
time stamp: 4360.145264387131
[]

Validation Results
Global Steps: 21399
Valid Loss: 0.65585
Valid Accuracy: 0.75917
time stamp: 4401.183700561523
[]

Validation Results
Global Steps: 21599
Valid Loss: 0.65027
Valid Accuracy: 0.76500
time stamp: 4442.039619684219
[]

Validation Results
Global Steps: 21799
Valid Loss: 0.66657
Valid Accuracy: 0.76171
time stamp: 4483.38449215889
[]

Validation Results
Global Steps: 21999
Valid Loss: 0.63927
Valid Accuracy: 0.76092
time stamp: 4524.554218530655
[]

Validation Results
Global Steps: 22199
Valid Loss: 0.64272
Valid Accuracy: 0.76389
time stamp: 4565.51894235611
[]
best model saved: step =  22399 dev accu =  tensor(0.7673, device='cuda:0')

Validation Results
Global Steps: 22399
Valid Loss: 0.63852
Valid Accuracy: 0.76728
time stamp: 4606.6643924713135
[]
best model saved: step =  22599 dev accu =  tensor(0.7677, device='cuda:0')

Validation Results
Global Steps: 22599
Valid Loss: 0.64168
Valid Accuracy: 0.76773
time stamp: 4647.626016139984
[]
best model saved: step =  22799 dev accu =  tensor(0.7694, device='cuda:0')

Validation Results
Global Steps: 22799
Valid Loss: 0.63334
Valid Accuracy: 0.76937
time stamp: 4688.805197954178
[]

Validation Results
Global Steps: 22999
Valid Loss: 0.64456
Valid Accuracy: 0.76599
time stamp: 4729.743903636932
[]

Validation Results
Global Steps: 23199
Valid Loss: 0.62367
Valid Accuracy: 0.76717
time stamp: 4770.864192247391
[]

Validation Results
Global Steps: 23399
Valid Loss: 0.65360
Valid Accuracy: 0.76482
time stamp: 4812.014807462692
[]
best model saved: step =  23599 dev accu =  tensor(0.7716, device='cuda:0')

Validation Results
Global Steps: 23599
Valid Loss: 0.62483
Valid Accuracy: 0.77160
time stamp: 4853.136662721634
[]
best model saved: step =  23799 dev accu =  tensor(0.7743, device='cuda:0')

Validation Results
Global Steps: 23799
Valid Loss: 0.62586
Valid Accuracy: 0.77428
time stamp: 4893.861517429352
[]

Validation Results
Global Steps: 23999
Valid Loss: 0.64414
Valid Accuracy: 0.76880
time stamp: 4934.955189704895
[]

Validation Results
Global Steps: 24199
Valid Loss: 0.62686
Valid Accuracy: 0.76925
time stamp: 4976.318110227585
[]

Validation Results
Global Steps: 24399
Valid Loss: 0.63503
Valid Accuracy: 0.77386
time stamp: 5017.254930496216
[]
best model saved: step =  24599 dev accu =  tensor(0.7780, device='cuda:0')

Validation Results
Global Steps: 24599
Valid Loss: 0.61961
Valid Accuracy: 0.77800
time stamp: 5058.335366010666
[]

Validation Results
Global Steps: 24799
Valid Loss: 0.61446
Valid Accuracy: 0.77415
time stamp: 5099.478219747543
[]

Validation Results
Global Steps: 24999
Valid Loss: 0.61561
Valid Accuracy: 0.77616
time stamp: 5140.268145799637
[]

Validation Results
Global Steps: 25199
Valid Loss: 0.61090
Valid Accuracy: 0.77729
time stamp: 5181.149066209793
[]
best model saved: step =  25399 dev accu =  tensor(0.7819, device='cuda:0')

Validation Results
Global Steps: 25399
Valid Loss: 0.60990
Valid Accuracy: 0.78191
time stamp: 5222.349838018417
[]
best model saved: step =  25599 dev accu =  tensor(0.7850, device='cuda:0')

Validation Results
Global Steps: 25599
Valid Loss: 0.61489
Valid Accuracy: 0.78497
time stamp: 5263.280640125275
[]

Validation Results
Global Steps: 25799
Valid Loss: 0.61743
Valid Accuracy: 0.78053
time stamp: 5304.477849245071
[]

Validation Results
Global Steps: 25999
Valid Loss: 0.60054
Valid Accuracy: 0.78452
time stamp: 5345.572590589523
[]

Validation Results
Global Steps: 26199
Valid Loss: 0.60165
Valid Accuracy: 0.78052
time stamp: 5386.771890163422
[]
best model saved: step =  26399 dev accu =  tensor(0.7869, device='cuda:0')

Validation Results
Global Steps: 26399
Valid Loss: 0.60450
Valid Accuracy: 0.78692
time stamp: 5427.944313764572
[]

Validation Results
Global Steps: 26599
Valid Loss: 0.61529
Valid Accuracy: 0.78008
time stamp: 5468.703748464584
[]
best model saved: step =  26799 dev accu =  tensor(0.7879, device='cuda:0')

Validation Results
Global Steps: 26799
Valid Loss: 0.59841
Valid Accuracy: 0.78793
time stamp: 5509.725771903992
[]

Validation Results
Global Steps: 26999
Valid Loss: 0.59456
Valid Accuracy: 0.78464
time stamp: 5550.703595161438
[]
best model saved: step =  27199 dev accu =  tensor(0.7920, device='cuda:0')

Validation Results
Global Steps: 27199
Valid Loss: 0.59456
Valid Accuracy: 0.79200
time stamp: 5591.350413799286
[]

Validation Results
Global Steps: 27399
Valid Loss: 0.59507
Valid Accuracy: 0.78841
time stamp: 5632.566098451614
[]

Validation Results
Global Steps: 27599
Valid Loss: 0.58943
Valid Accuracy: 0.79066
time stamp: 5673.461872577667
[]
best model saved: step =  27799 dev accu =  tensor(0.7947, device='cuda:0')

Validation Results
Global Steps: 27799
Valid Loss: 0.58918
Valid Accuracy: 0.79471
time stamp: 5714.3666524887085
[]

Validation Results
Global Steps: 27999
Valid Loss: 0.59281
Valid Accuracy: 0.79332
time stamp: 5755.474321603775
[]
best model saved: step =  28199 dev accu =  tensor(0.7971, device='cuda:0')

Validation Results
Global Steps: 28199
Valid Loss: 0.57743
Valid Accuracy: 0.79705
time stamp: 5796.499430656433
[]

Validation Results
Global Steps: 28399
Valid Loss: 0.59676
Valid Accuracy: 0.78843
time stamp: 5837.318491458893
[]

Validation Results
Global Steps: 28599
Valid Loss: 0.58283
Valid Accuracy: 0.79567
time stamp: 5878.76053237915
[]
best model saved: step =  28799 dev accu =  tensor(0.7998, device='cuda:0')

Validation Results
Global Steps: 28799
Valid Loss: 0.57888
Valid Accuracy: 0.79982
time stamp: 5919.644293785095
[]

Validation Results
Global Steps: 28999
Valid Loss: 0.57887
Valid Accuracy: 0.79430
time stamp: 5960.758798837662
[]

Validation Results
Global Steps: 29199
Valid Loss: 0.57319
Valid Accuracy: 0.79813
time stamp: 6002.0820026397705
[]

Validation Results
Global Steps: 29399
Valid Loss: 0.58287
Valid Accuracy: 0.79847
time stamp: 6043.260288953781
[]

Validation Results
Global Steps: 29599
Valid Loss: 0.55980
Valid Accuracy: 0.79771
time stamp: 6084.603933572769
[]

Validation Results
Global Steps: 29799
Valid Loss: 0.59129
Valid Accuracy: 0.79436
time stamp: 6125.79199051857
[]

Validation Results
Global Steps: 29999
Valid Loss: 0.59084
Valid Accuracy: 0.79686
time stamp: 6166.825268030167
total training step (k): 30.0
total training time (s): 6166.825958490372
total training time (ms): 1624351.017578125
peak memory usage (MB): 12858
allocated memory usage (MB): 401169874
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |   12031 KB |   12858 MB |  391767 GB |  391767 GB |
|       from large pool |    6144 KB |   12846 MB |  388410 GB |  388410 GB |
|       from small pool |    5887 KB |      27 MB |    3357 GB |    3357 GB |
|---------------------------------------------------------------------------|
| Active memory         |   12031 KB |   12858 MB |  391767 GB |  391767 GB |
|       from large pool |    6144 KB |   12846 MB |  388410 GB |  388410 GB |
|       from small pool |    5887 KB |      27 MB |    3357 GB |    3357 GB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   13776 MB |   13776 MB |   13776 MB |       0 B  |
|       from large pool |   13748 MB |   13748 MB |   13748 MB |       0 B  |
|       from small pool |      28 MB |      28 MB |      28 MB |       0 B  |
|---------------------------------------------------------------------------|
| Non-releasable memory |   12545 KB |    2058 MB |  476831 GB |  476831 GB |
|       from large pool |   10240 KB |    2054 MB |  473325 GB |  473325 GB |
|       from small pool |    2305 KB |       6 MB |    3506 GB |    3506 GB |
|---------------------------------------------------------------------------|
| Allocations           |     398    |     670    |   35730 K  |   35730 K  |
|       from large pool |       2    |      93    |   13740 K  |   13740 K  |
|       from small pool |     396    |     659    |   21990 K  |   21990 K  |
|---------------------------------------------------------------------------|
| Active allocs         |     398    |     670    |   35730 K  |   35730 K  |
|       from large pool |       2    |      93    |   13740 K  |   13740 K  |
|       from small pool |     396    |     659    |   21990 K  |   21990 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      42    |      42    |      42    |       0    |
|       from large pool |      28    |      28    |      28    |       0    |
|       from small pool |      14    |      14    |      14    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       9    |      29    |   16653 K  |   16653 K  |
|       from large pool |       2    |      19    |    6228 K  |    6228 K  |
|       from small pool |       7    |      19    |   10424 K  |   10424 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

loading the best model from: ./checkpoints/checkpoints-10/lra-news1/learnable.model
Evaluation Results
Loss: 0.57560
Accuracy: 0.80092
