GPU list: [0, 1, 2, 3]
[
    {
        "learn_pos_emb": true,
        "tied_weights": false,
        "embedding_dim": 64,
        "transformer_dim": 64,
        "transformer_hidden_dim": 128,
        "head_dim": 32,
        "num_head": 2,
        "num_layers": 4,
        "vocab_size": 512,
        "max_seq_len": 1024,
        "dropout_prob": 0.1,
        "attention_dropout": 0.1,
        "pooling_mode": "MEAN",
        "num_classes": 2,
        "block_size": 32,
        "batch_size": 128,
        "density": 0.05,
        "mixed_precision": true,
        "random_seed": 10,
        "task": "lra-yelp1"
    },
    {
        "batch_size": 512,
        "learning_rate": 0.0007,
        "warmup": 80,
        "lr_decay": "linear",
        "weight_decay": 0,
        "eval_frequency": 200,
        "num_train_steps": 30000,
        "num_init_steps": 17000,
        "num_eval_steps": 200,
        "num_dense_train_steps": 1000,
        "patience": 10,
        "attn_loss_scale": 0.01
    }
]
attn_mask compile
attn_mask compile
attn_mask compile
attn_mask compile
DataParallel(
  (module): ModelForSC(
    (model): Model(
      (embeddings): Embeddings(
        (word_embeddings): Embedding(512, 64)
        (position_embeddings): Embedding(1024, 64)
        (dropout): Dropout(p=0.1, inplace=False)
      )
      (transformer_0): TransformerLayer(
        (norm1): LayerNorm((64,), eps=1e-05, elementwise_affine=True)
        (mha): Attention(
          (W_q): Linear(in_features=64, out_features=64, bias=True)
          (W_k): Linear(in_features=64, out_features=64, bias=True)
          (W_v): Linear(in_features=64, out_features=64, bias=True)
          (avg_pool): AvgPool2d(kernel_size=32, stride=32, padding=0)
          (MSEloss): MSELoss()
          (attn): CUDAMaskAttention()
          (ff): Linear(in_features=64, out_features=64, bias=True)
        )
        (dropout1): Dropout(p=0.1, inplace=False)
        (norm2): LayerNorm((64,), eps=1e-05, elementwise_affine=True)
        (mlpblock): Sequential(
          (0): Linear(in_features=64, out_features=128, bias=True)
          (1): GELU(approximate='none')
          (2): Dropout(p=0.1, inplace=False)
          (3): Linear(in_features=128, out_features=64, bias=True)
          (4): Dropout(p=0.1, inplace=False)
        )
      )
      (transformer_1): TransformerLayer(
        (norm1): LayerNorm((64,), eps=1e-05, elementwise_affine=True)
        (mha): Attention(
          (W_q): Linear(in_features=64, out_features=64, bias=True)
          (W_k): Linear(in_features=64, out_features=64, bias=True)
          (W_v): Linear(in_features=64, out_features=64, bias=True)
          (avg_pool): AvgPool2d(kernel_size=32, stride=32, padding=0)
          (MSEloss): MSELoss()
          (attn): CUDAMaskAttention()
          (ff): Linear(in_features=64, out_features=64, bias=True)
        )
        (dropout1): Dropout(p=0.1, inplace=False)
        (norm2): LayerNorm((64,), eps=1e-05, elementwise_affine=True)
        (mlpblock): Sequential(
          (0): Linear(in_features=64, out_features=128, bias=True)
          (1): GELU(approximate='none')
          (2): Dropout(p=0.1, inplace=False)
          (3): Linear(in_features=128, out_features=64, bias=True)
          (4): Dropout(p=0.1, inplace=False)
        )
      )
      (transformer_2): TransformerLayer(
        (norm1): LayerNorm((64,), eps=1e-05, elementwise_affine=True)
        (mha): Attention(
          (W_q): Linear(in_features=64, out_features=64, bias=True)
          (W_k): Linear(in_features=64, out_features=64, bias=True)
          (W_v): Linear(in_features=64, out_features=64, bias=True)
          (avg_pool): AvgPool2d(kernel_size=32, stride=32, padding=0)
          (MSEloss): MSELoss()
          (attn): CUDAMaskAttention()
          (ff): Linear(in_features=64, out_features=64, bias=True)
        )
        (dropout1): Dropout(p=0.1, inplace=False)
        (norm2): LayerNorm((64,), eps=1e-05, elementwise_affine=True)
        (mlpblock): Sequential(
          (0): Linear(in_features=64, out_features=128, bias=True)
          (1): GELU(approximate='none')
          (2): Dropout(p=0.1, inplace=False)
          (3): Linear(in_features=128, out_features=64, bias=True)
          (4): Dropout(p=0.1, inplace=False)
        )
      )
      (transformer_3): TransformerLayer(
        (norm1): LayerNorm((64,), eps=1e-05, elementwise_affine=True)
        (mha): Attention(
          (W_q): Linear(in_features=64, out_features=64, bias=True)
          (W_k): Linear(in_features=64, out_features=64, bias=True)
          (W_v): Linear(in_features=64, out_features=64, bias=True)
          (avg_pool): AvgPool2d(kernel_size=32, stride=32, padding=0)
          (MSEloss): MSELoss()
          (attn): CUDAMaskAttention()
          (ff): Linear(in_features=64, out_features=64, bias=True)
        )
        (dropout1): Dropout(p=0.1, inplace=False)
        (norm2): LayerNorm((64,), eps=1e-05, elementwise_affine=True)
        (mlpblock): Sequential(
          (0): Linear(in_features=64, out_features=128, bias=True)
          (1): GELU(approximate='none')
          (2): Dropout(p=0.1, inplace=False)
          (3): Linear(in_features=128, out_features=64, bias=True)
          (4): Dropout(p=0.1, inplace=False)
        )
      )
      (norm): LayerNorm((64,), eps=1e-05, elementwise_affine=True)
    )
    (seq_classifer): SCHead(
      (mlpblock): Sequential(
        (0): Linear(in_features=64, out_features=128, bias=True)
        (1): ReLU()
        (2): Linear(in_features=128, out_features=2, bias=True)
      )
    )
  )
)
parameter_size: [torch.Size([512, 64]), torch.Size([1024, 64]), torch.Size([64]), torch.Size([64]), torch.Size([32, 32]), torch.Size([64, 64]), torch.Size([64]), torch.Size([64, 64]), torch.Size([64]), torch.Size([64, 64]), torch.Size([64]), torch.Size([64, 64]), torch.Size([64]), torch.Size([64]), torch.Size([64]), torch.Size([128, 64]), torch.Size([128]), torch.Size([64, 128]), torch.Size([64]), torch.Size([64]), torch.Size([64]), torch.Size([32, 32]), torch.Size([64, 64]), torch.Size([64]), torch.Size([64, 64]), torch.Size([64]), torch.Size([64, 64]), torch.Size([64]), torch.Size([64, 64]), torch.Size([64]), torch.Size([64]), torch.Size([64]), torch.Size([128, 64]), torch.Size([128]), torch.Size([64, 128]), torch.Size([64]), torch.Size([64]), torch.Size([64]), torch.Size([32, 32]), torch.Size([64, 64]), torch.Size([64]), torch.Size([64, 64]), torch.Size([64]), torch.Size([64, 64]), torch.Size([64]), torch.Size([64, 64]), torch.Size([64]), torch.Size([64]), torch.Size([64]), torch.Size([128, 64]), torch.Size([128]), torch.Size([64, 128]), torch.Size([64]), torch.Size([64]), torch.Size([64]), torch.Size([32, 32]), torch.Size([64, 64]), torch.Size([64]), torch.Size([64, 64]), torch.Size([64]), torch.Size([64, 64]), torch.Size([64]), torch.Size([64, 64]), torch.Size([64]), torch.Size([64]), torch.Size([64]), torch.Size([128, 64]), torch.Size([128]), torch.Size([64, 128]), torch.Size([64]), torch.Size([64]), torch.Size([64]), torch.Size([128, 64]), torch.Size([128]), torch.Size([2, 128]), torch.Size([2])]
num_parameter: 244994
Loaded ../Skyformer/data/lra_processed/lra-yelp1.train.pickle... size=560000
Loaded ../Skyformer/data/lra_processed/lra-yelp1.dev.pickle... size=38000
Loaded ../Skyformer/data/lra_processed/lra-yelp1.test.pickle... size=38000
accumu_steps=1
[tensor([27.0792, 27.0793, 27.0793, 27.0792], device='cuda:0',
       grad_fn=<GatherBackward>), tensor([31.5024, 31.5024, 31.5024, 31.5024], device='cuda:0',
       grad_fn=<GatherBackward>), tensor([29.7579, 29.7579, 29.7579, 29.7579], device='cuda:0',
       grad_fn=<GatherBackward>), tensor([31.5367, 31.5367, 31.5367, 31.5367], device='cuda:0',
       grad_fn=<GatherBackward>)]
best model saved: step =  199 dev accu =  tensor(0.7150, device='cuda:0')

Validation Results
Global Steps: 199
Valid Loss: 0.55896
Valid Accuracy: 0.71498
time stamp: 163.69407105445862
[tensor([11.6544, 11.6544, 11.6545, 11.6545], device='cuda:0',
       grad_fn=<GatherBackward>), tensor([13.7041, 13.7041, 13.7041, 13.7042], device='cuda:0',
       grad_fn=<GatherBackward>), tensor([12.9493, 12.9493, 12.9493, 12.9493], device='cuda:0',
       grad_fn=<GatherBackward>), tensor([13.7935, 13.7935, 13.7935, 13.7935], device='cuda:0',
       grad_fn=<GatherBackward>)]
best model saved: step =  399 dev accu =  tensor(0.7281, device='cuda:0')

Validation Results
Global Steps: 399
Valid Loss: 0.53738
Valid Accuracy: 0.72811
time stamp: 325.60569882392883
[tensor([5.8476, 5.8475, 5.8476, 5.8476], device='cuda:0',
       grad_fn=<GatherBackward>), tensor([6.8808, 6.8808, 6.8808, 6.8808], device='cuda:0',
       grad_fn=<GatherBackward>), tensor([6.5320, 6.5320, 6.5320, 6.5320], device='cuda:0',
       grad_fn=<GatherBackward>), tensor([6.9534, 6.9533, 6.9534, 6.9534], device='cuda:0',
       grad_fn=<GatherBackward>)]

Validation Results
Global Steps: 599
Valid Loss: 0.55126
Valid Accuracy: 0.72145
time stamp: 488.6557312011719
[tensor([3.3111, 3.3112, 3.3111, 3.3112], device='cuda:0',
       grad_fn=<GatherBackward>), tensor([3.8732, 3.8732, 3.8732, 3.8732], device='cuda:0',
       grad_fn=<GatherBackward>), tensor([3.7033, 3.7034, 3.7033, 3.7034], device='cuda:0',
       grad_fn=<GatherBackward>), tensor([3.9211, 3.9211, 3.9211, 3.9211], device='cuda:0',
       grad_fn=<GatherBackward>)]
best model saved: step =  799 dev accu =  tensor(0.7354, device='cuda:0')

Validation Results
Global Steps: 799
Valid Loss: 0.52720
Valid Accuracy: 0.73544
time stamp: 652.31769323349
[tensor([2.0636, 2.0636, 2.0636, 2.0636], device='cuda:0',
       grad_fn=<GatherBackward>), tensor([2.3900, 2.3900, 2.3900, 2.3900], device='cuda:0',
       grad_fn=<GatherBackward>), tensor([2.3044, 2.3044, 2.3044, 2.3043], device='cuda:0',
       grad_fn=<GatherBackward>), tensor([2.4185, 2.4185, 2.4185, 2.4185], device='cuda:0',
       grad_fn=<GatherBackward>)]
best model saved: step =  999 dev accu =  tensor(0.7357, device='cuda:0')

Validation Results
Global Steps: 999
Valid Loss: 0.52674
Valid Accuracy: 0.73569
time stamp: 815.9987120628357
[tensor([1.3878, 1.3878, 1.3878, 1.3878], device='cuda:0',
       grad_fn=<GatherBackward>), tensor([1.5886, 1.5886, 1.5886, 1.5886], device='cuda:0',
       grad_fn=<GatherBackward>), tensor([1.5445, 1.5445, 1.5445, 1.5445], device='cuda:0',
       grad_fn=<GatherBackward>), tensor([1.6039, 1.6039, 1.6039, 1.6039], device='cuda:0',
       grad_fn=<GatherBackward>)]
best model saved: step =  1199 dev accu =  tensor(0.7391, device='cuda:0')

Validation Results
Global Steps: 1199
Valid Loss: 0.51790
Valid Accuracy: 0.73913
time stamp: 979.7606022357941
[tensor([0.9911, 0.9911, 0.9911, 0.9911], device='cuda:0',
       grad_fn=<GatherBackward>), tensor([1.1213, 1.1213, 1.1213, 1.1213], device='cuda:0',
       grad_fn=<GatherBackward>), tensor([1.0984, 1.0984, 1.0984, 1.0984], device='cuda:0',
       grad_fn=<GatherBackward>), tensor([1.1282, 1.1282, 1.1282, 1.1282], device='cuda:0',
       grad_fn=<GatherBackward>)]
best model saved: step =  1399 dev accu =  tensor(0.7408, device='cuda:0')

Validation Results
Global Steps: 1399
Valid Loss: 0.51736
Valid Accuracy: 0.74078
time stamp: 1143.87122964859
[tensor([0.7417, 0.7417, 0.7417, 0.7417], device='cuda:0',
       grad_fn=<GatherBackward>), tensor([0.8306, 0.8306, 0.8306, 0.8306], device='cuda:0',
       grad_fn=<GatherBackward>), tensor([0.8185, 0.8185, 0.8185, 0.8185], device='cuda:0',
       grad_fn=<GatherBackward>), tensor([0.8325, 0.8325, 0.8324, 0.8325], device='cuda:0',
       grad_fn=<GatherBackward>)]
best model saved: step =  1599 dev accu =  tensor(0.7409, device='cuda:0')

Validation Results
Global Steps: 1599
Valid Loss: 0.51383
Valid Accuracy: 0.74087
time stamp: 1308.6955091953278
[tensor([0.5755, 0.5755, 0.5755, 0.5755], device='cuda:0',
       grad_fn=<GatherBackward>), tensor([0.6392, 0.6392, 0.6392, 0.6392], device='cuda:0',
       grad_fn=<GatherBackward>), tensor([0.6327, 0.6327, 0.6327, 0.6327], device='cuda:0',
       grad_fn=<GatherBackward>), tensor([0.6383, 0.6383, 0.6383, 0.6383], device='cuda:0',
       grad_fn=<GatherBackward>)]

Validation Results
Global Steps: 1799
Valid Loss: 0.52914
Valid Accuracy: 0.73487
time stamp: 1472.2401566505432
[tensor([0.4590, 0.4590, 0.4590, 0.4590], device='cuda:0',
       grad_fn=<GatherBackward>), tensor([0.5069, 0.5069, 0.5069, 0.5069], device='cuda:0',
       grad_fn=<GatherBackward>), tensor([0.5030, 0.5030, 0.5030, 0.5030], device='cuda:0',
       grad_fn=<GatherBackward>), tensor([0.5045, 0.5045, 0.5045, 0.5045], device='cuda:0',
       grad_fn=<GatherBackward>)]

Validation Results
Global Steps: 1999
Valid Loss: 0.52596
Valid Accuracy: 0.73683
time stamp: 1636.6156346797943
[tensor([0.3737, 0.3737, 0.3737, 0.3737], device='cuda:0',
       grad_fn=<GatherBackward>), tensor([0.4113, 0.4113, 0.4113, 0.4113], device='cuda:0',
       grad_fn=<GatherBackward>), tensor([0.4087, 0.4086, 0.4086, 0.4087], device='cuda:0',
       grad_fn=<GatherBackward>), tensor([0.4084, 0.4084, 0.4084, 0.4084], device='cuda:0',
       grad_fn=<GatherBackward>)]
best model saved: step =  2199 dev accu =  tensor(0.7435, device='cuda:0')

Validation Results
Global Steps: 2199
Valid Loss: 0.51108
Valid Accuracy: 0.74349
time stamp: 1801.3833010196686
[tensor([0.3090, 0.3090, 0.3090, 0.3090], device='cuda:0',
       grad_fn=<GatherBackward>), tensor([0.3397, 0.3397, 0.3397, 0.3397], device='cuda:0',
       grad_fn=<GatherBackward>), tensor([0.3374, 0.3374, 0.3374, 0.3374], device='cuda:0',
       grad_fn=<GatherBackward>), tensor([0.3368, 0.3368, 0.3368, 0.3368], device='cuda:0',
       grad_fn=<GatherBackward>)]

Validation Results
Global Steps: 2399
Valid Loss: 0.52260
Valid Accuracy: 0.74081
time stamp: 1966.029086112976
[tensor([0.2584, 0.2584, 0.2584, 0.2584], device='cuda:0',
       grad_fn=<GatherBackward>), tensor([0.2844, 0.2844, 0.2844, 0.2844], device='cuda:0',
       grad_fn=<GatherBackward>), tensor([0.2821, 0.2821, 0.2821, 0.2821], device='cuda:0',
       grad_fn=<GatherBackward>), tensor([0.2816, 0.2816, 0.2816, 0.2816], device='cuda:0',
       grad_fn=<GatherBackward>)]
best model saved: step =  2599 dev accu =  tensor(0.7458, device='cuda:0')

Validation Results
Global Steps: 2599
Valid Loss: 0.51876
Valid Accuracy: 0.74579
time stamp: 2131.3374218940735
[tensor([0.2180, 0.2180, 0.2180, 0.2180], device='cuda:0',
       grad_fn=<GatherBackward>), tensor([0.2404, 0.2404, 0.2404, 0.2404], device='cuda:0',
       grad_fn=<GatherBackward>), tensor([0.2380, 0.2380, 0.2380, 0.2380], device='cuda:0',
       grad_fn=<GatherBackward>), tensor([0.2380, 0.2380, 0.2380, 0.2380], device='cuda:0',
       grad_fn=<GatherBackward>)]

Validation Results
Global Steps: 2799
Valid Loss: 0.51608
Valid Accuracy: 0.74123
time stamp: 2296.116397857666
[tensor([0.1850, 0.1850, 0.1850, 0.1850], device='cuda:0',
       grad_fn=<GatherBackward>), tensor([0.2047, 0.2048, 0.2048, 0.2047], device='cuda:0',
       grad_fn=<GatherBackward>), tensor([0.2022, 0.2022, 0.2022, 0.2022], device='cuda:0',
       grad_fn=<GatherBackward>), tensor([0.2028, 0.2028, 0.2028, 0.2028], device='cuda:0',
       grad_fn=<GatherBackward>)]
best model saved: step =  2999 dev accu =  tensor(0.7478, device='cuda:0')

Validation Results
Global Steps: 2999
Valid Loss: 0.50881
Valid Accuracy: 0.74783
time stamp: 2460.6311132907867
[tensor([0.1578, 0.1578, 0.1578, 0.1578], device='cuda:0',
       grad_fn=<GatherBackward>), tensor([0.1753, 0.1753, 0.1753, 0.1753], device='cuda:0',
       grad_fn=<GatherBackward>), tensor([0.1726, 0.1726, 0.1726, 0.1726], device='cuda:0',
       grad_fn=<GatherBackward>), tensor([0.1738, 0.1738, 0.1738, 0.1738], device='cuda:0',
       grad_fn=<GatherBackward>)]

Validation Results
Global Steps: 3199
Valid Loss: 0.51680
Valid Accuracy: 0.74124
time stamp: 2624.918253183365
[tensor([0.1350, 0.1350, 0.1350, 0.1350], device='cuda:0',
       grad_fn=<GatherBackward>), tensor([0.1507, 0.1507, 0.1507, 0.1507], device='cuda:0',
       grad_fn=<GatherBackward>), tensor([0.1479, 0.1479, 0.1479, 0.1479], device='cuda:0',
       grad_fn=<GatherBackward>), tensor([0.1495, 0.1495, 0.1495, 0.1495], device='cuda:0',
       grad_fn=<GatherBackward>)]

Validation Results
Global Steps: 3399
Valid Loss: 0.51025
Valid Accuracy: 0.74482
time stamp: 2789.981171131134
[tensor([0.1157, 0.1157, 0.1157, 0.1157], device='cuda:0',
       grad_fn=<GatherBackward>), tensor([0.1299, 0.1299, 0.1299, 0.1299], device='cuda:0',
       grad_fn=<GatherBackward>), tensor([0.1271, 0.1271, 0.1271, 0.1271], device='cuda:0',
       grad_fn=<GatherBackward>), tensor([0.1290, 0.1290, 0.1290, 0.1290], device='cuda:0',
       grad_fn=<GatherBackward>)]
best model saved: step =  3599 dev accu =  tensor(0.7479, device='cuda:0')

Validation Results
Global Steps: 3599
Valid Loss: 0.50547
Valid Accuracy: 0.74787
time stamp: 2954.60516500473
[tensor([0.0994, 0.0994, 0.0994, 0.0994], device='cuda:0',
       grad_fn=<GatherBackward>), tensor([0.1122, 0.1122, 0.1122, 0.1122], device='cuda:0',
       grad_fn=<GatherBackward>), tensor([0.1094, 0.1094, 0.1094, 0.1094], device='cuda:0',
       grad_fn=<GatherBackward>), tensor([0.1115, 0.1115, 0.1115, 0.1115], device='cuda:0',
       grad_fn=<GatherBackward>)]

Validation Results
Global Steps: 3799
Valid Loss: 0.50893
Valid Accuracy: 0.74784
time stamp: 3119.2832815647125
[tensor([0.0854, 0.0854, 0.0854, 0.0854], device='cuda:0',
       grad_fn=<GatherBackward>), tensor([0.0970, 0.0970, 0.0970, 0.0970], device='cuda:0',
       grad_fn=<GatherBackward>), tensor([0.0942, 0.0942, 0.0942, 0.0942], device='cuda:0',
       grad_fn=<GatherBackward>), tensor([0.0966, 0.0965, 0.0966, 0.0966], device='cuda:0',
       grad_fn=<GatherBackward>)]

Validation Results
Global Steps: 3999
Valid Loss: 0.50511
Valid Accuracy: 0.74623
time stamp: 3284.8822090625763
[tensor([0.0735, 0.0735, 0.0735, 0.0735], device='cuda:0',
       grad_fn=<GatherBackward>), tensor([0.0840, 0.0840, 0.0840, 0.0840], device='cuda:0',
       grad_fn=<GatherBackward>), tensor([0.0813, 0.0813, 0.0813, 0.0813], device='cuda:0',
       grad_fn=<GatherBackward>), tensor([0.0836, 0.0836, 0.0836, 0.0836], device='cuda:0',
       grad_fn=<GatherBackward>)]

Validation Results
Global Steps: 4199
Valid Loss: 0.51215
Valid Accuracy: 0.74487
time stamp: 3451.9271428585052
[tensor([0.0633, 0.0633, 0.0633, 0.0633], device='cuda:0',
       grad_fn=<GatherBackward>), tensor([0.0727, 0.0727, 0.0727, 0.0727], device='cuda:0',
       grad_fn=<GatherBackward>), tensor([0.0701, 0.0701, 0.0701, 0.0701], device='cuda:0',
       grad_fn=<GatherBackward>), tensor([0.0724, 0.0724, 0.0724, 0.0724], device='cuda:0',
       grad_fn=<GatherBackward>)]
best model saved: step =  4399 dev accu =  tensor(0.7505, device='cuda:0')

Validation Results
Global Steps: 4399
Valid Loss: 0.50205
Valid Accuracy: 0.75046
time stamp: 3617.6780421733856
[tensor([0.0544, 0.0544, 0.0544, 0.0544], device='cuda:0',
       grad_fn=<GatherBackward>), tensor([0.0629, 0.0629, 0.0629, 0.0629], device='cuda:0',
       grad_fn=<GatherBackward>), tensor([0.0605, 0.0605, 0.0605, 0.0605], device='cuda:0',
       grad_fn=<GatherBackward>), tensor([0.0627, 0.0627, 0.0627, 0.0627], device='cuda:0',
       grad_fn=<GatherBackward>)]

Validation Results
Global Steps: 4599
Valid Loss: 0.50659
Valid Accuracy: 0.75042
time stamp: 3782.810446739197
[tensor([0.0468, 0.0468, 0.0468, 0.0468], device='cuda:0',
       grad_fn=<GatherBackward>), tensor([0.0544, 0.0544, 0.0544, 0.0544], device='cuda:0',
       grad_fn=<GatherBackward>), tensor([0.0522, 0.0522, 0.0522, 0.0522], device='cuda:0',
       grad_fn=<GatherBackward>), tensor([0.0543, 0.0543, 0.0543, 0.0543], device='cuda:0',
       grad_fn=<GatherBackward>)]
best model saved: step =  4799 dev accu =  tensor(0.7511, device='cuda:0')

Validation Results
Global Steps: 4799
Valid Loss: 0.50060
Valid Accuracy: 0.75114
time stamp: 3947.972119808197
[tensor([0.0403, 0.0403, 0.0403, 0.0403], device='cuda:0',
       grad_fn=<GatherBackward>), tensor([0.0471, 0.0471, 0.0471, 0.0471], device='cuda:0',
       grad_fn=<GatherBackward>), tensor([0.0450, 0.0450, 0.0450, 0.0450], device='cuda:0',
       grad_fn=<GatherBackward>), tensor([0.0470, 0.0470, 0.0470, 0.0470], device='cuda:0',
       grad_fn=<GatherBackward>)]

Validation Results
Global Steps: 4999
Valid Loss: 0.50181
Valid Accuracy: 0.75114
time stamp: 4113.335808992386
[tensor([0.0347, 0.0347, 0.0347, 0.0347], device='cuda:0',
       grad_fn=<GatherBackward>), tensor([0.0407, 0.0407, 0.0407, 0.0407], device='cuda:0',
       grad_fn=<GatherBackward>), tensor([0.0388, 0.0388, 0.0388, 0.0388], device='cuda:0',
       grad_fn=<GatherBackward>), tensor([0.0406, 0.0406, 0.0406, 0.0406], device='cuda:0',
       grad_fn=<GatherBackward>)]

Validation Results
Global Steps: 5199
Valid Loss: 0.50134
Valid Accuracy: 0.74771
time stamp: 4277.873231172562
[tensor([0.0298, 0.0298, 0.0298, 0.0298], device='cuda:0',
       grad_fn=<GatherBackward>), tensor([0.0351, 0.0351, 0.0351, 0.0351], device='cuda:0',
       grad_fn=<GatherBackward>), tensor([0.0334, 0.0334, 0.0334, 0.0334], device='cuda:0',
       grad_fn=<GatherBackward>), tensor([0.0351, 0.0351, 0.0351, 0.0351], device='cuda:0',
       grad_fn=<GatherBackward>)]

Validation Results
Global Steps: 5399
Valid Loss: 0.50610
Valid Accuracy: 0.74643
time stamp: 4442.616343975067
[tensor([0.0256, 0.0256, 0.0256, 0.0256], device='cuda:0',
       grad_fn=<GatherBackward>), tensor([0.0303, 0.0303, 0.0303, 0.0303], device='cuda:0',
       grad_fn=<GatherBackward>), tensor([0.0288, 0.0288, 0.0288, 0.0288], device='cuda:0',
       grad_fn=<GatherBackward>), tensor([0.0303, 0.0303, 0.0303, 0.0303], device='cuda:0',
       grad_fn=<GatherBackward>)]
best model saved: step =  5599 dev accu =  tensor(0.7517, device='cuda:0')

Validation Results
Global Steps: 5599
Valid Loss: 0.50731
Valid Accuracy: 0.75166
time stamp: 4607.166040420532
[tensor([0.0220, 0.0220, 0.0220, 0.0220], device='cuda:0',
       grad_fn=<GatherBackward>), tensor([0.0262, 0.0262, 0.0262, 0.0262], device='cuda:0',
       grad_fn=<GatherBackward>), tensor([0.0248, 0.0248, 0.0248, 0.0248], device='cuda:0',
       grad_fn=<GatherBackward>), tensor([0.0261, 0.0261, 0.0261, 0.0261], device='cuda:0',
       grad_fn=<GatherBackward>)]

Validation Results
Global Steps: 5799
Valid Loss: 0.50258
Valid Accuracy: 0.75129
time stamp: 4771.684936285019
[tensor([0.0189, 0.0189, 0.0189, 0.0189], device='cuda:0',
       grad_fn=<GatherBackward>), tensor([0.0225, 0.0225, 0.0225, 0.0225], device='cuda:0',
       grad_fn=<GatherBackward>), tensor([0.0213, 0.0213, 0.0213, 0.0213], device='cuda:0',
       grad_fn=<GatherBackward>), tensor([0.0225, 0.0225, 0.0225, 0.0225], device='cuda:0',
       grad_fn=<GatherBackward>)]
best model saved: step =  5999 dev accu =  tensor(0.7520, device='cuda:0')

Validation Results
Global Steps: 5999
Valid Loss: 0.50080
Valid Accuracy: 0.75195
time stamp: 4936.392301559448
[tensor([0.0162, 0.0162, 0.0162, 0.0162], device='cuda:0',
       grad_fn=<GatherBackward>), tensor([0.0194, 0.0194, 0.0194, 0.0194], device='cuda:0',
       grad_fn=<GatherBackward>), tensor([0.0183, 0.0183, 0.0183, 0.0183], device='cuda:0',
       grad_fn=<GatherBackward>), tensor([0.0194, 0.0194, 0.0194, 0.0194], device='cuda:0',
       grad_fn=<GatherBackward>)]
best model saved: step =  6199 dev accu =  tensor(0.7526, device='cuda:0')

Validation Results
Global Steps: 6199
Valid Loss: 0.49647
Valid Accuracy: 0.75260
time stamp: 5101.557291269302
[tensor([0.0139, 0.0139, 0.0139, 0.0139], device='cuda:0',
       grad_fn=<GatherBackward>), tensor([0.0167, 0.0167, 0.0167, 0.0167], device='cuda:0',
       grad_fn=<GatherBackward>), tensor([0.0157, 0.0157, 0.0157, 0.0157], device='cuda:0',
       grad_fn=<GatherBackward>), tensor([0.0166, 0.0166, 0.0166, 0.0166], device='cuda:0',
       grad_fn=<GatherBackward>)]
best model saved: step =  6399 dev accu =  tensor(0.7556, device='cuda:0')

Validation Results
Global Steps: 6399
Valid Loss: 0.49657
Valid Accuracy: 0.75562
time stamp: 5267.061648368835
[tensor([0.0119, 0.0119, 0.0119, 0.0119], device='cuda:0',
       grad_fn=<GatherBackward>), tensor([0.0143, 0.0143, 0.0143, 0.0143], device='cuda:0',
       grad_fn=<GatherBackward>), tensor([0.0135, 0.0135, 0.0135, 0.0135], device='cuda:0',
       grad_fn=<GatherBackward>), tensor([0.0143, 0.0143, 0.0143, 0.0143], device='cuda:0',
       grad_fn=<GatherBackward>)]

Validation Results
Global Steps: 6599
Valid Loss: 0.49427
Valid Accuracy: 0.75382
time stamp: 5434.020370006561
[tensor([0.0101, 0.0102, 0.0101, 0.0102], device='cuda:0',
       grad_fn=<GatherBackward>), tensor([0.0123, 0.0123, 0.0123, 0.0123], device='cuda:0',
       grad_fn=<GatherBackward>), tensor([0.0116, 0.0116, 0.0116, 0.0116], device='cuda:0',
       grad_fn=<GatherBackward>), tensor([0.0123, 0.0123, 0.0123, 0.0123], device='cuda:0',
       grad_fn=<GatherBackward>)]

Validation Results
Global Steps: 6799
Valid Loss: 0.50228
Valid Accuracy: 0.75286
time stamp: 5599.736950874329
[tensor([0.0087, 0.0087, 0.0087, 0.0087], device='cuda:0',
       grad_fn=<GatherBackward>), tensor([0.0106, 0.0106, 0.0106, 0.0106], device='cuda:0',
       grad_fn=<GatherBackward>), tensor([0.0099, 0.0099, 0.0099, 0.0099], device='cuda:0',
       grad_fn=<GatherBackward>), tensor([0.0105, 0.0105, 0.0105, 0.0105], device='cuda:0',
       grad_fn=<GatherBackward>)]

Validation Results
Global Steps: 6999
Valid Loss: 0.49557
Valid Accuracy: 0.75406
time stamp: 5764.744298458099
[tensor([0.0074, 0.0074, 0.0074, 0.0074], device='cuda:0',
       grad_fn=<GatherBackward>), tensor([0.0090, 0.0090, 0.0090, 0.0090], device='cuda:0',
       grad_fn=<GatherBackward>), tensor([0.0085, 0.0085, 0.0085, 0.0085], device='cuda:0',
       grad_fn=<GatherBackward>), tensor([0.0090, 0.0090, 0.0090, 0.0090], device='cuda:0',
       grad_fn=<GatherBackward>)]

Validation Results
Global Steps: 7199
Valid Loss: 0.49544
Valid Accuracy: 0.75253
time stamp: 5931.273271560669
[tensor([0.0063, 0.0063, 0.0063, 0.0063], device='cuda:0',
       grad_fn=<GatherBackward>), tensor([0.0077, 0.0077, 0.0077, 0.0077], device='cuda:0',
       grad_fn=<GatherBackward>), tensor([0.0072, 0.0072, 0.0072, 0.0072], device='cuda:0',
       grad_fn=<GatherBackward>), tensor([0.0077, 0.0077, 0.0077, 0.0077], device='cuda:0',
       grad_fn=<GatherBackward>)]

Validation Results
Global Steps: 7399
Valid Loss: 0.49613
Valid Accuracy: 0.75562
time stamp: 6096.193898200989
[tensor([0.0054, 0.0054, 0.0054, 0.0054], device='cuda:0',
       grad_fn=<GatherBackward>), tensor([0.0066, 0.0066, 0.0066, 0.0066], device='cuda:0',
       grad_fn=<GatherBackward>), tensor([0.0062, 0.0062, 0.0062, 0.0062], device='cuda:0',
       grad_fn=<GatherBackward>), tensor([0.0066, 0.0066, 0.0066, 0.0066], device='cuda:0',
       grad_fn=<GatherBackward>)]
best model saved: step =  7599 dev accu =  tensor(0.7558, device='cuda:0')

Validation Results
Global Steps: 7599
Valid Loss: 0.49226
Valid Accuracy: 0.75584
time stamp: 6261.598717927933
[tensor([0.0046, 0.0046, 0.0046, 0.0046], device='cuda:0',
       grad_fn=<GatherBackward>), tensor([0.0057, 0.0057, 0.0057, 0.0057], device='cuda:0',
       grad_fn=<GatherBackward>), tensor([0.0053, 0.0053, 0.0053, 0.0053], device='cuda:0',
       grad_fn=<GatherBackward>), tensor([0.0056, 0.0056, 0.0056, 0.0056], device='cuda:0',
       grad_fn=<GatherBackward>)]

Validation Results
Global Steps: 7799
Valid Loss: 0.50144
Valid Accuracy: 0.75145
time stamp: 6426.817660570145
[tensor([0.0039, 0.0039, 0.0039, 0.0039], device='cuda:0',
       grad_fn=<GatherBackward>), tensor([0.0048, 0.0048, 0.0048, 0.0048], device='cuda:0',
       grad_fn=<GatherBackward>), tensor([0.0045, 0.0045, 0.0045, 0.0045], device='cuda:0',
       grad_fn=<GatherBackward>), tensor([0.0048, 0.0048, 0.0048, 0.0048], device='cuda:0',
       grad_fn=<GatherBackward>)]
best model saved: step =  7999 dev accu =  tensor(0.7559, device='cuda:0')

Validation Results
Global Steps: 7999
Valid Loss: 0.49240
Valid Accuracy: 0.75593
time stamp: 6592.887563228607
[tensor([0.0033, 0.0033, 0.0033, 0.0033], device='cuda:0',
       grad_fn=<GatherBackward>), tensor([0.0041, 0.0041, 0.0041, 0.0041], device='cuda:0',
       grad_fn=<GatherBackward>), tensor([0.0038, 0.0038, 0.0038, 0.0038], device='cuda:0',
       grad_fn=<GatherBackward>), tensor([0.0041, 0.0041, 0.0041, 0.0041], device='cuda:0',
       grad_fn=<GatherBackward>)]
best model saved: step =  8199 dev accu =  tensor(0.7580, device='cuda:0')

Validation Results
Global Steps: 8199
Valid Loss: 0.49390
Valid Accuracy: 0.75802
time stamp: 6759.08354473114
[tensor([0.0028, 0.0028, 0.0028, 0.0028], device='cuda:0',
       grad_fn=<GatherBackward>), tensor([0.0035, 0.0035, 0.0035, 0.0035], device='cuda:0',
       grad_fn=<GatherBackward>), tensor([0.0033, 0.0033, 0.0033, 0.0033], device='cuda:0',
       grad_fn=<GatherBackward>), tensor([0.0035, 0.0035, 0.0035, 0.0035], device='cuda:0',
       grad_fn=<GatherBackward>)]

Validation Results
Global Steps: 8399
Valid Loss: 0.49441
Valid Accuracy: 0.75438
time stamp: 6925.584094285965
[tensor([0.0024, 0.0024, 0.0024, 0.0024], device='cuda:0',
       grad_fn=<GatherBackward>), tensor([0.0030, 0.0030, 0.0030, 0.0030], device='cuda:0',
       grad_fn=<GatherBackward>), tensor([0.0028, 0.0028, 0.0028, 0.0028], device='cuda:0',
       grad_fn=<GatherBackward>), tensor([0.0030, 0.0030, 0.0030, 0.0030], device='cuda:0',
       grad_fn=<GatherBackward>)]

Validation Results
Global Steps: 8599
Valid Loss: 0.48990
Valid Accuracy: 0.75708
time stamp: 7091.355050563812
[tensor([0.0021, 0.0021, 0.0021, 0.0021], device='cuda:0',
       grad_fn=<GatherBackward>), tensor([0.0026, 0.0026, 0.0026, 0.0026], device='cuda:0',
       grad_fn=<GatherBackward>), tensor([0.0024, 0.0024, 0.0024, 0.0024], device='cuda:0',
       grad_fn=<GatherBackward>), tensor([0.0025, 0.0025, 0.0025, 0.0025], device='cuda:0',
       grad_fn=<GatherBackward>)]

Validation Results
Global Steps: 8799
Valid Loss: 0.49440
Valid Accuracy: 0.75772
time stamp: 7258.112067699432
[tensor([0.0018, 0.0018, 0.0018, 0.0018], device='cuda:0',
       grad_fn=<GatherBackward>), tensor([0.0022, 0.0022, 0.0022, 0.0022], device='cuda:0',
       grad_fn=<GatherBackward>), tensor([0.0020, 0.0020, 0.0020, 0.0020], device='cuda:0',
       grad_fn=<GatherBackward>), tensor([0.0022, 0.0022, 0.0022, 0.0022], device='cuda:0',
       grad_fn=<GatherBackward>)]
best model saved: step =  8999 dev accu =  tensor(0.7601, device='cuda:0')

Validation Results
Global Steps: 8999
Valid Loss: 0.48849
Valid Accuracy: 0.76012
time stamp: 7423.888298988342
[tensor([0.0015, 0.0015, 0.0015, 0.0015], device='cuda:0',
       grad_fn=<GatherBackward>), tensor([0.0018, 0.0018, 0.0018, 0.0018], device='cuda:0',
       grad_fn=<GatherBackward>), tensor([0.0017, 0.0017, 0.0017, 0.0017], device='cuda:0',
       grad_fn=<GatherBackward>), tensor([0.0018, 0.0018, 0.0018, 0.0018], device='cuda:0',
       grad_fn=<GatherBackward>)]

Validation Results
Global Steps: 9199
Valid Loss: 0.49040
Valid Accuracy: 0.75866
time stamp: 7590.235635042191
[tensor([0.0013, 0.0013, 0.0013, 0.0013], device='cuda:0',
       grad_fn=<GatherBackward>), tensor([0.0016, 0.0016, 0.0016, 0.0016], device='cuda:0',
       grad_fn=<GatherBackward>), tensor([0.0015, 0.0015, 0.0015, 0.0015], device='cuda:0',
       grad_fn=<GatherBackward>), tensor([0.0016, 0.0016, 0.0016, 0.0016], device='cuda:0',
       grad_fn=<GatherBackward>)]

Validation Results
Global Steps: 9399
Valid Loss: 0.48853
Valid Accuracy: 0.75877
time stamp: 7757.040288448334
[tensor([0.0011, 0.0011, 0.0011, 0.0011], device='cuda:0',
       grad_fn=<GatherBackward>), tensor([0.0013, 0.0013, 0.0013, 0.0013], device='cuda:0',
       grad_fn=<GatherBackward>), tensor([0.0012, 0.0012, 0.0012, 0.0012], device='cuda:0',
       grad_fn=<GatherBackward>), tensor([0.0013, 0.0013, 0.0013, 0.0013], device='cuda:0',
       grad_fn=<GatherBackward>)]
best model saved: step =  9599 dev accu =  tensor(0.7603, device='cuda:0')

Validation Results
Global Steps: 9599
Valid Loss: 0.48959
Valid Accuracy: 0.76025
time stamp: 7923.307722330093
module.model.transformer_0.mha.pattern saved
module.model.transformer_1.mha.pattern saved
module.model.transformer_2.mha.pattern saved
module.model.transformer_3.mha.pattern saved
./pickle/lra-yelp1/module.model.transformer_0.mha.pattern.pickle
tensor([ 792,    0,   33,   66,  264,  594,  825,  396,  495,  429,  528,  231,
          99,  363,  330, 1023,  165,  660,  297,  726,  990,  891,  858,  462,
         627,  561,  759,  957,  132,  924,  693,  198,  134,  196,   24,  768,
          75,  354,  406,  716,  440,  781,   74,  322,   87,  738,   11,  352,
         207,  486,   31], device='cuda:0')
tensor(51, device='cuda:0')
block_attn_mask compile
./pickle/lra-yelp1/module.model.transformer_1.mha.pattern.pickle
tensor([ 759,   99,   33,  198,  330,  924,  693,  363,  297,  396,   66,  132,
         858,  990,  627,  264,  726,  594, 1023,  891,  429,  957,  495,  792,
         561,  165,    0,  528,  462,  825,  231,  660,   82,  578,    5,  160,
         232,  263,  408,  780,  206,  454,  860,  922,  334,  458,  281,  808,
         250,  839,  377], device='cuda:0')
tensor(51, device='cuda:0')
block_attn_mask compile
./pickle/lra-yelp1/module.model.transformer_2.mha.pattern.pickle
tensor([  66,  627,  132,   99,  165,  594,  297,    0,  330,  726,  462,  693,
         495,   33,  660,  198,  759,  231,  990,  792,  561,  264,  825,  429,
         957,  891,  924,  528,  396,  363, 1023,  858,  204,  390,  280,  776,
         369,  555,  207,  486,  496,  527,  829,  953,  575, 1009,  270,  456,
         317,  937,  273], device='cuda:0')
tensor(51, device='cuda:0')
block_attn_mask compile
./pickle/lra-yelp1/module.model.transformer_3.mha.pattern.pickle
tensor([ 231,    0,   66,  693,  594,  759,  858,  297,  528,  132,  264,  429,
         924,  165,  396,  726,   33,  957,  627,  990,  660,  462,  198,  330,
         363,  825,  891,  561,   99,  792,  495, 1023,  375,  747,  695,  757,
         172,  389,  112,  515,  115,  611,   38,  193,  383, 1003,  563,  625,
         443,  877,  342], device='cuda:0')
tensor(51, device='cuda:0')
block_attn_mask compile
total pattern searching time (s): 0.09407973289489746
[]

Validation Results
Global Steps: 9799
Valid Loss: 0.51419
Valid Accuracy: 0.74115
time stamp: 8021.0553567409515
[]

Validation Results
Global Steps: 9999
Valid Loss: 0.51143
Valid Accuracy: 0.74192
time stamp: 8055.847492456436
[]

Validation Results
Global Steps: 10199
Valid Loss: 0.50640
Valid Accuracy: 0.74969
time stamp: 8090.250396490097
[]

Validation Results
Global Steps: 10399
Valid Loss: 0.49764
Valid Accuracy: 0.75465
time stamp: 8124.434416294098
[]

Validation Results
Global Steps: 10599
Valid Loss: 0.48824
Valid Accuracy: 0.75768
time stamp: 8159.270740032196
[]
best model saved: step =  10799 dev accu =  tensor(0.7604, device='cuda:0')

Validation Results
Global Steps: 10799
Valid Loss: 0.48696
Valid Accuracy: 0.76040
time stamp: 8193.752041816711
[]
best model saved: step =  10999 dev accu =  tensor(0.7618, device='cuda:0')

Validation Results
Global Steps: 10999
Valid Loss: 0.48743
Valid Accuracy: 0.76184
time stamp: 8228.491714000702
[]

Validation Results
Global Steps: 11199
Valid Loss: 0.48796
Valid Accuracy: 0.75854
time stamp: 8263.106430768967
[]
best model saved: step =  11399 dev accu =  tensor(0.7633, device='cuda:0')

Validation Results
Global Steps: 11399
Valid Loss: 0.48262
Valid Accuracy: 0.76331
time stamp: 8297.402721643448
[]
best model saved: step =  11599 dev accu =  tensor(0.7656, device='cuda:0')

Validation Results
Global Steps: 11599
Valid Loss: 0.47775
Valid Accuracy: 0.76562
time stamp: 8331.760767698288
[]
best model saved: step =  11799 dev accu =  tensor(0.7667, device='cuda:0')

Validation Results
Global Steps: 11799
Valid Loss: 0.47893
Valid Accuracy: 0.76666
time stamp: 8365.995007753372
[]
best model saved: step =  11999 dev accu =  tensor(0.7682, device='cuda:0')

Validation Results
Global Steps: 11999
Valid Loss: 0.47434
Valid Accuracy: 0.76824
time stamp: 8400.661921262741
[]

Validation Results
Global Steps: 12199
Valid Loss: 0.47645
Valid Accuracy: 0.76647
time stamp: 8435.321196317673
[]
best model saved: step =  12399 dev accu =  tensor(0.7710, device='cuda:0')

Validation Results
Global Steps: 12399
Valid Loss: 0.47027
Valid Accuracy: 0.77104
time stamp: 8470.045650720596
[]
best model saved: step =  12599 dev accu =  tensor(0.7712, device='cuda:0')

Validation Results
Global Steps: 12599
Valid Loss: 0.46743
Valid Accuracy: 0.77124
time stamp: 8504.485767126083
[]
best model saved: step =  12799 dev accu =  tensor(0.7718, device='cuda:0')

Validation Results
Global Steps: 12799
Valid Loss: 0.47425
Valid Accuracy: 0.77178
time stamp: 8539.20169377327
[]

Validation Results
Global Steps: 12999
Valid Loss: 0.47595
Valid Accuracy: 0.76860
time stamp: 8573.539191007614
[]
best model saved: step =  13199 dev accu =  tensor(0.7729, device='cuda:0')

Validation Results
Global Steps: 13199
Valid Loss: 0.47054
Valid Accuracy: 0.77288
time stamp: 8608.088792085648
[]

Validation Results
Global Steps: 13399
Valid Loss: 0.46977
Valid Accuracy: 0.77147
time stamp: 8642.860848426819
[]
best model saved: step =  13599 dev accu =  tensor(0.7758, device='cuda:0')

Validation Results
Global Steps: 13599
Valid Loss: 0.46267
Valid Accuracy: 0.77584
time stamp: 8677.390952825546
[]

Validation Results
Global Steps: 13799
Valid Loss: 0.47165
Valid Accuracy: 0.76796
time stamp: 8712.048871278763
[]
best model saved: step =  13999 dev accu =  tensor(0.7780, device='cuda:0')

Validation Results
Global Steps: 13999
Valid Loss: 0.45869
Valid Accuracy: 0.77801
time stamp: 8747.185420751572
[]

Validation Results
Global Steps: 14199
Valid Loss: 0.46260
Valid Accuracy: 0.77635
time stamp: 8781.771312475204
[]

Validation Results
Global Steps: 14399
Valid Loss: 0.46193
Valid Accuracy: 0.77748
time stamp: 8816.730551242828
[]

Validation Results
Global Steps: 14599
Valid Loss: 0.47006
Valid Accuracy: 0.77483
time stamp: 8851.401718139648
[]
best model saved: step =  14799 dev accu =  tensor(0.7784, device='cuda:0')

Validation Results
Global Steps: 14799
Valid Loss: 0.45960
Valid Accuracy: 0.77836
time stamp: 8886.217287778854
[]
best model saved: step =  14999 dev accu =  tensor(0.7804, device='cuda:0')

Validation Results
Global Steps: 14999
Valid Loss: 0.45974
Valid Accuracy: 0.78044
time stamp: 8920.813298463821
[]
best model saved: step =  15199 dev accu =  tensor(0.7805, device='cuda:0')

Validation Results
Global Steps: 15199
Valid Loss: 0.45308
Valid Accuracy: 0.78050
time stamp: 8955.684000015259
[]

Validation Results
Global Steps: 15399
Valid Loss: 0.46112
Valid Accuracy: 0.77367
time stamp: 8990.629436969757
[]

Validation Results
Global Steps: 15599
Valid Loss: 0.45843
Valid Accuracy: 0.78010
time stamp: 9025.18397974968
[]

Validation Results
Global Steps: 15799
Valid Loss: 0.46799
Valid Accuracy: 0.77410
time stamp: 9060.04102730751
[]

Validation Results
Global Steps: 15999
Valid Loss: 0.45524
Valid Accuracy: 0.77912
time stamp: 9095.071684360504
[]
best model saved: step =  16199 dev accu =  tensor(0.7824, device='cuda:0')

Validation Results
Global Steps: 16199
Valid Loss: 0.45441
Valid Accuracy: 0.78238
time stamp: 9129.815822839737
[]

Validation Results
Global Steps: 16399
Valid Loss: 0.45632
Valid Accuracy: 0.78100
time stamp: 9164.335969686508
[]

Validation Results
Global Steps: 16599
Valid Loss: 0.45784
Valid Accuracy: 0.78012
time stamp: 9199.183905124664
[]

Validation Results
Global Steps: 16799
Valid Loss: 0.46258
Valid Accuracy: 0.77753
time stamp: 9233.62767457962
[]

Validation Results
Global Steps: 16999
Valid Loss: 0.46093
Valid Accuracy: 0.78072
time stamp: 9268.310982227325
[]
best model saved: step =  17199 dev accu =  tensor(0.7824, device='cuda:0')

Validation Results
Global Steps: 17199
Valid Loss: 0.45766
Valid Accuracy: 0.78243
time stamp: 9302.745748758316
[]
best model saved: step =  17399 dev accu =  tensor(0.7855, device='cuda:0')

Validation Results
Global Steps: 17399
Valid Loss: 0.44678
Valid Accuracy: 0.78552
time stamp: 9337.42710852623
[]

Validation Results
Global Steps: 17599
Valid Loss: 0.45048
Valid Accuracy: 0.78476
time stamp: 9372.493074417114
[]
best model saved: step =  17799 dev accu =  tensor(0.7871, device='cuda:0')

Validation Results
Global Steps: 17799
Valid Loss: 0.45100
Valid Accuracy: 0.78709
time stamp: 9407.331845283508
[]

Validation Results
Global Steps: 17999
Valid Loss: 0.45025
Valid Accuracy: 0.78372
time stamp: 9442.20578956604
[]

Validation Results
Global Steps: 18199
Valid Loss: 0.44609
Valid Accuracy: 0.78494
time stamp: 9476.81064248085
[]

Validation Results
Global Steps: 18399
Valid Loss: 0.44828
Valid Accuracy: 0.78554
time stamp: 9511.453300237656
[]
best model saved: step =  18599 dev accu =  tensor(0.7879, device='cuda:0')

Validation Results
Global Steps: 18599
Valid Loss: 0.44688
Valid Accuracy: 0.78793
time stamp: 9546.572912693024
[]

Validation Results
Global Steps: 18799
Valid Loss: 0.44661
Valid Accuracy: 0.78780
time stamp: 9581.252413272858
[]

Validation Results
Global Steps: 18999
Valid Loss: 0.44624
Valid Accuracy: 0.78676
time stamp: 9615.99444770813
[]
best model saved: step =  19199 dev accu =  tensor(0.7893, device='cuda:0')

Validation Results
Global Steps: 19199
Valid Loss: 0.44893
Valid Accuracy: 0.78929
time stamp: 9650.754444360733
[]
best model saved: step =  19399 dev accu =  tensor(0.7896, device='cuda:0')

Validation Results
Global Steps: 19399
Valid Loss: 0.44422
Valid Accuracy: 0.78965
time stamp: 9685.667346954346
[]

Validation Results
Global Steps: 19599
Valid Loss: 0.44542
Valid Accuracy: 0.78909
time stamp: 9720.274171590805
[]

Validation Results
Global Steps: 19799
Valid Loss: 0.44520
Valid Accuracy: 0.78926
time stamp: 9755.2902405262
[]

Validation Results
Global Steps: 19999
Valid Loss: 0.45040
Valid Accuracy: 0.78693
time stamp: 9789.965615034103
[]
best model saved: step =  20199 dev accu =  tensor(0.7914, device='cuda:0')

Validation Results
Global Steps: 20199
Valid Loss: 0.44322
Valid Accuracy: 0.79144
time stamp: 9824.91714835167
[]

Validation Results
Global Steps: 20399
Valid Loss: 0.44534
Valid Accuracy: 0.78843
time stamp: 9859.716295480728
[]

Validation Results
Global Steps: 20599
Valid Loss: 0.44127
Valid Accuracy: 0.79071
time stamp: 9894.552115678787
[]

Validation Results
Global Steps: 20799
Valid Loss: 0.44887
Valid Accuracy: 0.79092
time stamp: 9929.39420223236
[]

Validation Results
Global Steps: 20999
Valid Loss: 0.44666
Valid Accuracy: 0.78999
time stamp: 9963.72987151146
[]

Validation Results
Global Steps: 21199
Valid Loss: 0.44539
Valid Accuracy: 0.79020
time stamp: 9997.868248701096
[]
best model saved: step =  21399 dev accu =  tensor(0.7930, device='cuda:0')

Validation Results
Global Steps: 21399
Valid Loss: 0.44239
Valid Accuracy: 0.79297
time stamp: 10032.20967555046
[]

Validation Results
Global Steps: 21599
Valid Loss: 0.43759
Valid Accuracy: 0.79286
time stamp: 10066.697379112244
[]

Validation Results
Global Steps: 21799
Valid Loss: 0.44026
Valid Accuracy: 0.79149
time stamp: 10101.083112001419
[]

Validation Results
Global Steps: 21999
Valid Loss: 0.44365
Valid Accuracy: 0.79246
time stamp: 10136.45399427414
[]

Validation Results
Global Steps: 22199
Valid Loss: 0.44651
Valid Accuracy: 0.79257
time stamp: 10171.095453500748
[]
best model saved: step =  22399 dev accu =  tensor(0.7935, device='cuda:0')

Validation Results
Global Steps: 22399
Valid Loss: 0.43637
Valid Accuracy: 0.79353
time stamp: 10205.863120555878
[]

Validation Results
Global Steps: 22599
Valid Loss: 0.44086
Valid Accuracy: 0.79180
time stamp: 10240.871583461761
[]
best model saved: step =  22799 dev accu =  tensor(0.7957, device='cuda:0')

Validation Results
Global Steps: 22799
Valid Loss: 0.43697
Valid Accuracy: 0.79573
time stamp: 10275.64952969551
[]
best model saved: step =  22999 dev accu =  tensor(0.7961, device='cuda:0')

Validation Results
Global Steps: 22999
Valid Loss: 0.43634
Valid Accuracy: 0.79613
time stamp: 10310.449454069138
[]
best model saved: step =  23199 dev accu =  tensor(0.7962, device='cuda:0')

Validation Results
Global Steps: 23199
Valid Loss: 0.43485
Valid Accuracy: 0.79620
time stamp: 10345.185590028763
[]

Validation Results
Global Steps: 23399
Valid Loss: 0.43618
Valid Accuracy: 0.79487
time stamp: 10380.172450304031
[]

Validation Results
Global Steps: 23599
Valid Loss: 0.44120
Valid Accuracy: 0.79336
time stamp: 10415.044801235199
[]

Validation Results
Global Steps: 23799
Valid Loss: 0.43748
Valid Accuracy: 0.79403
time stamp: 10449.68947339058
[]

Validation Results
Global Steps: 23999
Valid Loss: 0.43166
Valid Accuracy: 0.79482
time stamp: 10484.40489578247
[]

Validation Results
Global Steps: 24199
Valid Loss: 0.44491
Valid Accuracy: 0.79182
time stamp: 10519.39177441597
[]

Validation Results
Global Steps: 24399
Valid Loss: 0.43439
Valid Accuracy: 0.79551
time stamp: 10553.990675449371
[]

Validation Results
Global Steps: 24599
Valid Loss: 0.43653
Valid Accuracy: 0.79356
time stamp: 10588.679906606674
[]

Validation Results
Global Steps: 24799
Valid Loss: 0.43411
Valid Accuracy: 0.79474
time stamp: 10623.851305246353
[]

Validation Results
Global Steps: 24999
Valid Loss: 0.44719
Valid Accuracy: 0.79093
time stamp: 10658.57524061203
[]
best model saved: step =  25199 dev accu =  tensor(0.7986, device='cuda:0')

Validation Results
Global Steps: 25199
Valid Loss: 0.43267
Valid Accuracy: 0.79855
time stamp: 10693.773843288422
[]
best model saved: step =  25399 dev accu =  tensor(0.7992, device='cuda:0')

Validation Results
Global Steps: 25399
Valid Loss: 0.42770
Valid Accuracy: 0.79920
time stamp: 10728.246653079987
[]
best model saved: step =  25599 dev accu =  tensor(0.7993, device='cuda:0')

Validation Results
Global Steps: 25599
Valid Loss: 0.43260
Valid Accuracy: 0.79933
time stamp: 10762.76776599884
[]
best model saved: step =  25799 dev accu =  tensor(0.8011, device='cuda:0')

Validation Results
Global Steps: 25799
Valid Loss: 0.42974
Valid Accuracy: 0.80110
time stamp: 10797.57867383957
[]

Validation Results
Global Steps: 25999
Valid Loss: 0.43558
Valid Accuracy: 0.79916
time stamp: 10832.499056100845
[]

Validation Results
Global Steps: 26199
Valid Loss: 0.42755
Valid Accuracy: 0.80062
time stamp: 10866.973165512085
[]

Validation Results
Global Steps: 26399
Valid Loss: 0.42872
Valid Accuracy: 0.80010
time stamp: 10901.751715421677
[]

Validation Results
Global Steps: 26599
Valid Loss: 0.43587
Valid Accuracy: 0.79693
time stamp: 10936.126004219055
[]

Validation Results
Global Steps: 26799
Valid Loss: 0.43379
Valid Accuracy: 0.79586
time stamp: 10970.510875463486
[]

Validation Results
Global Steps: 26999
Valid Loss: 0.43288
Valid Accuracy: 0.79930
time stamp: 11005.091674089432
[]
best model saved: step =  27199 dev accu =  tensor(0.8026, device='cuda:0')

Validation Results
Global Steps: 27199
Valid Loss: 0.42812
Valid Accuracy: 0.80256
time stamp: 11039.900088310242
[]

Validation Results
Global Steps: 27399
Valid Loss: 0.43162
Valid Accuracy: 0.79900
time stamp: 11074.58361196518
[]
best model saved: step =  27599 dev accu =  tensor(0.8033, device='cuda:0')

Validation Results
Global Steps: 27599
Valid Loss: 0.42238
Valid Accuracy: 0.80331
time stamp: 11109.534380435944
[]

Validation Results
Global Steps: 27799
Valid Loss: 0.42219
Valid Accuracy: 0.80233
time stamp: 11143.882939577103
[]
best model saved: step =  27999 dev accu =  tensor(0.8052, device='cuda:0')

Validation Results
Global Steps: 27999
Valid Loss: 0.41854
Valid Accuracy: 0.80521
time stamp: 11178.35446548462
[]

Validation Results
Global Steps: 28199
Valid Loss: 0.42060
Valid Accuracy: 0.80454
time stamp: 11213.36748456955
[]
best model saved: step =  28399 dev accu =  tensor(0.8058, device='cuda:0')

Validation Results
Global Steps: 28399
Valid Loss: 0.41757
Valid Accuracy: 0.80583
time stamp: 11247.981096506119
[]
best model saved: step =  28599 dev accu =  tensor(0.8074, device='cuda:0')

Validation Results
Global Steps: 28599
Valid Loss: 0.41790
Valid Accuracy: 0.80736
time stamp: 11282.690056800842
[]
best model saved: step =  28799 dev accu =  tensor(0.8076, device='cuda:0')

Validation Results
Global Steps: 28799
Valid Loss: 0.41902
Valid Accuracy: 0.80761
time stamp: 11317.530335903168
[]

Validation Results
Global Steps: 28999
Valid Loss: 0.43016
Valid Accuracy: 0.80411
time stamp: 11352.019194364548
[]

Validation Results
Global Steps: 29199
Valid Loss: 0.42505
Valid Accuracy: 0.80141
time stamp: 11386.79927444458
[]
best model saved: step =  29399 dev accu =  tensor(0.8085, device='cuda:0')

Validation Results
Global Steps: 29399
Valid Loss: 0.41291
Valid Accuracy: 0.80850
time stamp: 11421.256239414215
[]
best model saved: step =  29599 dev accu =  tensor(0.8112, device='cuda:0')

Validation Results
Global Steps: 29599
Valid Loss: 0.40965
Valid Accuracy: 0.81118
time stamp: 11456.185606241226
[]

Validation Results
Global Steps: 29799
Valid Loss: 0.41588
Valid Accuracy: 0.81083
time stamp: 11490.83465218544
[]

Validation Results
Global Steps: 29999
Valid Loss: 0.40833
Valid Accuracy: 0.80973
time stamp: 11525.098025083542
total training step (k): 30.0
total training time (s): 11525.098621845245
total training time (ms): 1953575.9921875
peak memory usage (MB): 12858
allocated memory usage (MB): 699592774
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |   12024 KB |   12858 MB |  683196 GB |  683196 GB |
|       from large pool |    6144 KB |   12846 MB |  679376 GB |  679376 GB |
|       from small pool |    5880 KB |      27 MB |    3820 GB |    3820 GB |
|---------------------------------------------------------------------------|
| Active memory         |   12024 KB |   12858 MB |  683196 GB |  683196 GB |
|       from large pool |    6144 KB |   12846 MB |  679376 GB |  679376 GB |
|       from small pool |    5880 KB |      27 MB |    3820 GB |    3820 GB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   13776 MB |   13776 MB |   13776 MB |       0 B  |
|       from large pool |   13748 MB |   13748 MB |   13748 MB |       0 B  |
|       from small pool |      28 MB |      28 MB |      28 MB |       0 B  |
|---------------------------------------------------------------------------|
| Non-releasable memory |   10503 KB |    2073 MB |  400168 GB |  400168 GB |
|       from large pool |   10240 KB |    2070 MB |  395888 GB |  395888 GB |
|       from small pool |     263 KB |       6 MB |    4280 GB |    4280 GB |
|---------------------------------------------------------------------------|
| Allocations           |     398    |     670    |   35621 K  |   35620 K  |
|       from large pool |       2    |      93    |   13501 K  |   13501 K  |
|       from small pool |     396    |     659    |   22120 K  |   22119 K  |
|---------------------------------------------------------------------------|
| Active allocs         |     398    |     670    |   35621 K  |   35620 K  |
|       from large pool |       2    |      93    |   13501 K  |   13501 K  |
|       from small pool |     396    |     659    |   22120 K  |   22119 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      42    |      42    |      42    |       0    |
|       from large pool |      28    |      28    |      28    |       0    |
|       from small pool |      14    |      14    |      14    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |      10    |      37    |   17831 K  |   17831 K  |
|       from large pool |       2    |      20    |    5266 K  |    5266 K  |
|       from small pool |       8    |      24    |   12565 K  |   12565 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

loading the best model from: ./checkpoints/checkpoints-10/lra-yelp1/learnable.model
Evaluation Results
Loss: 0.40937
Accuracy: 0.81092
