GPU list: [0, 1, 2, 3]
[
    {
        "learn_pos_emb": true,
        "tied_weights": false,
        "embedding_dim": 64,
        "transformer_dim": 64,
        "transformer_hidden_dim": 128,
        "head_dim": 32,
        "num_head": 2,
        "num_layers": 4,
        "vocab_size": 512,
        "max_seq_len": 1024,
        "dropout_prob": 0.1,
        "attention_dropout": 0.1,
        "pooling_mode": "MEAN",
        "num_classes": 4,
        "block_size": 32,
        "batch_size": 128,
        "density": 0.07,
        "mixed_precision": true,
        "random_seed": 0,
        "task": "lra-news1"
    },
    {
        "batch_size": 512,
        "learning_rate": 0.0007,
        "warmup": 80,
        "lr_decay": "linear",
        "weight_decay": 0,
        "eval_frequency": 200,
        "num_train_steps": 30000,
        "num_init_steps": 3000,
        "num_eval_steps": 200,
        "num_dense_train_steps": 1000,
        "patience": 10,
        "attn_loss_scale": 0.01
    }
]
attn_mask compile
attn_mask compile
attn_mask compile
attn_mask compile
DataParallel(
  (module): ModelForSC(
    (model): Model(
      (embeddings): Embeddings(
        (word_embeddings): Embedding(512, 64)
        (position_embeddings): Embedding(1024, 64)
        (dropout): Dropout(p=0.1, inplace=False)
      )
      (transformer_0): TransformerLayer(
        (norm1): LayerNorm((64,), eps=1e-05, elementwise_affine=True)
        (mha): Attention(
          (W_q): Linear(in_features=64, out_features=64, bias=True)
          (W_k): Linear(in_features=64, out_features=64, bias=True)
          (W_v): Linear(in_features=64, out_features=64, bias=True)
          (avg_pool): AvgPool2d(kernel_size=32, stride=32, padding=0)
          (MSEloss): MSELoss()
          (attn): CUDAMaskAttention()
          (ff): Linear(in_features=64, out_features=64, bias=True)
        )
        (dropout1): Dropout(p=0.1, inplace=False)
        (norm2): LayerNorm((64,), eps=1e-05, elementwise_affine=True)
        (mlpblock): Sequential(
          (0): Linear(in_features=64, out_features=128, bias=True)
          (1): GELU(approximate='none')
          (2): Dropout(p=0.1, inplace=False)
          (3): Linear(in_features=128, out_features=64, bias=True)
          (4): Dropout(p=0.1, inplace=False)
        )
      )
      (transformer_1): TransformerLayer(
        (norm1): LayerNorm((64,), eps=1e-05, elementwise_affine=True)
        (mha): Attention(
          (W_q): Linear(in_features=64, out_features=64, bias=True)
          (W_k): Linear(in_features=64, out_features=64, bias=True)
          (W_v): Linear(in_features=64, out_features=64, bias=True)
          (avg_pool): AvgPool2d(kernel_size=32, stride=32, padding=0)
          (MSEloss): MSELoss()
          (attn): CUDAMaskAttention()
          (ff): Linear(in_features=64, out_features=64, bias=True)
        )
        (dropout1): Dropout(p=0.1, inplace=False)
        (norm2): LayerNorm((64,), eps=1e-05, elementwise_affine=True)
        (mlpblock): Sequential(
          (0): Linear(in_features=64, out_features=128, bias=True)
          (1): GELU(approximate='none')
          (2): Dropout(p=0.1, inplace=False)
          (3): Linear(in_features=128, out_features=64, bias=True)
          (4): Dropout(p=0.1, inplace=False)
        )
      )
      (transformer_2): TransformerLayer(
        (norm1): LayerNorm((64,), eps=1e-05, elementwise_affine=True)
        (mha): Attention(
          (W_q): Linear(in_features=64, out_features=64, bias=True)
          (W_k): Linear(in_features=64, out_features=64, bias=True)
          (W_v): Linear(in_features=64, out_features=64, bias=True)
          (avg_pool): AvgPool2d(kernel_size=32, stride=32, padding=0)
          (MSEloss): MSELoss()
          (attn): CUDAMaskAttention()
          (ff): Linear(in_features=64, out_features=64, bias=True)
        )
        (dropout1): Dropout(p=0.1, inplace=False)
        (norm2): LayerNorm((64,), eps=1e-05, elementwise_affine=True)
        (mlpblock): Sequential(
          (0): Linear(in_features=64, out_features=128, bias=True)
          (1): GELU(approximate='none')
          (2): Dropout(p=0.1, inplace=False)
          (3): Linear(in_features=128, out_features=64, bias=True)
          (4): Dropout(p=0.1, inplace=False)
        )
      )
      (transformer_3): TransformerLayer(
        (norm1): LayerNorm((64,), eps=1e-05, elementwise_affine=True)
        (mha): Attention(
          (W_q): Linear(in_features=64, out_features=64, bias=True)
          (W_k): Linear(in_features=64, out_features=64, bias=True)
          (W_v): Linear(in_features=64, out_features=64, bias=True)
          (avg_pool): AvgPool2d(kernel_size=32, stride=32, padding=0)
          (MSEloss): MSELoss()
          (attn): CUDAMaskAttention()
          (ff): Linear(in_features=64, out_features=64, bias=True)
        )
        (dropout1): Dropout(p=0.1, inplace=False)
        (norm2): LayerNorm((64,), eps=1e-05, elementwise_affine=True)
        (mlpblock): Sequential(
          (0): Linear(in_features=64, out_features=128, bias=True)
          (1): GELU(approximate='none')
          (2): Dropout(p=0.1, inplace=False)
          (3): Linear(in_features=128, out_features=64, bias=True)
          (4): Dropout(p=0.1, inplace=False)
        )
      )
      (norm): LayerNorm((64,), eps=1e-05, elementwise_affine=True)
    )
    (seq_classifer): SCHead(
      (mlpblock): Sequential(
        (0): Linear(in_features=64, out_features=128, bias=True)
        (1): ReLU()
        (2): Linear(in_features=128, out_features=4, bias=True)
      )
    )
  )
)
parameter_size: [torch.Size([512, 64]), torch.Size([1024, 64]), torch.Size([64]), torch.Size([64]), torch.Size([32, 32]), torch.Size([64, 64]), torch.Size([64]), torch.Size([64, 64]), torch.Size([64]), torch.Size([64, 64]), torch.Size([64]), torch.Size([64, 64]), torch.Size([64]), torch.Size([64]), torch.Size([64]), torch.Size([128, 64]), torch.Size([128]), torch.Size([64, 128]), torch.Size([64]), torch.Size([64]), torch.Size([64]), torch.Size([32, 32]), torch.Size([64, 64]), torch.Size([64]), torch.Size([64, 64]), torch.Size([64]), torch.Size([64, 64]), torch.Size([64]), torch.Size([64, 64]), torch.Size([64]), torch.Size([64]), torch.Size([64]), torch.Size([128, 64]), torch.Size([128]), torch.Size([64, 128]), torch.Size([64]), torch.Size([64]), torch.Size([64]), torch.Size([32, 32]), torch.Size([64, 64]), torch.Size([64]), torch.Size([64, 64]), torch.Size([64]), torch.Size([64, 64]), torch.Size([64]), torch.Size([64, 64]), torch.Size([64]), torch.Size([64]), torch.Size([64]), torch.Size([128, 64]), torch.Size([128]), torch.Size([64, 128]), torch.Size([64]), torch.Size([64]), torch.Size([64]), torch.Size([32, 32]), torch.Size([64, 64]), torch.Size([64]), torch.Size([64, 64]), torch.Size([64]), torch.Size([64, 64]), torch.Size([64]), torch.Size([64, 64]), torch.Size([64]), torch.Size([64]), torch.Size([64]), torch.Size([128, 64]), torch.Size([128]), torch.Size([64, 128]), torch.Size([64]), torch.Size([64]), torch.Size([64]), torch.Size([128, 64]), torch.Size([128]), torch.Size([4, 128]), torch.Size([4])]
num_parameter: 245252
Loaded ../Skyformer/data/lra_processed/lra-news1.train.pickle... size=120000
Loaded ../Skyformer/data/lra_processed/lra-news1.dev.pickle... size=7600
Loaded ../Skyformer/data/lra_processed/lra-news1.test.pickle... size=7600
accumu_steps=1
[tensor([30.1570, 30.1570, 30.1570, 30.1570], device='cuda:0',
       grad_fn=<GatherBackward>), tensor([33.4075, 33.4075, 33.4075, 33.4075], device='cuda:0',
       grad_fn=<GatherBackward>), tensor([34.9609, 34.9609, 34.9609, 34.9608], device='cuda:0',
       grad_fn=<GatherBackward>), tensor([30.8442, 30.8442, 30.8442, 30.8443], device='cuda:0',
       grad_fn=<GatherBackward>)]
best model saved: step =  199 dev accu =  tensor(0.5913, device='cuda:0')

Validation Results
Global Steps: 199
Valid Loss: 1.00380
Valid Accuracy: 0.59134
time stamp: 86.82037591934204
[tensor([13.0929, 13.0929, 13.0929, 13.0929], device='cuda:0',
       grad_fn=<GatherBackward>), tensor([14.7288, 14.7288, 14.7288, 14.7288], device='cuda:0',
       grad_fn=<GatherBackward>), tensor([15.4773, 15.4773, 15.4773, 15.4773], device='cuda:0',
       grad_fn=<GatherBackward>), tensor([13.4487, 13.4487, 13.4487, 13.4487], device='cuda:0',
       grad_fn=<GatherBackward>)]
best model saved: step =  399 dev accu =  tensor(0.6197, device='cuda:0')

Validation Results
Global Steps: 399
Valid Loss: 0.94300
Valid Accuracy: 0.61972
time stamp: 171.46027874946594
[tensor([6.5830, 6.5830, 6.5830, 6.5830], device='cuda:0',
       grad_fn=<GatherBackward>), tensor([7.4768, 7.4768, 7.4768, 7.4768], device='cuda:0',
       grad_fn=<GatherBackward>), tensor([7.8610, 7.8610, 7.8610, 7.8610], device='cuda:0',
       grad_fn=<GatherBackward>), tensor([6.7726, 6.7726, 6.7726, 6.7726], device='cuda:0',
       grad_fn=<GatherBackward>)]

Validation Results
Global Steps: 599
Valid Loss: 0.94433
Valid Accuracy: 0.61688
time stamp: 256.6499013900757
[tensor([3.7193, 3.7193, 3.7193, 3.7193], device='cuda:0',
       grad_fn=<GatherBackward>), tensor([4.2451, 4.2451, 4.2451, 4.2451], device='cuda:0',
       grad_fn=<GatherBackward>), tensor([4.4534, 4.4534, 4.4534, 4.4534], device='cuda:0',
       grad_fn=<GatherBackward>), tensor([3.8224, 3.8224, 3.8224, 3.8224], device='cuda:0',
       grad_fn=<GatherBackward>)]
best model saved: step =  799 dev accu =  tensor(0.6309, device='cuda:0')

Validation Results
Global Steps: 799
Valid Loss: 0.90652
Valid Accuracy: 0.63094
time stamp: 341.7930772304535
[tensor([2.3067, 2.3067, 2.3067, 2.3067], device='cuda:0',
       grad_fn=<GatherBackward>), tensor([2.6360, 2.6360, 2.6360, 2.6360], device='cuda:0',
       grad_fn=<GatherBackward>), tensor([2.7542, 2.7542, 2.7542, 2.7542], device='cuda:0',
       grad_fn=<GatherBackward>), tensor([2.3629, 2.3629, 2.3629, 2.3629], device='cuda:0',
       grad_fn=<GatherBackward>)]
best model saved: step =  999 dev accu =  tensor(0.6359, device='cuda:0')

Validation Results
Global Steps: 999
Valid Loss: 0.90164
Valid Accuracy: 0.63595
time stamp: 426.54155707359314
module.model.transformer_0.mha.pattern saved
module.model.transformer_1.mha.pattern saved
module.model.transformer_2.mha.pattern saved
module.model.transformer_3.mha.pattern saved
./pickle/lra-news1/module.model.transformer_0.mha.pattern.pickle
tensor([ 660,  792,  627,  231,  759,  528,   33,  924,  264,  462,   99,  858,
         693,   66,  363,  429,  726,  297,  825,  891,  561,  495,  330,  396,
         957,  594,  990,  198, 1023,    0,  165,  764,  919,  243,  615,   35,
          97,  132,   58,  833,  666,  852,  499,  623,  694,  725,  373,  683,
         120,  771,  468,  654,   52,  641,  115,  611,  827,  889,  476,  910,
         631,  755,  232,  263,   51,  609,  444,  909,  564,  657,  668],
       device='cuda:0')
tensor(71, device='cuda:0')
block_attn_mask compile
./pickle/lra-news1/module.model.transformer_1.mha.pattern.pickle
tensor([ 891,  297,  495,  627,  132,  924,  396,  693,    0,  429,  561,  990,
         759,  825,   33,  231,   99,  330,  858,  726,  660,  303,  489,  264,
         165,   47,  481,  792,  462,  629,  691,  155,  868,  528, 1023,   66,
         363,  594,  565,  689,  507,  879,  154,  836,  957,   59,  865,  763,
         887,  305,  553,  563,  625,  497,  559,  309,  681,  892,  923,  151,
         740,  149,  676,  143,  484,  239,  487,  307,  617,  314,  841],
       device='cuda:0')
tensor(71, device='cuda:0')
block_attn_mask compile
./pickle/lra-news1/module.model.transformer_2.mha.pattern.pickle
tensor([858, 660, 594, 231, 429, 495, 330, 726,  66, 528, 165, 132, 891, 462,
        990, 825, 561,  99, 396, 957, 627, 264, 792, 759, 297,   0, 198,  33,
        730, 854, 363, 667, 884, 338, 586, 242, 583, 182, 709, 924, 731, 886,
        246, 711, 404, 652, 662, 724, 347, 874, 434, 589, 167, 229, 175, 485,
        498, 591, 693, 603, 882, 666, 852, 178, 581, 826, 857, 442, 845, 530,
        592], device='cuda:0')
tensor(71, device='cuda:0')
block_attn_mask compile
./pickle/lra-news1/module.model.transformer_3.mha.pattern.pickle
tensor([ 660,   66,  528,  165,  990,  726,  594,  759,  363,   99,  396,  924,
         132,  957,   33,  792,  627, 1023,  495,  231,  462,  330,    0,  858,
         561,  891,  198,  693,  297,  429,  150,  708,  264,  596,  658,  370,
         587,  372,  651,  534,  720,  114,  579,  604,  914,   80,  514,   67,
          98,   86,  706,   94,  962,  382,  971,   51,  609,   58,  833,   50,
         577,  767, 1015,  241,  551,   43,  353,  766,  983,   63,  993],
       device='cuda:0')
tensor(71, device='cuda:0')
block_attn_mask compile
total pattern searching time (s): 0.12049722671508789
[]

Validation Results
Global Steps: 1199
Valid Loss: 0.94736
Valid Accuracy: 0.61420
time stamp: 466.1749415397644
[]

Validation Results
Global Steps: 1399
Valid Loss: 0.89202
Valid Accuracy: 0.63531
time stamp: 505.27735686302185
[]

Validation Results
Global Steps: 1599
Valid Loss: 0.90268
Valid Accuracy: 0.63415
time stamp: 544.3646745681763
[]
best model saved: step =  1799 dev accu =  tensor(0.6472, device='cuda:0')

Validation Results
Global Steps: 1799
Valid Loss: 0.87629
Valid Accuracy: 0.64722
time stamp: 583.6330721378326
[]

Validation Results
Global Steps: 1999
Valid Loss: 0.87161
Valid Accuracy: 0.64504
time stamp: 622.909059047699
[]
best model saved: step =  2199 dev accu =  tensor(0.6530, device='cuda:0')

Validation Results
Global Steps: 2199
Valid Loss: 0.86045
Valid Accuracy: 0.65303
time stamp: 661.8262951374054
[]
best model saved: step =  2399 dev accu =  tensor(0.6590, device='cuda:0')

Validation Results
Global Steps: 2399
Valid Loss: 0.86620
Valid Accuracy: 0.65903
time stamp: 701.0888800621033
[]
best model saved: step =  2599 dev accu =  tensor(0.6706, device='cuda:0')

Validation Results
Global Steps: 2599
Valid Loss: 0.83897
Valid Accuracy: 0.67058
time stamp: 740.2025330066681
[]

Validation Results
Global Steps: 2799
Valid Loss: 0.82985
Valid Accuracy: 0.66789
time stamp: 779.4613728523254
[]

Validation Results
Global Steps: 2999
Valid Loss: 0.84178
Valid Accuracy: 0.66529
time stamp: 818.5056777000427
[]
best model saved: step =  3199 dev accu =  tensor(0.6722, device='cuda:0')

Validation Results
Global Steps: 3199
Valid Loss: 0.82059
Valid Accuracy: 0.67225
time stamp: 857.5473411083221
[]

Validation Results
Global Steps: 3399
Valid Loss: 0.84093
Valid Accuracy: 0.67127
time stamp: 896.7155153751373
[]
best model saved: step =  3599 dev accu =  tensor(0.6738, device='cuda:0')

Validation Results
Global Steps: 3599
Valid Loss: 0.82107
Valid Accuracy: 0.67385
time stamp: 935.7023513317108
[]
best model saved: step =  3799 dev accu =  tensor(0.6825, device='cuda:0')

Validation Results
Global Steps: 3799
Valid Loss: 0.80806
Valid Accuracy: 0.68246
time stamp: 974.7930459976196
[]
best model saved: step =  3999 dev accu =  tensor(0.6844, device='cuda:0')

Validation Results
Global Steps: 3999
Valid Loss: 0.80914
Valid Accuracy: 0.68437
time stamp: 1014.1540665626526
[]

Validation Results
Global Steps: 4199
Valid Loss: 0.80319
Valid Accuracy: 0.68067
time stamp: 1053.0603368282318
[]

Validation Results
Global Steps: 4399
Valid Loss: 0.82052
Valid Accuracy: 0.68089
time stamp: 1092.4835932254791
[]

Validation Results
Global Steps: 4599
Valid Loss: 0.80659
Valid Accuracy: 0.68375
time stamp: 1131.8834264278412
[]
best model saved: step =  4799 dev accu =  tensor(0.6908, device='cuda:0')

Validation Results
Global Steps: 4799
Valid Loss: 0.79933
Valid Accuracy: 0.69075
time stamp: 1171.023591518402
[]
best model saved: step =  4999 dev accu =  tensor(0.6919, device='cuda:0')

Validation Results
Global Steps: 4999
Valid Loss: 0.79217
Valid Accuracy: 0.69194
time stamp: 1210.3592519760132
[]

Validation Results
Global Steps: 5199
Valid Loss: 0.79880
Valid Accuracy: 0.68615
time stamp: 1249.5645320415497
[]
best model saved: step =  5399 dev accu =  tensor(0.6984, device='cuda:0')

Validation Results
Global Steps: 5399
Valid Loss: 0.78002
Valid Accuracy: 0.69844
time stamp: 1288.474690914154
[]

Validation Results
Global Steps: 5599
Valid Loss: 0.78801
Valid Accuracy: 0.69562
time stamp: 1327.3954527378082
[]

Validation Results
Global Steps: 5799
Valid Loss: 0.77602
Valid Accuracy: 0.69732
time stamp: 1366.6384835243225
[]
best model saved: step =  5999 dev accu =  tensor(0.7033, device='cuda:0')

Validation Results
Global Steps: 5999
Valid Loss: 0.76457
Valid Accuracy: 0.70325
time stamp: 1405.4532465934753
[]

Validation Results
Global Steps: 6199
Valid Loss: 0.79160
Valid Accuracy: 0.69448
time stamp: 1444.3931922912598
[]

Validation Results
Global Steps: 6399
Valid Loss: 0.79421
Valid Accuracy: 0.69347
time stamp: 1483.2476143836975
[]
best model saved: step =  6599 dev accu =  tensor(0.7045, device='cuda:0')

Validation Results
Global Steps: 6599
Valid Loss: 0.76370
Valid Accuracy: 0.70449
time stamp: 1522.2331244945526
[]

Validation Results
Global Steps: 6799
Valid Loss: 0.77957
Valid Accuracy: 0.70437
time stamp: 1561.5948321819305
[]
best model saved: step =  6999 dev accu =  tensor(0.7072, device='cuda:0')

Validation Results
Global Steps: 6999
Valid Loss: 0.75603
Valid Accuracy: 0.70723
time stamp: 1600.974390745163
[]
best model saved: step =  7199 dev accu =  tensor(0.7088, device='cuda:0')

Validation Results
Global Steps: 7199
Valid Loss: 0.74894
Valid Accuracy: 0.70885
time stamp: 1640.1818602085114
[]

Validation Results
Global Steps: 7399
Valid Loss: 0.75849
Valid Accuracy: 0.70704
time stamp: 1679.076933145523
[]
best model saved: step =  7599 dev accu =  tensor(0.7124, device='cuda:0')

Validation Results
Global Steps: 7599
Valid Loss: 0.75888
Valid Accuracy: 0.71239
time stamp: 1717.8954656124115
[]
best model saved: step =  7799 dev accu =  tensor(0.7157, device='cuda:0')

Validation Results
Global Steps: 7799
Valid Loss: 0.74486
Valid Accuracy: 0.71568
time stamp: 1756.844341993332
[]

Validation Results
Global Steps: 7999
Valid Loss: 0.76027
Valid Accuracy: 0.71092
time stamp: 1796.1265623569489
[]

Validation Results
Global Steps: 8199
Valid Loss: 0.75145
Valid Accuracy: 0.71505
time stamp: 1834.9872572422028
[]

Validation Results
Global Steps: 8399
Valid Loss: 0.75969
Valid Accuracy: 0.71202
time stamp: 1874.0188224315643
[]
best model saved: step =  8599 dev accu =  tensor(0.7221, device='cuda:0')

Validation Results
Global Steps: 8599
Valid Loss: 0.73447
Valid Accuracy: 0.72209
time stamp: 1913.1389825344086
[]

Validation Results
Global Steps: 8799
Valid Loss: 0.75669
Valid Accuracy: 0.71386
time stamp: 1952.4006674289703
[]

Validation Results
Global Steps: 8999
Valid Loss: 0.74010
Valid Accuracy: 0.72126
time stamp: 1991.4614899158478
[]

Validation Results
Global Steps: 9199
Valid Loss: 0.75838
Valid Accuracy: 0.71432
time stamp: 2030.5496141910553
[]

Validation Results
Global Steps: 9399
Valid Loss: 0.73940
Valid Accuracy: 0.72107
time stamp: 2069.8963556289673
[]

Validation Results
Global Steps: 9599
Valid Loss: 0.74893
Valid Accuracy: 0.72141
time stamp: 2109.2055265903473
[]

Validation Results
Global Steps: 9799
Valid Loss: 0.74599
Valid Accuracy: 0.72016
time stamp: 2148.429910182953
[]
best model saved: step =  9999 dev accu =  tensor(0.7249, device='cuda:0')

Validation Results
Global Steps: 9999
Valid Loss: 0.74011
Valid Accuracy: 0.72491
time stamp: 2187.8723158836365
[]

Validation Results
Global Steps: 10199
Valid Loss: 0.72918
Valid Accuracy: 0.72260
time stamp: 2226.9051463603973
[]
best model saved: step =  10399 dev accu =  tensor(0.7250, device='cuda:0')

Validation Results
Global Steps: 10399
Valid Loss: 0.72738
Valid Accuracy: 0.72496
time stamp: 2266.1856050491333
[]
best model saved: step =  10599 dev accu =  tensor(0.7303, device='cuda:0')

Validation Results
Global Steps: 10599
Valid Loss: 0.72745
Valid Accuracy: 0.73030
time stamp: 2305.372978210449
[]

Validation Results
Global Steps: 10799
Valid Loss: 0.73649
Valid Accuracy: 0.72458
time stamp: 2344.7407722473145
[]

Validation Results
Global Steps: 10999
Valid Loss: 0.72337
Valid Accuracy: 0.72656
time stamp: 2384.054529905319
[]
best model saved: step =  11199 dev accu =  tensor(0.7331, device='cuda:0')

Validation Results
Global Steps: 11199
Valid Loss: 0.70522
Valid Accuracy: 0.73312
time stamp: 2423.166030883789
[]

Validation Results
Global Steps: 11399
Valid Loss: 0.72516
Valid Accuracy: 0.73159
time stamp: 2462.633421421051
[]

Validation Results
Global Steps: 11599
Valid Loss: 0.73727
Valid Accuracy: 0.72913
time stamp: 2502.045849084854
[]

Validation Results
Global Steps: 11799
Valid Loss: 0.72763
Valid Accuracy: 0.73037
time stamp: 2541.116482257843
[]
best model saved: step =  11999 dev accu =  tensor(0.7355, device='cuda:0')

Validation Results
Global Steps: 11999
Valid Loss: 0.71583
Valid Accuracy: 0.73555
time stamp: 2580.4994769096375
[]

Validation Results
Global Steps: 12199
Valid Loss: 0.72210
Valid Accuracy: 0.73403
time stamp: 2619.723439693451
[]
best model saved: step =  12399 dev accu =  tensor(0.7389, device='cuda:0')

Validation Results
Global Steps: 12399
Valid Loss: 0.69966
Valid Accuracy: 0.73888
time stamp: 2659.091033935547
[]

Validation Results
Global Steps: 12599
Valid Loss: 0.72628
Valid Accuracy: 0.73236
time stamp: 2698.083572626114
[]
best model saved: step =  12799 dev accu =  tensor(0.7421, device='cuda:0')

Validation Results
Global Steps: 12799
Valid Loss: 0.70179
Valid Accuracy: 0.74211
time stamp: 2737.338299036026
[]

Validation Results
Global Steps: 12999
Valid Loss: 0.71444
Valid Accuracy: 0.73736
time stamp: 2776.6534762382507
[]

Validation Results
Global Steps: 13199
Valid Loss: 0.71333
Valid Accuracy: 0.73972
time stamp: 2815.9736461639404
[]

Validation Results
Global Steps: 13399
Valid Loss: 0.72821
Valid Accuracy: 0.73828
time stamp: 2855.46222949028
[]
best model saved: step =  13599 dev accu =  tensor(0.7422, device='cuda:0')

Validation Results
Global Steps: 13599
Valid Loss: 0.69919
Valid Accuracy: 0.74221
time stamp: 2894.752413034439
[]
best model saved: step =  13799 dev accu =  tensor(0.7446, device='cuda:0')

Validation Results
Global Steps: 13799
Valid Loss: 0.70845
Valid Accuracy: 0.74459
time stamp: 2934.31885266304
[]

Validation Results
Global Steps: 13999
Valid Loss: 0.69383
Valid Accuracy: 0.74444
time stamp: 2973.3165950775146
[]

Validation Results
Global Steps: 14199
Valid Loss: 0.69509
Valid Accuracy: 0.74159
time stamp: 3012.7953531742096
[]
best model saved: step =  14399 dev accu =  tensor(0.7483, device='cuda:0')

Validation Results
Global Steps: 14399
Valid Loss: 0.70465
Valid Accuracy: 0.74826
time stamp: 3051.9162929058075
[]
best model saved: step =  14599 dev accu =  tensor(0.7502, device='cuda:0')

Validation Results
Global Steps: 14599
Valid Loss: 0.69582
Valid Accuracy: 0.75023
time stamp: 3091.170432806015
[]

Validation Results
Global Steps: 14799
Valid Loss: 0.69453
Valid Accuracy: 0.74480
time stamp: 3130.345135450363
[]
best model saved: step =  14999 dev accu =  tensor(0.7554, device='cuda:0')

Validation Results
Global Steps: 14999
Valid Loss: 0.67122
Valid Accuracy: 0.75538
time stamp: 3169.600153684616
[]

Validation Results
Global Steps: 15199
Valid Loss: 0.70005
Valid Accuracy: 0.74998
time stamp: 3208.560128927231
[]

Validation Results
Global Steps: 15399
Valid Loss: 0.68179
Valid Accuracy: 0.75334
time stamp: 3247.5759785175323
[]
best model saved: step =  15599 dev accu =  tensor(0.7557, device='cuda:0')

Validation Results
Global Steps: 15599
Valid Loss: 0.67770
Valid Accuracy: 0.75570
time stamp: 3286.7316765785217
[]

Validation Results
Global Steps: 15799
Valid Loss: 0.70949
Valid Accuracy: 0.75062
time stamp: 3326.1599509716034
[]

Validation Results
Global Steps: 15999
Valid Loss: 0.69300
Valid Accuracy: 0.75228
time stamp: 3365.458547115326
[]
best model saved: step =  16199 dev accu =  tensor(0.7566, device='cuda:0')

Validation Results
Global Steps: 16199
Valid Loss: 0.69352
Valid Accuracy: 0.75655
time stamp: 3404.555442094803
[]

Validation Results
Global Steps: 16399
Valid Loss: 0.69372
Valid Accuracy: 0.75095
time stamp: 3443.8392503261566
[]

Validation Results
Global Steps: 16599
Valid Loss: 0.69475
Valid Accuracy: 0.75090
time stamp: 3483.053132534027
[]
best model saved: step =  16799 dev accu =  tensor(0.7605, device='cuda:0')

Validation Results
Global Steps: 16799
Valid Loss: 0.66984
Valid Accuracy: 0.76050
time stamp: 3522.550187110901
[]

Validation Results
Global Steps: 16999
Valid Loss: 0.67844
Valid Accuracy: 0.75875
time stamp: 3561.8106734752655
[]
best model saved: step =  17199 dev accu =  tensor(0.7625, device='cuda:0')

Validation Results
Global Steps: 17199
Valid Loss: 0.67017
Valid Accuracy: 0.76254
time stamp: 3601.1486480236053
[]

Validation Results
Global Steps: 17399
Valid Loss: 0.67115
Valid Accuracy: 0.76066
time stamp: 3640.5052580833435
[]
best model saved: step =  17599 dev accu =  tensor(0.7640, device='cuda:0')

Validation Results
Global Steps: 17599
Valid Loss: 0.67587
Valid Accuracy: 0.76401
time stamp: 3679.8341217041016
[]

Validation Results
Global Steps: 17799
Valid Loss: 0.67540
Valid Accuracy: 0.76344
time stamp: 3718.794911146164
[]

Validation Results
Global Steps: 17999
Valid Loss: 0.67521
Valid Accuracy: 0.75915
time stamp: 3757.75963807106
[]

Validation Results
Global Steps: 18199
Valid Loss: 0.67211
Valid Accuracy: 0.76077
time stamp: 3796.9690279960632
[]
best model saved: step =  18399 dev accu =  tensor(0.7668, device='cuda:0')

Validation Results
Global Steps: 18399
Valid Loss: 0.66860
Valid Accuracy: 0.76685
time stamp: 3836.328097820282
[]

Validation Results
Global Steps: 18599
Valid Loss: 0.67699
Valid Accuracy: 0.76381
time stamp: 3875.514482975006
[]

Validation Results
Global Steps: 18799
Valid Loss: 0.68033
Valid Accuracy: 0.76471
time stamp: 3914.611329317093
[]
best model saved: step =  18999 dev accu =  tensor(0.7675, device='cuda:0')

Validation Results
Global Steps: 18999
Valid Loss: 0.66857
Valid Accuracy: 0.76754
time stamp: 3954.0056636333466
[]
best model saved: step =  19199 dev accu =  tensor(0.7692, device='cuda:0')

Validation Results
Global Steps: 19199
Valid Loss: 0.66641
Valid Accuracy: 0.76919
time stamp: 3992.967321395874
[]
best model saved: step =  19399 dev accu =  tensor(0.7698, device='cuda:0')

Validation Results
Global Steps: 19399
Valid Loss: 0.65745
Valid Accuracy: 0.76984
time stamp: 4032.048008918762
[]

Validation Results
Global Steps: 19599
Valid Loss: 0.66168
Valid Accuracy: 0.76897
time stamp: 4070.8822305202484
[]
best model saved: step =  19799 dev accu =  tensor(0.7741, device='cuda:0')

Validation Results
Global Steps: 19799
Valid Loss: 0.65870
Valid Accuracy: 0.77410
time stamp: 4110.161510229111
[]

Validation Results
Global Steps: 19999
Valid Loss: 0.66908
Valid Accuracy: 0.77088
time stamp: 4149.481402158737
[]

Validation Results
Global Steps: 20199
Valid Loss: 0.65695
Valid Accuracy: 0.77241
time stamp: 4188.594912290573
[]

Validation Results
Global Steps: 20399
Valid Loss: 0.64812
Valid Accuracy: 0.77113
time stamp: 4227.975896835327
[]

Validation Results
Global Steps: 20599
Valid Loss: 0.65817
Valid Accuracy: 0.77221
time stamp: 4267.020977497101
[]

Validation Results
Global Steps: 20799
Valid Loss: 0.65028
Valid Accuracy: 0.77316
time stamp: 4306.286024570465
[]

Validation Results
Global Steps: 20999
Valid Loss: 0.65474
Valid Accuracy: 0.76949
time stamp: 4345.530462026596
[]

Validation Results
Global Steps: 21199
Valid Loss: 0.64659
Valid Accuracy: 0.77178
time stamp: 4384.895925760269
[]
best model saved: step =  21399 dev accu =  tensor(0.7759, device='cuda:0')

Validation Results
Global Steps: 21399
Valid Loss: 0.64383
Valid Accuracy: 0.77586
time stamp: 4424.157649755478
[]

Validation Results
Global Steps: 21599
Valid Loss: 0.65813
Valid Accuracy: 0.77116
time stamp: 4463.152323961258
[]
best model saved: step =  21799 dev accu =  tensor(0.7760, device='cuda:0')

Validation Results
Global Steps: 21799
Valid Loss: 0.65820
Valid Accuracy: 0.77602
time stamp: 4502.377246379852
[]

Validation Results
Global Steps: 21999
Valid Loss: 0.64684
Valid Accuracy: 0.77402
time stamp: 4541.599001169205
[]
best model saved: step =  22199 dev accu =  tensor(0.7793, device='cuda:0')

Validation Results
Global Steps: 22199
Valid Loss: 0.64647
Valid Accuracy: 0.77934
time stamp: 4580.922164201736
[]

Validation Results
Global Steps: 22399
Valid Loss: 0.65769
Valid Accuracy: 0.77426
time stamp: 4620.463891506195
[]

Validation Results
Global Steps: 22599
Valid Loss: 0.65463
Valid Accuracy: 0.77856
time stamp: 4659.7028913497925
[]
best model saved: step =  22799 dev accu =  tensor(0.7803, device='cuda:0')

Validation Results
Global Steps: 22799
Valid Loss: 0.63275
Valid Accuracy: 0.78026
time stamp: 4699.168034315109
[]

Validation Results
Global Steps: 22999
Valid Loss: 0.64631
Valid Accuracy: 0.77865
time stamp: 4738.422949790955
[]

Validation Results
Global Steps: 23199
Valid Loss: 0.63594
Valid Accuracy: 0.77658
time stamp: 4777.9199385643005
[]

Validation Results
Global Steps: 23399
Valid Loss: 0.65764
Valid Accuracy: 0.77402
time stamp: 4817.1882746219635
[]

Validation Results
Global Steps: 23599
Valid Loss: 0.64299
Valid Accuracy: 0.77681
time stamp: 4856.061856985092
[]

Validation Results
Global Steps: 23799
Valid Loss: 0.64150
Valid Accuracy: 0.77293
time stamp: 4895.397081613541
[]
best model saved: step =  23999 dev accu =  tensor(0.7804, device='cuda:0')

Validation Results
Global Steps: 23999
Valid Loss: 0.64280
Valid Accuracy: 0.78044
time stamp: 4934.749725818634
[]

Validation Results
Global Steps: 24199
Valid Loss: 0.64090
Valid Accuracy: 0.77847
time stamp: 4974.215704679489
[]

Validation Results
Global Steps: 24399
Valid Loss: 0.64003
Valid Accuracy: 0.77954
time stamp: 5013.12109708786
[]
best model saved: step =  24599 dev accu =  tensor(0.7807, device='cuda:0')

Validation Results
Global Steps: 24599
Valid Loss: 0.64189
Valid Accuracy: 0.78073
time stamp: 5052.783672571182
[]
best model saved: step =  24799 dev accu =  tensor(0.7818, device='cuda:0')

Validation Results
Global Steps: 24799
Valid Loss: 0.63302
Valid Accuracy: 0.78184
time stamp: 5092.189427614212
[]

Validation Results
Global Steps: 24999
Valid Loss: 0.64856
Valid Accuracy: 0.78112
time stamp: 5131.443604230881
[]

Validation Results
Global Steps: 25199
Valid Loss: 0.63885
Valid Accuracy: 0.78013
time stamp: 5170.450617074966
[]

Validation Results
Global Steps: 25399
Valid Loss: 0.64766
Valid Accuracy: 0.78135
time stamp: 5209.524274110794
[]

Validation Results
Global Steps: 25599
Valid Loss: 0.64876
Valid Accuracy: 0.77719
time stamp: 5248.573433160782
[]
best model saved: step =  25799 dev accu =  tensor(0.7832, device='cuda:0')

Validation Results
Global Steps: 25799
Valid Loss: 0.63822
Valid Accuracy: 0.78324
time stamp: 5287.506139039993
[]

Validation Results
Global Steps: 25999
Valid Loss: 0.63348
Valid Accuracy: 0.78140
time stamp: 5326.908204317093
[]

Validation Results
Global Steps: 26199
Valid Loss: 0.64316
Valid Accuracy: 0.78023
time stamp: 5366.261057138443
[]
best model saved: step =  26399 dev accu =  tensor(0.7849, device='cuda:0')

Validation Results
Global Steps: 26399
Valid Loss: 0.63285
Valid Accuracy: 0.78486
time stamp: 5405.598841905594
[]

Validation Results
Global Steps: 26599
Valid Loss: 0.63362
Valid Accuracy: 0.78242
time stamp: 5444.675436258316
[]

Validation Results
Global Steps: 26799
Valid Loss: 0.63950
Valid Accuracy: 0.78433
time stamp: 5483.683034420013
[]
best model saved: step =  26999 dev accu =  tensor(0.7859, device='cuda:0')

Validation Results
Global Steps: 26999
Valid Loss: 0.62778
Valid Accuracy: 0.78593
time stamp: 5522.755285739899
[]

Validation Results
Global Steps: 27199
Valid Loss: 0.63870
Valid Accuracy: 0.78329
time stamp: 5561.557235240936
[]
best model saved: step =  27399 dev accu =  tensor(0.7869, device='cuda:0')

Validation Results
Global Steps: 27399
Valid Loss: 0.63241
Valid Accuracy: 0.78694
time stamp: 5600.344989299774
[]

Validation Results
Global Steps: 27599
Valid Loss: 0.64171
Valid Accuracy: 0.78388
time stamp: 5639.537046432495
[]
best model saved: step =  27799 dev accu =  tensor(0.7875, device='cuda:0')

Validation Results
Global Steps: 27799
Valid Loss: 0.62715
Valid Accuracy: 0.78752
time stamp: 5678.616969585419
[]
best model saved: step =  27999 dev accu =  tensor(0.7884, device='cuda:0')

Validation Results
Global Steps: 27999
Valid Loss: 0.63921
Valid Accuracy: 0.78837
time stamp: 5718.0787088871
[]

Validation Results
Global Steps: 28199
Valid Loss: 0.63862
Valid Accuracy: 0.78388
time stamp: 5757.258330106735
[]

Validation Results
Global Steps: 28399
Valid Loss: 0.63459
Valid Accuracy: 0.78710
time stamp: 5796.255744695663
[]

Validation Results
Global Steps: 28599
Valid Loss: 0.63959
Valid Accuracy: 0.78386
time stamp: 5835.7290506362915
[]

Validation Results
Global Steps: 28799
Valid Loss: 0.63034
Valid Accuracy: 0.78624
time stamp: 5875.078722953796
[]

Validation Results
Global Steps: 28999
Valid Loss: 0.63566
Valid Accuracy: 0.78608
time stamp: 5914.441880702972
[]

Validation Results
Global Steps: 29199
Valid Loss: 0.63401
Valid Accuracy: 0.78801
time stamp: 5953.741852045059
[]

Validation Results
Global Steps: 29399
Valid Loss: 0.63537
Valid Accuracy: 0.78652
time stamp: 5992.919908285141
[]

Validation Results
Global Steps: 29599
Valid Loss: 0.63246
Valid Accuracy: 0.78826
time stamp: 6031.931510448456
[]

Validation Results
Global Steps: 29799
Valid Loss: 0.63340
Valid Accuracy: 0.78750
time stamp: 6071.33468079567
[]

Validation Results
Global Steps: 29999
Valid Loss: 0.63202
Valid Accuracy: 0.78798
time stamp: 6111.012668848038
total training step (k): 30.0
total training time (s): 6111.01350069046
total training time (ms): 1617009.236328125
peak memory usage (MB): 12762
allocated memory usage (MB): 421864806
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |   10095 KB |   12762 MB |  411977 GB |  411977 GB |
|       from large pool |    6144 KB |   12750 MB |  408585 GB |  408585 GB |
|       from small pool |    3951 KB |      27 MB |    3391 GB |    3391 GB |
|---------------------------------------------------------------------------|
| Active memory         |   10095 KB |   12762 MB |  411977 GB |  411977 GB |
|       from large pool |    6144 KB |   12750 MB |  408585 GB |  408585 GB |
|       from small pool |    3951 KB |      27 MB |    3391 GB |    3391 GB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   12848 MB |   12848 MB |   12848 MB |       0 B  |
|       from large pool |   12820 MB |   12820 MB |   12820 MB |       0 B  |
|       from small pool |      28 MB |      28 MB |      28 MB |       0 B  |
|---------------------------------------------------------------------------|
| Non-releasable memory |   14481 KB |    1435 MB |  461617 GB |  461617 GB |
|       from large pool |   10240 KB |    1434 MB |  458107 GB |  458107 GB |
|       from small pool |    4241 KB |       6 MB |    3509 GB |    3509 GB |
|---------------------------------------------------------------------------|
| Allocations           |     246    |     535    |   35706 K  |   35706 K  |
|       from large pool |       2    |      87    |   13720 K  |   13720 K  |
|       from small pool |     244    |     518    |   21986 K  |   21986 K  |
|---------------------------------------------------------------------------|
| Active allocs         |     246    |     535    |   35706 K  |   35706 K  |
|       from large pool |       2    |      87    |   13720 K  |   13720 K  |
|       from small pool |     244    |     518    |   21986 K  |   21986 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      44    |      44    |      44    |       0    |
|       from large pool |      30    |      30    |      30    |       0    |
|       from small pool |      14    |      14    |      14    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |      11    |      33    |   15862 K  |   15862 K  |
|       from large pool |       1    |      15    |    5816 K  |    5816 K  |
|       from small pool |      10    |      23    |   10046 K  |   10046 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

loading the best model from: ./checkpoints/checkpoints-0/lra-news1/density07.model
Evaluation Results
Loss: 0.63916
Accuracy: 0.78948
