GPU list: [0, 1, 2, 3]
[
    {
        "learn_pos_emb": true,
        "tied_weights": false,
        "embedding_dim": 64,
        "transformer_dim": 64,
        "transformer_hidden_dim": 128,
        "head_dim": 32,
        "num_head": 2,
        "num_layers": 4,
        "vocab_size": 512,
        "max_seq_len": 1024,
        "dropout_prob": 0.1,
        "attention_dropout": 0.1,
        "pooling_mode": "MEAN",
        "num_classes": 4,
        "block_size": 32,
        "batch_size": 128,
        "density": 0.08,
        "mixed_precision": true,
        "random_seed": 0,
        "task": "lra-news1"
    },
    {
        "batch_size": 512,
        "learning_rate": 0.0007,
        "warmup": 80,
        "lr_decay": "linear",
        "weight_decay": 0,
        "eval_frequency": 200,
        "num_train_steps": 30000,
        "num_init_steps": 3000,
        "num_eval_steps": 200,
        "num_dense_train_steps": 1000,
        "patience": 10,
        "attn_loss_scale": 0.01
    }
]
attn_mask compile
attn_mask compile
attn_mask compile
attn_mask compile
DataParallel(
  (module): ModelForSC(
    (model): Model(
      (embeddings): Embeddings(
        (word_embeddings): Embedding(512, 64)
        (position_embeddings): Embedding(1024, 64)
        (dropout): Dropout(p=0.1, inplace=False)
      )
      (transformer_0): TransformerLayer(
        (norm1): LayerNorm((64,), eps=1e-05, elementwise_affine=True)
        (mha): Attention(
          (W_q): Linear(in_features=64, out_features=64, bias=True)
          (W_k): Linear(in_features=64, out_features=64, bias=True)
          (W_v): Linear(in_features=64, out_features=64, bias=True)
          (avg_pool): AvgPool2d(kernel_size=32, stride=32, padding=0)
          (MSEloss): MSELoss()
          (attn): CUDAMaskAttention()
          (ff): Linear(in_features=64, out_features=64, bias=True)
        )
        (dropout1): Dropout(p=0.1, inplace=False)
        (norm2): LayerNorm((64,), eps=1e-05, elementwise_affine=True)
        (mlpblock): Sequential(
          (0): Linear(in_features=64, out_features=128, bias=True)
          (1): GELU(approximate='none')
          (2): Dropout(p=0.1, inplace=False)
          (3): Linear(in_features=128, out_features=64, bias=True)
          (4): Dropout(p=0.1, inplace=False)
        )
      )
      (transformer_1): TransformerLayer(
        (norm1): LayerNorm((64,), eps=1e-05, elementwise_affine=True)
        (mha): Attention(
          (W_q): Linear(in_features=64, out_features=64, bias=True)
          (W_k): Linear(in_features=64, out_features=64, bias=True)
          (W_v): Linear(in_features=64, out_features=64, bias=True)
          (avg_pool): AvgPool2d(kernel_size=32, stride=32, padding=0)
          (MSEloss): MSELoss()
          (attn): CUDAMaskAttention()
          (ff): Linear(in_features=64, out_features=64, bias=True)
        )
        (dropout1): Dropout(p=0.1, inplace=False)
        (norm2): LayerNorm((64,), eps=1e-05, elementwise_affine=True)
        (mlpblock): Sequential(
          (0): Linear(in_features=64, out_features=128, bias=True)
          (1): GELU(approximate='none')
          (2): Dropout(p=0.1, inplace=False)
          (3): Linear(in_features=128, out_features=64, bias=True)
          (4): Dropout(p=0.1, inplace=False)
        )
      )
      (transformer_2): TransformerLayer(
        (norm1): LayerNorm((64,), eps=1e-05, elementwise_affine=True)
        (mha): Attention(
          (W_q): Linear(in_features=64, out_features=64, bias=True)
          (W_k): Linear(in_features=64, out_features=64, bias=True)
          (W_v): Linear(in_features=64, out_features=64, bias=True)
          (avg_pool): AvgPool2d(kernel_size=32, stride=32, padding=0)
          (MSEloss): MSELoss()
          (attn): CUDAMaskAttention()
          (ff): Linear(in_features=64, out_features=64, bias=True)
        )
        (dropout1): Dropout(p=0.1, inplace=False)
        (norm2): LayerNorm((64,), eps=1e-05, elementwise_affine=True)
        (mlpblock): Sequential(
          (0): Linear(in_features=64, out_features=128, bias=True)
          (1): GELU(approximate='none')
          (2): Dropout(p=0.1, inplace=False)
          (3): Linear(in_features=128, out_features=64, bias=True)
          (4): Dropout(p=0.1, inplace=False)
        )
      )
      (transformer_3): TransformerLayer(
        (norm1): LayerNorm((64,), eps=1e-05, elementwise_affine=True)
        (mha): Attention(
          (W_q): Linear(in_features=64, out_features=64, bias=True)
          (W_k): Linear(in_features=64, out_features=64, bias=True)
          (W_v): Linear(in_features=64, out_features=64, bias=True)
          (avg_pool): AvgPool2d(kernel_size=32, stride=32, padding=0)
          (MSEloss): MSELoss()
          (attn): CUDAMaskAttention()
          (ff): Linear(in_features=64, out_features=64, bias=True)
        )
        (dropout1): Dropout(p=0.1, inplace=False)
        (norm2): LayerNorm((64,), eps=1e-05, elementwise_affine=True)
        (mlpblock): Sequential(
          (0): Linear(in_features=64, out_features=128, bias=True)
          (1): GELU(approximate='none')
          (2): Dropout(p=0.1, inplace=False)
          (3): Linear(in_features=128, out_features=64, bias=True)
          (4): Dropout(p=0.1, inplace=False)
        )
      )
      (norm): LayerNorm((64,), eps=1e-05, elementwise_affine=True)
    )
    (seq_classifer): SCHead(
      (mlpblock): Sequential(
        (0): Linear(in_features=64, out_features=128, bias=True)
        (1): ReLU()
        (2): Linear(in_features=128, out_features=4, bias=True)
      )
    )
  )
)
parameter_size: [torch.Size([512, 64]), torch.Size([1024, 64]), torch.Size([64]), torch.Size([64]), torch.Size([32, 32]), torch.Size([64, 64]), torch.Size([64]), torch.Size([64, 64]), torch.Size([64]), torch.Size([64, 64]), torch.Size([64]), torch.Size([64, 64]), torch.Size([64]), torch.Size([64]), torch.Size([64]), torch.Size([128, 64]), torch.Size([128]), torch.Size([64, 128]), torch.Size([64]), torch.Size([64]), torch.Size([64]), torch.Size([32, 32]), torch.Size([64, 64]), torch.Size([64]), torch.Size([64, 64]), torch.Size([64]), torch.Size([64, 64]), torch.Size([64]), torch.Size([64, 64]), torch.Size([64]), torch.Size([64]), torch.Size([64]), torch.Size([128, 64]), torch.Size([128]), torch.Size([64, 128]), torch.Size([64]), torch.Size([64]), torch.Size([64]), torch.Size([32, 32]), torch.Size([64, 64]), torch.Size([64]), torch.Size([64, 64]), torch.Size([64]), torch.Size([64, 64]), torch.Size([64]), torch.Size([64, 64]), torch.Size([64]), torch.Size([64]), torch.Size([64]), torch.Size([128, 64]), torch.Size([128]), torch.Size([64, 128]), torch.Size([64]), torch.Size([64]), torch.Size([64]), torch.Size([32, 32]), torch.Size([64, 64]), torch.Size([64]), torch.Size([64, 64]), torch.Size([64]), torch.Size([64, 64]), torch.Size([64]), torch.Size([64, 64]), torch.Size([64]), torch.Size([64]), torch.Size([64]), torch.Size([128, 64]), torch.Size([128]), torch.Size([64, 128]), torch.Size([64]), torch.Size([64]), torch.Size([64]), torch.Size([128, 64]), torch.Size([128]), torch.Size([4, 128]), torch.Size([4])]
num_parameter: 245252
Loaded ../Skyformer/data/lra_processed/lra-news1.train.pickle... size=120000
Loaded ../Skyformer/data/lra_processed/lra-news1.dev.pickle... size=7600
Loaded ../Skyformer/data/lra_processed/lra-news1.test.pickle... size=7600
accumu_steps=1
[tensor([30.1570, 30.1570, 30.1570, 30.1570], device='cuda:0',
       grad_fn=<GatherBackward>), tensor([33.4075, 33.4075, 33.4075, 33.4075], device='cuda:0',
       grad_fn=<GatherBackward>), tensor([34.9609, 34.9609, 34.9609, 34.9608], device='cuda:0',
       grad_fn=<GatherBackward>), tensor([30.8442, 30.8442, 30.8442, 30.8443], device='cuda:0',
       grad_fn=<GatherBackward>)]
best model saved: step =  199 dev accu =  tensor(0.5913, device='cuda:0')

Validation Results
Global Steps: 199
Valid Loss: 1.00380
Valid Accuracy: 0.59134
time stamp: 86.0691077709198
[tensor([13.0929, 13.0929, 13.0929, 13.0929], device='cuda:0',
       grad_fn=<GatherBackward>), tensor([14.7288, 14.7288, 14.7288, 14.7288], device='cuda:0',
       grad_fn=<GatherBackward>), tensor([15.4773, 15.4773, 15.4773, 15.4773], device='cuda:0',
       grad_fn=<GatherBackward>), tensor([13.4487, 13.4487, 13.4487, 13.4487], device='cuda:0',
       grad_fn=<GatherBackward>)]
best model saved: step =  399 dev accu =  tensor(0.6197, device='cuda:0')

Validation Results
Global Steps: 399
Valid Loss: 0.94300
Valid Accuracy: 0.61972
time stamp: 170.8160011768341
[tensor([6.5830, 6.5830, 6.5830, 6.5830], device='cuda:0',
       grad_fn=<GatherBackward>), tensor([7.4768, 7.4768, 7.4768, 7.4768], device='cuda:0',
       grad_fn=<GatherBackward>), tensor([7.8610, 7.8610, 7.8610, 7.8610], device='cuda:0',
       grad_fn=<GatherBackward>), tensor([6.7726, 6.7726, 6.7726, 6.7726], device='cuda:0',
       grad_fn=<GatherBackward>)]

Validation Results
Global Steps: 599
Valid Loss: 0.94433
Valid Accuracy: 0.61688
time stamp: 255.94157123565674
[tensor([3.7193, 3.7193, 3.7193, 3.7193], device='cuda:0',
       grad_fn=<GatherBackward>), tensor([4.2451, 4.2451, 4.2451, 4.2451], device='cuda:0',
       grad_fn=<GatherBackward>), tensor([4.4534, 4.4534, 4.4534, 4.4534], device='cuda:0',
       grad_fn=<GatherBackward>), tensor([3.8224, 3.8224, 3.8224, 3.8224], device='cuda:0',
       grad_fn=<GatherBackward>)]
best model saved: step =  799 dev accu =  tensor(0.6309, device='cuda:0')

Validation Results
Global Steps: 799
Valid Loss: 0.90652
Valid Accuracy: 0.63094
time stamp: 340.7102372646332
[tensor([2.3067, 2.3067, 2.3067, 2.3067], device='cuda:0',
       grad_fn=<GatherBackward>), tensor([2.6360, 2.6360, 2.6360, 2.6360], device='cuda:0',
       grad_fn=<GatherBackward>), tensor([2.7542, 2.7542, 2.7542, 2.7542], device='cuda:0',
       grad_fn=<GatherBackward>), tensor([2.3629, 2.3629, 2.3629, 2.3629], device='cuda:0',
       grad_fn=<GatherBackward>)]
best model saved: step =  999 dev accu =  tensor(0.6359, device='cuda:0')

Validation Results
Global Steps: 999
Valid Loss: 0.90164
Valid Accuracy: 0.63595
time stamp: 425.464786529541
module.model.transformer_0.mha.pattern saved
module.model.transformer_1.mha.pattern saved
module.model.transformer_2.mha.pattern saved
module.model.transformer_3.mha.pattern saved
./pickle/lra-news1/module.model.transformer_0.mha.pattern.pickle
tensor([ 660,  792,  627,  231,  759,  528,   33,  924,  264,  462,   99,  858,
         693,   66,  363,  429,  726,  297,  825,  891,  561,  495,  330,  396,
         957,  594,  990,  198, 1023,    0,  165,  764,  919,  243,  615,   35,
          97,  132,   58,  833,  666,  852,  499,  623,  694,  725,  373,  683,
         120,  771,  468,  654,   52,  641,  115,  611,  827,  889,  476,  910,
         631,  755,  232,  263,   51,  609,  444,  909,  564,  657,  668,  916,
         253,  935,  797,  952,  470,  718,  445,  941,  372], device='cuda:0')
tensor(81, device='cuda:0')
block_attn_mask compile
./pickle/lra-news1/module.model.transformer_1.mha.pattern.pickle
tensor([ 891,  297,  495,  627,  132,  924,  396,  693,    0,  429,  561,  990,
         759,  825,   33,  231,   99,  330,  858,  726,  660,  303,  489,  264,
         165,   47,  481,  792,  462,  629,  691,  155,  868,  528, 1023,   66,
         363,  594,  565,  689,  507,  879,  154,  836,  957,   59,  865,  763,
         887,  305,  553,  563,  625,  497,  559,  309,  681,  892,  923,  151,
         740,  149,  676,  143,  484,  239,  487,  307,  617,  314,  841,  730,
         854,  158,  964,  698,  853,  301,  425,  632,  787], device='cuda:0')
tensor(81, device='cuda:0')
block_attn_mask compile
./pickle/lra-news1/module.model.transformer_2.mha.pattern.pickle
tensor([858, 660, 594, 231, 429, 495, 330, 726,  66, 528, 165, 132, 891, 462,
        990, 825, 561,  99, 396, 957, 627, 264, 792, 759, 297,   0, 198,  33,
        730, 854, 363, 667, 884, 338, 586, 242, 583, 182, 709, 924, 731, 886,
        246, 711, 404, 652, 662, 724, 347, 874, 434, 589, 167, 229, 175, 485,
        498, 591, 693, 603, 882, 666, 852, 178, 581, 826, 857, 442, 845, 530,
        592, 346, 842, 240, 519, 186, 837, 505, 815, 126, 963],
       device='cuda:0')
tensor(81, device='cuda:0')
block_attn_mask compile
./pickle/lra-news1/module.model.transformer_3.mha.pattern.pickle
tensor([ 660,   66,  528,  165,  990,  726,  594,  759,  363,   99,  396,  924,
         132,  957,   33,  792,  627, 1023,  495,  231,  462,  330,    0,  858,
         561,  891,  198,  693,  297,  429,  150,  708,  264,  596,  658,  370,
         587,  372,  651,  534,  720,  114,  579,  604,  914,   80,  514,   67,
          98,   86,  706,   94,  962,  382,  971,   51,  609,   58,  833,   50,
         577,  767, 1015,  241,  551,   43,  353,  766,  983,   63,  993,   55,
         737,  191,  997,  530,  592,   78,  450,   34,   65], device='cuda:0')
tensor(81, device='cuda:0')
block_attn_mask compile
total pattern searching time (s): 0.1177518367767334
[]

Validation Results
Global Steps: 1199
Valid Loss: 0.93891
Valid Accuracy: 0.61856
time stamp: 466.6988174915314
[]

Validation Results
Global Steps: 1399
Valid Loss: 0.89410
Valid Accuracy: 0.63330
time stamp: 507.5839624404907
[]

Validation Results
Global Steps: 1599
Valid Loss: 0.90615
Valid Accuracy: 0.63499
time stamp: 548.5305068492889
[]
best model saved: step =  1799 dev accu =  tensor(0.6451, device='cuda:0')

Validation Results
Global Steps: 1799
Valid Loss: 0.87515
Valid Accuracy: 0.64509
time stamp: 589.5438942909241
[]

Validation Results
Global Steps: 1999
Valid Loss: 0.87611
Valid Accuracy: 0.64141
time stamp: 630.8153712749481
[]
best model saved: step =  2199 dev accu =  tensor(0.6556, device='cuda:0')

Validation Results
Global Steps: 2199
Valid Loss: 0.85828
Valid Accuracy: 0.65562
time stamp: 671.5186142921448
[]
best model saved: step =  2399 dev accu =  tensor(0.6616, device='cuda:0')

Validation Results
Global Steps: 2399
Valid Loss: 0.86321
Valid Accuracy: 0.66163
time stamp: 712.5704874992371
[]
best model saved: step =  2599 dev accu =  tensor(0.6680, device='cuda:0')

Validation Results
Global Steps: 2599
Valid Loss: 0.84453
Valid Accuracy: 0.66804
time stamp: 753.7235026359558
[]

Validation Results
Global Steps: 2799
Valid Loss: 0.83248
Valid Accuracy: 0.66561
time stamp: 794.7650916576385
[]

Validation Results
Global Steps: 2999
Valid Loss: 0.83555
Valid Accuracy: 0.66673
time stamp: 835.7610015869141
[]
best model saved: step =  3199 dev accu =  tensor(0.6703, device='cuda:0')

Validation Results
Global Steps: 3199
Valid Loss: 0.82363
Valid Accuracy: 0.67027
time stamp: 876.8110477924347
[]

Validation Results
Global Steps: 3399
Valid Loss: 0.83760
Valid Accuracy: 0.66516
time stamp: 917.8839321136475
[]
best model saved: step =  3599 dev accu =  tensor(0.6730, device='cuda:0')

Validation Results
Global Steps: 3599
Valid Loss: 0.81926
Valid Accuracy: 0.67303
time stamp: 958.5847537517548
[]
best model saved: step =  3799 dev accu =  tensor(0.6779, device='cuda:0')

Validation Results
Global Steps: 3799
Valid Loss: 0.81363
Valid Accuracy: 0.67786
time stamp: 999.4371230602264
[]
best model saved: step =  3999 dev accu =  tensor(0.6836, device='cuda:0')

Validation Results
Global Steps: 3999
Valid Loss: 0.80291
Valid Accuracy: 0.68356
time stamp: 1040.2991013526917
[]

Validation Results
Global Steps: 4199
Valid Loss: 0.80896
Valid Accuracy: 0.67487
time stamp: 1081.2705171108246
[]

Validation Results
Global Steps: 4399
Valid Loss: 0.81881
Valid Accuracy: 0.67702
time stamp: 1122.2419300079346
[]
best model saved: step =  4599 dev accu =  tensor(0.6853, device='cuda:0')

Validation Results
Global Steps: 4599
Valid Loss: 0.79659
Valid Accuracy: 0.68529
time stamp: 1163.349318265915
[]

Validation Results
Global Steps: 4799
Valid Loss: 0.80734
Valid Accuracy: 0.68498
time stamp: 1204.5712122917175
[]
best model saved: step =  4999 dev accu =  tensor(0.6895, device='cuda:0')

Validation Results
Global Steps: 4999
Valid Loss: 0.79227
Valid Accuracy: 0.68945
time stamp: 1245.5850205421448
[]
best model saved: step =  5199 dev accu =  tensor(0.6902, device='cuda:0')

Validation Results
Global Steps: 5199
Valid Loss: 0.79932
Valid Accuracy: 0.69019
time stamp: 1287.0596332550049
[]
best model saved: step =  5399 dev accu =  tensor(0.6971, device='cuda:0')

Validation Results
Global Steps: 5399
Valid Loss: 0.78013
Valid Accuracy: 0.69715
time stamp: 1328.3529942035675
[]
best model saved: step =  5599 dev accu =  tensor(0.7003, device='cuda:0')

Validation Results
Global Steps: 5599
Valid Loss: 0.78361
Valid Accuracy: 0.70025
time stamp: 1369.3424792289734
[]

Validation Results
Global Steps: 5799
Valid Loss: 0.77234
Valid Accuracy: 0.70020
time stamp: 1410.3964755535126
[]
best model saved: step =  5999 dev accu =  tensor(0.7072, device='cuda:0')

Validation Results
Global Steps: 5999
Valid Loss: 0.75418
Valid Accuracy: 0.70724
time stamp: 1451.2203226089478
[]

Validation Results
Global Steps: 6199
Valid Loss: 0.78298
Valid Accuracy: 0.70116
time stamp: 1492.1323568820953
[]

Validation Results
Global Steps: 6399
Valid Loss: 0.78063
Valid Accuracy: 0.69751
time stamp: 1533.339056968689
[]

Validation Results
Global Steps: 6599
Valid Loss: 0.75989
Valid Accuracy: 0.70716
time stamp: 1574.4239194393158
[]

Validation Results
Global Steps: 6799
Valid Loss: 0.76072
Valid Accuracy: 0.70475
time stamp: 1615.710910320282
[]

Validation Results
Global Steps: 6999
Valid Loss: 0.76087
Valid Accuracy: 0.70587
time stamp: 1657.2829999923706
[]
best model saved: step =  7199 dev accu =  tensor(0.7111, device='cuda:0')

Validation Results
Global Steps: 7199
Valid Loss: 0.74996
Valid Accuracy: 0.71111
time stamp: 1698.2681138515472
[]

Validation Results
Global Steps: 7399
Valid Loss: 0.74987
Valid Accuracy: 0.70954
time stamp: 1738.9951281547546
[]
best model saved: step =  7599 dev accu =  tensor(0.7167, device='cuda:0')

Validation Results
Global Steps: 7599
Valid Loss: 0.75778
Valid Accuracy: 0.71667
time stamp: 1779.8803193569183
[]

Validation Results
Global Steps: 7799
Valid Loss: 0.74913
Valid Accuracy: 0.71394
time stamp: 1821.323453426361
[]

Validation Results
Global Steps: 7999
Valid Loss: 0.75556
Valid Accuracy: 0.71405
time stamp: 1862.3379390239716
[]

Validation Results
Global Steps: 8199
Valid Loss: 0.73914
Valid Accuracy: 0.71646
time stamp: 1903.3671689033508
[]

Validation Results
Global Steps: 8399
Valid Loss: 0.75292
Valid Accuracy: 0.71403
time stamp: 1944.4329242706299
[]
best model saved: step =  8599 dev accu =  tensor(0.7179, device='cuda:0')

Validation Results
Global Steps: 8599
Valid Loss: 0.73493
Valid Accuracy: 0.71795
time stamp: 1985.4249081611633
[]

Validation Results
Global Steps: 8799
Valid Loss: 0.76067
Valid Accuracy: 0.71303
time stamp: 2026.1559073925018
[]

Validation Results
Global Steps: 8999
Valid Loss: 0.74204
Valid Accuracy: 0.71751
time stamp: 2066.84889292717
[]

Validation Results
Global Steps: 9199
Valid Loss: 0.75183
Valid Accuracy: 0.71646
time stamp: 2107.9030549526215
[]
best model saved: step =  9399 dev accu =  tensor(0.7208, device='cuda:0')

Validation Results
Global Steps: 9399
Valid Loss: 0.74184
Valid Accuracy: 0.72076
time stamp: 2148.745913505554
[]

Validation Results
Global Steps: 9599
Valid Loss: 0.75281
Valid Accuracy: 0.71630
time stamp: 2189.7536494731903
[]

Validation Results
Global Steps: 9799
Valid Loss: 0.73573
Valid Accuracy: 0.72007
time stamp: 2231.000429391861
[]

Validation Results
Global Steps: 9999
Valid Loss: 0.75912
Valid Accuracy: 0.71433
time stamp: 2272.2246294021606
[]
best model saved: step =  10199 dev accu =  tensor(0.7223, device='cuda:0')

Validation Results
Global Steps: 10199
Valid Loss: 0.74054
Valid Accuracy: 0.72228
time stamp: 2313.1573219299316
[]

Validation Results
Global Steps: 10399
Valid Loss: 0.74405
Valid Accuracy: 0.72219
time stamp: 2354.827132701874
[]
best model saved: step =  10599 dev accu =  tensor(0.7289, device='cuda:0')

Validation Results
Global Steps: 10599
Valid Loss: 0.73576
Valid Accuracy: 0.72894
time stamp: 2396.0559372901917
[]

Validation Results
Global Steps: 10799
Valid Loss: 0.74595
Valid Accuracy: 0.72168
time stamp: 2437.1639754772186
[]

Validation Results
Global Steps: 10999
Valid Loss: 0.72858
Valid Accuracy: 0.72442
time stamp: 2478.46906208992
[]

Validation Results
Global Steps: 11199
Valid Loss: 0.72578
Valid Accuracy: 0.72488
time stamp: 2519.3293466567993
[]

Validation Results
Global Steps: 11399
Valid Loss: 0.73948
Valid Accuracy: 0.72705
time stamp: 2560.4048585891724
[]

Validation Results
Global Steps: 11599
Valid Loss: 0.74302
Valid Accuracy: 0.72460
time stamp: 2601.464008808136
[]

Validation Results
Global Steps: 11799
Valid Loss: 0.73822
Valid Accuracy: 0.72707
time stamp: 2642.1955449581146
[]
best model saved: step =  11999 dev accu =  tensor(0.7308, device='cuda:0')

Validation Results
Global Steps: 11999
Valid Loss: 0.73231
Valid Accuracy: 0.73076
time stamp: 2683.3006381988525
[]

Validation Results
Global Steps: 12199
Valid Loss: 0.74522
Valid Accuracy: 0.72724
time stamp: 2724.2956404685974
[]
best model saved: step =  12399 dev accu =  tensor(0.7385, device='cuda:0')

Validation Results
Global Steps: 12399
Valid Loss: 0.70829
Valid Accuracy: 0.73846
time stamp: 2765.6660463809967
[]

Validation Results
Global Steps: 12599
Valid Loss: 0.73604
Valid Accuracy: 0.73342
time stamp: 2806.6834099292755
[]
best model saved: step =  12799 dev accu =  tensor(0.7405, device='cuda:0')

Validation Results
Global Steps: 12799
Valid Loss: 0.70448
Valid Accuracy: 0.74052
time stamp: 2848.105535030365
[]

Validation Results
Global Steps: 12999
Valid Loss: 0.71242
Valid Accuracy: 0.73610
time stamp: 2889.260474920273
[]

Validation Results
Global Steps: 13199
Valid Loss: 0.72621
Valid Accuracy: 0.72988
time stamp: 2930.5876746177673
[]

Validation Results
Global Steps: 13399
Valid Loss: 0.71987
Valid Accuracy: 0.73621
time stamp: 2971.8861000537872
[]
best model saved: step =  13599 dev accu =  tensor(0.7425, device='cuda:0')

Validation Results
Global Steps: 13599
Valid Loss: 0.71034
Valid Accuracy: 0.74252
time stamp: 3012.6976919174194
[]

Validation Results
Global Steps: 13799
Valid Loss: 0.72668
Valid Accuracy: 0.73677
time stamp: 3053.7126820087433
[]
best model saved: step =  13999 dev accu =  tensor(0.7430, device='cuda:0')

Validation Results
Global Steps: 13999
Valid Loss: 0.70132
Valid Accuracy: 0.74304
time stamp: 3095.063419818878
[]

Validation Results
Global Steps: 14199
Valid Loss: 0.71431
Valid Accuracy: 0.74090
time stamp: 3135.999169111252
[]
best model saved: step =  14399 dev accu =  tensor(0.7484, device='cuda:0')

Validation Results
Global Steps: 14399
Valid Loss: 0.70569
Valid Accuracy: 0.74839
time stamp: 3177.410896062851
[]

Validation Results
Global Steps: 14599
Valid Loss: 0.70102
Valid Accuracy: 0.74322
time stamp: 3218.7540435791016
[]

Validation Results
Global Steps: 14799
Valid Loss: 0.69281
Valid Accuracy: 0.74736
time stamp: 3259.8867428302765
[]
best model saved: step =  14999 dev accu =  tensor(0.7497, device='cuda:0')

Validation Results
Global Steps: 14999
Valid Loss: 0.68972
Valid Accuracy: 0.74973
time stamp: 3300.8788554668427
[]

Validation Results
Global Steps: 15199
Valid Loss: 0.70509
Valid Accuracy: 0.74698
time stamp: 3342.4193749427795
[]
best model saved: step =  15399 dev accu =  tensor(0.7535, device='cuda:0')

Validation Results
Global Steps: 15399
Valid Loss: 0.68268
Valid Accuracy: 0.75354
time stamp: 3383.322113752365
[]

Validation Results
Global Steps: 15599
Valid Loss: 0.68547
Valid Accuracy: 0.74707
time stamp: 3424.5260257720947
[]

Validation Results
Global Steps: 15799
Valid Loss: 0.70126
Valid Accuracy: 0.74704
time stamp: 3465.7213842868805
[]

Validation Results
Global Steps: 15999
Valid Loss: 0.69998
Valid Accuracy: 0.75118
time stamp: 3506.9173591136932
[]

Validation Results
Global Steps: 16199
Valid Loss: 0.70038
Valid Accuracy: 0.75340
time stamp: 3547.977514266968
[]

Validation Results
Global Steps: 16399
Valid Loss: 0.68949
Valid Accuracy: 0.75046
time stamp: 3589.046722173691
[]

Validation Results
Global Steps: 16599
Valid Loss: 0.70063
Valid Accuracy: 0.75196
time stamp: 3629.8821923732758
[]

Validation Results
Global Steps: 16799
Valid Loss: 0.70031
Valid Accuracy: 0.75156
time stamp: 3671.1501321792603
[]
best model saved: step =  16999 dev accu =  tensor(0.7558, device='cuda:0')

Validation Results
Global Steps: 16999
Valid Loss: 0.68432
Valid Accuracy: 0.75578
time stamp: 3712.3190636634827
[]
best model saved: step =  17199 dev accu =  tensor(0.7588, device='cuda:0')

Validation Results
Global Steps: 17199
Valid Loss: 0.68360
Valid Accuracy: 0.75877
time stamp: 3753.3651156425476
[]
best model saved: step =  17399 dev accu =  tensor(0.7612, device='cuda:0')

Validation Results
Global Steps: 17399
Valid Loss: 0.67639
Valid Accuracy: 0.76118
time stamp: 3794.4219300746918
[]

Validation Results
Global Steps: 17599
Valid Loss: 0.67715
Valid Accuracy: 0.75998
time stamp: 3835.227283000946
[]

Validation Results
Global Steps: 17799
Valid Loss: 0.68011
Valid Accuracy: 0.75739
time stamp: 3876.3209879398346
[]
best model saved: step =  17999 dev accu =  tensor(0.7627, device='cuda:0')

Validation Results
Global Steps: 17999
Valid Loss: 0.67343
Valid Accuracy: 0.76272
time stamp: 3917.5373170375824
[]

Validation Results
Global Steps: 18199
Valid Loss: 0.68008
Valid Accuracy: 0.75785
time stamp: 3958.797585248947
[]
best model saved: step =  18399 dev accu =  tensor(0.7630, device='cuda:0')

Validation Results
Global Steps: 18399
Valid Loss: 0.66695
Valid Accuracy: 0.76298
time stamp: 3999.837171316147
[]
best model saved: step =  18599 dev accu =  tensor(0.7634, device='cuda:0')

Validation Results
Global Steps: 18599
Valid Loss: 0.66940
Valid Accuracy: 0.76342
time stamp: 4041.143307209015
[]

Validation Results
Global Steps: 18799
Valid Loss: 0.67059
Valid Accuracy: 0.76282
time stamp: 4082.25390291214
[]
best model saved: step =  18999 dev accu =  tensor(0.7653, device='cuda:0')

Validation Results
Global Steps: 18999
Valid Loss: 0.65957
Valid Accuracy: 0.76534
time stamp: 4123.2372126579285
[]
best model saved: step =  19199 dev accu =  tensor(0.7673, device='cuda:0')

Validation Results
Global Steps: 19199
Valid Loss: 0.66509
Valid Accuracy: 0.76729
time stamp: 4164.297482252121
[]
best model saved: step =  19399 dev accu =  tensor(0.7687, device='cuda:0')

Validation Results
Global Steps: 19399
Valid Loss: 0.65560
Valid Accuracy: 0.76873
time stamp: 4205.265971422195
[]

Validation Results
Global Steps: 19599
Valid Loss: 0.65484
Valid Accuracy: 0.76709
time stamp: 4246.3435299396515
[]
best model saved: step =  19799 dev accu =  tensor(0.7722, device='cuda:0')

Validation Results
Global Steps: 19799
Valid Loss: 0.65533
Valid Accuracy: 0.77220
time stamp: 4287.108981847763
[]
best model saved: step =  19999 dev accu =  tensor(0.7740, device='cuda:0')

Validation Results
Global Steps: 19999
Valid Loss: 0.65455
Valid Accuracy: 0.77403
time stamp: 4328.031243801117
[]

Validation Results
Global Steps: 20199
Valid Loss: 0.66815
Valid Accuracy: 0.76997
time stamp: 4368.881311416626
[]

Validation Results
Global Steps: 20399
Valid Loss: 0.64843
Valid Accuracy: 0.77188
time stamp: 4409.834108352661
[]

Validation Results
Global Steps: 20599
Valid Loss: 0.65136
Valid Accuracy: 0.77186
time stamp: 4450.919666290283
[]
best model saved: step =  20799 dev accu =  tensor(0.7764, device='cuda:0')

Validation Results
Global Steps: 20799
Valid Loss: 0.64406
Valid Accuracy: 0.77643
time stamp: 4492.04921746254
[]

Validation Results
Global Steps: 20999
Valid Loss: 0.64304
Valid Accuracy: 0.77541
time stamp: 4533.047368526459
[]

Validation Results
Global Steps: 21199
Valid Loss: 0.64954
Valid Accuracy: 0.77301
time stamp: 4574.149373054504
[]
best model saved: step =  21399 dev accu =  tensor(0.7765, device='cuda:0')

Validation Results
Global Steps: 21399
Valid Loss: 0.64807
Valid Accuracy: 0.77653
time stamp: 4615.338860273361
[]

Validation Results
Global Steps: 21599
Valid Loss: 0.64813
Valid Accuracy: 0.77523
time stamp: 4656.239212751389
[]

Validation Results
Global Steps: 21799
Valid Loss: 0.64592
Valid Accuracy: 0.77542
time stamp: 4697.144943714142
[]

Validation Results
Global Steps: 21999
Valid Loss: 0.63951
Valid Accuracy: 0.77619
time stamp: 4738.118365764618
[]

Validation Results
Global Steps: 22199
Valid Loss: 0.63427
Valid Accuracy: 0.77379
time stamp: 4779.134799003601
[]

Validation Results
Global Steps: 22399
Valid Loss: 0.64838
Valid Accuracy: 0.77563
time stamp: 4820.458748579025
[]
best model saved: step =  22599 dev accu =  tensor(0.7815, device='cuda:0')

Validation Results
Global Steps: 22599
Valid Loss: 0.62961
Valid Accuracy: 0.78152
time stamp: 4861.61639213562
[]

Validation Results
Global Steps: 22799
Valid Loss: 0.63841
Valid Accuracy: 0.78082
time stamp: 4902.340611457825
[]

Validation Results
Global Steps: 22999
Valid Loss: 0.64189
Valid Accuracy: 0.78005
time stamp: 4943.506543397903
[]

Validation Results
Global Steps: 23199
Valid Loss: 0.63198
Valid Accuracy: 0.77763
time stamp: 4984.762654542923
[]

Validation Results
Global Steps: 23399
Valid Loss: 0.63422
Valid Accuracy: 0.77991
time stamp: 5025.7123103141785
[]

Validation Results
Global Steps: 23599
Valid Loss: 0.63099
Valid Accuracy: 0.77891
time stamp: 5066.737502574921
[]

Validation Results
Global Steps: 23799
Valid Loss: 0.63436
Valid Accuracy: 0.77979
time stamp: 5107.566163778305
[]
best model saved: step =  23999 dev accu =  tensor(0.7820, device='cuda:0')

Validation Results
Global Steps: 23999
Valid Loss: 0.63781
Valid Accuracy: 0.78198
time stamp: 5148.262638092041
[]
best model saved: step =  24199 dev accu =  tensor(0.7827, device='cuda:0')

Validation Results
Global Steps: 24199
Valid Loss: 0.63303
Valid Accuracy: 0.78273
time stamp: 5189.186310529709
[]

Validation Results
Global Steps: 24399
Valid Loss: 0.63128
Valid Accuracy: 0.78141
time stamp: 5230.243467569351
[]
best model saved: step =  24599 dev accu =  tensor(0.7860, device='cuda:0')

Validation Results
Global Steps: 24599
Valid Loss: 0.63306
Valid Accuracy: 0.78604
time stamp: 5271.168074607849
[]

Validation Results
Global Steps: 24799
Valid Loss: 0.62706
Valid Accuracy: 0.78023
time stamp: 5312.10232591629
[]

Validation Results
Global Steps: 24999
Valid Loss: 0.63722
Valid Accuracy: 0.78436
time stamp: 5353.142269849777
[]

Validation Results
Global Steps: 25199
Valid Loss: 0.62183
Valid Accuracy: 0.78485
time stamp: 5394.295362472534
[]

Validation Results
Global Steps: 25399
Valid Loss: 0.63042
Valid Accuracy: 0.78312
time stamp: 5435.362250328064
[]

Validation Results
Global Steps: 25599
Valid Loss: 0.63847
Valid Accuracy: 0.78097
time stamp: 5476.606467008591
[]

Validation Results
Global Steps: 25799
Valid Loss: 0.62647
Valid Accuracy: 0.78434
time stamp: 5517.6437401771545
[]

Validation Results
Global Steps: 25999
Valid Loss: 0.62849
Valid Accuracy: 0.78547
time stamp: 5558.581722736359
[]
best model saved: step =  26199 dev accu =  tensor(0.7866, device='cuda:0')

Validation Results
Global Steps: 26199
Valid Loss: 0.62427
Valid Accuracy: 0.78663
time stamp: 5599.656596183777
[]
best model saved: step =  26399 dev accu =  tensor(0.7879, device='cuda:0')

Validation Results
Global Steps: 26399
Valid Loss: 0.62482
Valid Accuracy: 0.78787
time stamp: 5640.1358897686005
[]

Validation Results
Global Steps: 26599
Valid Loss: 0.62440
Valid Accuracy: 0.78552
time stamp: 5681.602964878082
[]

Validation Results
Global Steps: 26799
Valid Loss: 0.62943
Valid Accuracy: 0.78576
time stamp: 5722.790631532669
[]
best model saved: step =  26999 dev accu =  tensor(0.7883, device='cuda:0')

Validation Results
Global Steps: 26999
Valid Loss: 0.62230
Valid Accuracy: 0.78834
time stamp: 5764.350907802582
[]

Validation Results
Global Steps: 27199
Valid Loss: 0.62785
Valid Accuracy: 0.78583
time stamp: 5805.448562383652
[]

Validation Results
Global Steps: 27399
Valid Loss: 0.62524
Valid Accuracy: 0.78402
time stamp: 5846.0391726493835
[]

Validation Results
Global Steps: 27599
Valid Loss: 0.63303
Valid Accuracy: 0.78353
time stamp: 5887.210983037949
[]

Validation Results
Global Steps: 27799
Valid Loss: 0.62175
Valid Accuracy: 0.78656
time stamp: 5928.520039319992
[]

Validation Results
Global Steps: 27999
Valid Loss: 0.62768
Valid Accuracy: 0.78652
time stamp: 5969.17458486557
[]

Validation Results
Global Steps: 28199
Valid Loss: 0.62699
Valid Accuracy: 0.78611
time stamp: 6010.023032665253
[]

Validation Results
Global Steps: 28399
Valid Loss: 0.62601
Valid Accuracy: 0.78582
time stamp: 6051.145421743393
[]

Validation Results
Global Steps: 28599
Valid Loss: 0.62821
Valid Accuracy: 0.78553
time stamp: 6091.870543003082
[]

Validation Results
Global Steps: 28799
Valid Loss: 0.62236
Valid Accuracy: 0.78711
time stamp: 6133.084943532944
[]

Validation Results
Global Steps: 28999
Valid Loss: 0.62778
Valid Accuracy: 0.78621
time stamp: 6174.3645277023315
[]

Validation Results
Global Steps: 29199
Valid Loss: 0.62788
Valid Accuracy: 0.78689
time stamp: 6215.5057508945465
[]

Validation Results
Global Steps: 29399
Valid Loss: 0.62603
Valid Accuracy: 0.78605
time stamp: 6256.415836572647
[]

Validation Results
Global Steps: 29599
Valid Loss: 0.62504
Valid Accuracy: 0.78579
time stamp: 6297.544542312622
[]

Validation Results
Global Steps: 29799
Valid Loss: 0.62446
Valid Accuracy: 0.78641
time stamp: 6338.361027002335
[]

Validation Results
Global Steps: 29999
Valid Loss: 0.62325
Valid Accuracy: 0.78680
time stamp: 6379.396906375885
total training step (k): 30.0
total training time (s): 6379.397503614426
total training time (ms): 1678116.4287109375
peak memory usage (MB): 12762
allocated memory usage (MB): 433849439
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |   10095 KB |   12762 MB |  423681 GB |  423681 GB |
|       from large pool |    6144 KB |   12750 MB |  420289 GB |  420289 GB |
|       from small pool |    3951 KB |      27 MB |    3391 GB |    3391 GB |
|---------------------------------------------------------------------------|
| Active memory         |   10095 KB |   12762 MB |  423681 GB |  423681 GB |
|       from large pool |    6144 KB |   12750 MB |  420289 GB |  420289 GB |
|       from small pool |    3951 KB |      27 MB |    3391 GB |    3391 GB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   12848 MB |   12848 MB |   12848 MB |       0 B  |
|       from large pool |   12820 MB |   12820 MB |   12820 MB |       0 B  |
|       from small pool |      28 MB |      28 MB |      28 MB |       0 B  |
|---------------------------------------------------------------------------|
| Non-releasable memory |   14481 KB |    1378 MB |  442283 GB |  442283 GB |
|       from large pool |   10240 KB |    1377 MB |  438773 GB |  438773 GB |
|       from small pool |    4241 KB |       6 MB |    3509 GB |    3509 GB |
|---------------------------------------------------------------------------|
| Allocations           |     246    |     535    |   35706 K  |   35706 K  |
|       from large pool |       2    |      87    |   13720 K  |   13720 K  |
|       from small pool |     244    |     518    |   21986 K  |   21986 K  |
|---------------------------------------------------------------------------|
| Active allocs         |     246    |     535    |   35706 K  |   35706 K  |
|       from large pool |       2    |      87    |   13720 K  |   13720 K  |
|       from small pool |     244    |     518    |   21986 K  |   21986 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      44    |      44    |      44    |       0    |
|       from large pool |      30    |      30    |      30    |       0    |
|       from small pool |      14    |      14    |      14    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |      11    |      36    |   16411 K  |   16411 K  |
|       from large pool |       1    |      16    |    6396 K  |    6396 K  |
|       from small pool |      10    |      26    |   10014 K  |   10014 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

loading the best model from: ./checkpoints/checkpoints-0/lra-news1/density08.model
Evaluation Results
Loss: 0.62230
Accuracy: 0.79004
