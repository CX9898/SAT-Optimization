GPU list: [0, 1, 2, 3]
[
    {
        "learn_pos_emb": true,
        "tied_weights": false,
        "embedding_dim": 64,
        "transformer_dim": 64,
        "transformer_hidden_dim": 128,
        "head_dim": 32,
        "num_head": 2,
        "num_layers": 4,
        "vocab_size": 512,
        "max_seq_len": 1024,
        "dropout_prob": 0.1,
        "attention_dropout": 0.1,
        "pooling_mode": "MEAN",
        "num_classes": 4,
        "block_size": 32,
        "batch_size": 128,
        "density": 0.06,
        "mixed_precision": true,
        "random_seed": 0,
        "task": "lra-news1"
    },
    {
        "batch_size": 512,
        "learning_rate": 0.0007,
        "warmup": 80,
        "lr_decay": "linear",
        "weight_decay": 0,
        "eval_frequency": 200,
        "num_train_steps": 30000,
        "num_init_steps": 3000,
        "num_eval_steps": 200,
        "num_dense_train_steps": 1000,
        "patience": 10,
        "attn_loss_scale": 0.01
    }
]
attn_mask compile
attn_mask compile
attn_mask compile
attn_mask compile
DataParallel(
  (module): ModelForSC(
    (model): Model(
      (embeddings): Embeddings(
        (word_embeddings): Embedding(512, 64)
        (position_embeddings): Embedding(1024, 64)
        (dropout): Dropout(p=0.1, inplace=False)
      )
      (transformer_0): TransformerLayer(
        (norm1): LayerNorm((64,), eps=1e-05, elementwise_affine=True)
        (mha): Attention(
          (W_q): Linear(in_features=64, out_features=64, bias=True)
          (W_k): Linear(in_features=64, out_features=64, bias=True)
          (W_v): Linear(in_features=64, out_features=64, bias=True)
          (avg_pool): AvgPool2d(kernel_size=32, stride=32, padding=0)
          (MSEloss): MSELoss()
          (attn): CUDAMaskAttention()
          (ff): Linear(in_features=64, out_features=64, bias=True)
        )
        (dropout1): Dropout(p=0.1, inplace=False)
        (norm2): LayerNorm((64,), eps=1e-05, elementwise_affine=True)
        (mlpblock): Sequential(
          (0): Linear(in_features=64, out_features=128, bias=True)
          (1): GELU(approximate='none')
          (2): Dropout(p=0.1, inplace=False)
          (3): Linear(in_features=128, out_features=64, bias=True)
          (4): Dropout(p=0.1, inplace=False)
        )
      )
      (transformer_1): TransformerLayer(
        (norm1): LayerNorm((64,), eps=1e-05, elementwise_affine=True)
        (mha): Attention(
          (W_q): Linear(in_features=64, out_features=64, bias=True)
          (W_k): Linear(in_features=64, out_features=64, bias=True)
          (W_v): Linear(in_features=64, out_features=64, bias=True)
          (avg_pool): AvgPool2d(kernel_size=32, stride=32, padding=0)
          (MSEloss): MSELoss()
          (attn): CUDAMaskAttention()
          (ff): Linear(in_features=64, out_features=64, bias=True)
        )
        (dropout1): Dropout(p=0.1, inplace=False)
        (norm2): LayerNorm((64,), eps=1e-05, elementwise_affine=True)
        (mlpblock): Sequential(
          (0): Linear(in_features=64, out_features=128, bias=True)
          (1): GELU(approximate='none')
          (2): Dropout(p=0.1, inplace=False)
          (3): Linear(in_features=128, out_features=64, bias=True)
          (4): Dropout(p=0.1, inplace=False)
        )
      )
      (transformer_2): TransformerLayer(
        (norm1): LayerNorm((64,), eps=1e-05, elementwise_affine=True)
        (mha): Attention(
          (W_q): Linear(in_features=64, out_features=64, bias=True)
          (W_k): Linear(in_features=64, out_features=64, bias=True)
          (W_v): Linear(in_features=64, out_features=64, bias=True)
          (avg_pool): AvgPool2d(kernel_size=32, stride=32, padding=0)
          (MSEloss): MSELoss()
          (attn): CUDAMaskAttention()
          (ff): Linear(in_features=64, out_features=64, bias=True)
        )
        (dropout1): Dropout(p=0.1, inplace=False)
        (norm2): LayerNorm((64,), eps=1e-05, elementwise_affine=True)
        (mlpblock): Sequential(
          (0): Linear(in_features=64, out_features=128, bias=True)
          (1): GELU(approximate='none')
          (2): Dropout(p=0.1, inplace=False)
          (3): Linear(in_features=128, out_features=64, bias=True)
          (4): Dropout(p=0.1, inplace=False)
        )
      )
      (transformer_3): TransformerLayer(
        (norm1): LayerNorm((64,), eps=1e-05, elementwise_affine=True)
        (mha): Attention(
          (W_q): Linear(in_features=64, out_features=64, bias=True)
          (W_k): Linear(in_features=64, out_features=64, bias=True)
          (W_v): Linear(in_features=64, out_features=64, bias=True)
          (avg_pool): AvgPool2d(kernel_size=32, stride=32, padding=0)
          (MSEloss): MSELoss()
          (attn): CUDAMaskAttention()
          (ff): Linear(in_features=64, out_features=64, bias=True)
        )
        (dropout1): Dropout(p=0.1, inplace=False)
        (norm2): LayerNorm((64,), eps=1e-05, elementwise_affine=True)
        (mlpblock): Sequential(
          (0): Linear(in_features=64, out_features=128, bias=True)
          (1): GELU(approximate='none')
          (2): Dropout(p=0.1, inplace=False)
          (3): Linear(in_features=128, out_features=64, bias=True)
          (4): Dropout(p=0.1, inplace=False)
        )
      )
      (norm): LayerNorm((64,), eps=1e-05, elementwise_affine=True)
    )
    (seq_classifer): SCHead(
      (mlpblock): Sequential(
        (0): Linear(in_features=64, out_features=128, bias=True)
        (1): ReLU()
        (2): Linear(in_features=128, out_features=4, bias=True)
      )
    )
  )
)
parameter_size: [torch.Size([512, 64]), torch.Size([1024, 64]), torch.Size([64]), torch.Size([64]), torch.Size([32, 32]), torch.Size([64, 64]), torch.Size([64]), torch.Size([64, 64]), torch.Size([64]), torch.Size([64, 64]), torch.Size([64]), torch.Size([64, 64]), torch.Size([64]), torch.Size([64]), torch.Size([64]), torch.Size([128, 64]), torch.Size([128]), torch.Size([64, 128]), torch.Size([64]), torch.Size([64]), torch.Size([64]), torch.Size([32, 32]), torch.Size([64, 64]), torch.Size([64]), torch.Size([64, 64]), torch.Size([64]), torch.Size([64, 64]), torch.Size([64]), torch.Size([64, 64]), torch.Size([64]), torch.Size([64]), torch.Size([64]), torch.Size([128, 64]), torch.Size([128]), torch.Size([64, 128]), torch.Size([64]), torch.Size([64]), torch.Size([64]), torch.Size([32, 32]), torch.Size([64, 64]), torch.Size([64]), torch.Size([64, 64]), torch.Size([64]), torch.Size([64, 64]), torch.Size([64]), torch.Size([64, 64]), torch.Size([64]), torch.Size([64]), torch.Size([64]), torch.Size([128, 64]), torch.Size([128]), torch.Size([64, 128]), torch.Size([64]), torch.Size([64]), torch.Size([64]), torch.Size([32, 32]), torch.Size([64, 64]), torch.Size([64]), torch.Size([64, 64]), torch.Size([64]), torch.Size([64, 64]), torch.Size([64]), torch.Size([64, 64]), torch.Size([64]), torch.Size([64]), torch.Size([64]), torch.Size([128, 64]), torch.Size([128]), torch.Size([64, 128]), torch.Size([64]), torch.Size([64]), torch.Size([64]), torch.Size([128, 64]), torch.Size([128]), torch.Size([4, 128]), torch.Size([4])]
num_parameter: 245252
Loaded ../Skyformer/data/lra_processed/lra-news1.train.pickle... size=120000
Loaded ../Skyformer/data/lra_processed/lra-news1.dev.pickle... size=7600
Loaded ../Skyformer/data/lra_processed/lra-news1.test.pickle... size=7600
accumu_steps=1
[tensor([30.1570, 30.1570, 30.1570, 30.1570], device='cuda:0',
       grad_fn=<GatherBackward>), tensor([33.4075, 33.4075, 33.4075, 33.4075], device='cuda:0',
       grad_fn=<GatherBackward>), tensor([34.9609, 34.9609, 34.9609, 34.9608], device='cuda:0',
       grad_fn=<GatherBackward>), tensor([30.8442, 30.8442, 30.8442, 30.8443], device='cuda:0',
       grad_fn=<GatherBackward>)]
best model saved: step =  199 dev accu =  tensor(0.5913, device='cuda:0')

Validation Results
Global Steps: 199
Valid Loss: 1.00380
Valid Accuracy: 0.59134
time stamp: 87.06620359420776
[tensor([13.0929, 13.0929, 13.0929, 13.0929], device='cuda:0',
       grad_fn=<GatherBackward>), tensor([14.7288, 14.7288, 14.7288, 14.7288], device='cuda:0',
       grad_fn=<GatherBackward>), tensor([15.4773, 15.4773, 15.4773, 15.4773], device='cuda:0',
       grad_fn=<GatherBackward>), tensor([13.4487, 13.4487, 13.4487, 13.4487], device='cuda:0',
       grad_fn=<GatherBackward>)]
best model saved: step =  399 dev accu =  tensor(0.6197, device='cuda:0')

Validation Results
Global Steps: 399
Valid Loss: 0.94300
Valid Accuracy: 0.61972
time stamp: 171.88678097724915
[tensor([6.5830, 6.5830, 6.5830, 6.5830], device='cuda:0',
       grad_fn=<GatherBackward>), tensor([7.4768, 7.4768, 7.4768, 7.4768], device='cuda:0',
       grad_fn=<GatherBackward>), tensor([7.8610, 7.8610, 7.8610, 7.8610], device='cuda:0',
       grad_fn=<GatherBackward>), tensor([6.7726, 6.7726, 6.7726, 6.7726], device='cuda:0',
       grad_fn=<GatherBackward>)]

Validation Results
Global Steps: 599
Valid Loss: 0.94433
Valid Accuracy: 0.61688
time stamp: 256.28598165512085
[tensor([3.7193, 3.7193, 3.7193, 3.7193], device='cuda:0',
       grad_fn=<GatherBackward>), tensor([4.2451, 4.2451, 4.2451, 4.2451], device='cuda:0',
       grad_fn=<GatherBackward>), tensor([4.4534, 4.4534, 4.4534, 4.4534], device='cuda:0',
       grad_fn=<GatherBackward>), tensor([3.8224, 3.8224, 3.8224, 3.8224], device='cuda:0',
       grad_fn=<GatherBackward>)]
best model saved: step =  799 dev accu =  tensor(0.6309, device='cuda:0')

Validation Results
Global Steps: 799
Valid Loss: 0.90652
Valid Accuracy: 0.63094
time stamp: 341.4332127571106
[tensor([2.3067, 2.3067, 2.3067, 2.3067], device='cuda:0',
       grad_fn=<GatherBackward>), tensor([2.6360, 2.6360, 2.6360, 2.6360], device='cuda:0',
       grad_fn=<GatherBackward>), tensor([2.7542, 2.7542, 2.7542, 2.7542], device='cuda:0',
       grad_fn=<GatherBackward>), tensor([2.3629, 2.3629, 2.3629, 2.3629], device='cuda:0',
       grad_fn=<GatherBackward>)]
best model saved: step =  999 dev accu =  tensor(0.6359, device='cuda:0')

Validation Results
Global Steps: 999
Valid Loss: 0.90164
Valid Accuracy: 0.63595
time stamp: 426.8765823841095
module.model.transformer_0.mha.pattern saved
module.model.transformer_1.mha.pattern saved
module.model.transformer_2.mha.pattern saved
module.model.transformer_3.mha.pattern saved
./pickle/lra-news1/module.model.transformer_0.mha.pattern.pickle
tensor([ 660,  792,  627,  231,  759,  528,   33,  924,  264,  462,   99,  858,
         693,   66,  363,  429,  726,  297,  825,  891,  561,  495,  330,  396,
         957,  594,  990,  198, 1023,    0,  165,  764,  919,  243,  615,   35,
          97,  132,   58,  833,  666,  852,  499,  623,  694,  725,  373,  683,
         120,  771,  468,  654,   52,  641,  115,  611,  827,  889,  476,  910,
         631], device='cuda:0')
tensor(61, device='cuda:0')
block_attn_mask compile
./pickle/lra-news1/module.model.transformer_1.mha.pattern.pickle
tensor([ 891,  297,  495,  627,  132,  924,  396,  693,    0,  429,  561,  990,
         759,  825,   33,  231,   99,  330,  858,  726,  660,  303,  489,  264,
         165,   47,  481,  792,  462,  629,  691,  155,  868,  528, 1023,   66,
         363,  594,  565,  689,  507,  879,  154,  836,  957,   59,  865,  763,
         887,  305,  553,  563,  625,  497,  559,  309,  681,  892,  923,  151,
         740], device='cuda:0')
tensor(61, device='cuda:0')
block_attn_mask compile
./pickle/lra-news1/module.model.transformer_2.mha.pattern.pickle
tensor([858, 660, 594, 231, 429, 495, 330, 726,  66, 528, 165, 132, 891, 462,
        990, 825, 561,  99, 396, 957, 627, 264, 792, 759, 297,   0, 198,  33,
        730, 854, 363, 667, 884, 338, 586, 242, 583, 182, 709, 924, 731, 886,
        246, 711, 404, 652, 662, 724, 347, 874, 434, 589, 167, 229, 175, 485,
        498, 591, 693, 603, 882], device='cuda:0')
tensor(61, device='cuda:0')
block_attn_mask compile
./pickle/lra-news1/module.model.transformer_3.mha.pattern.pickle
tensor([ 660,   66,  528,  165,  990,  726,  594,  759,  363,   99,  396,  924,
         132,  957,   33,  792,  627, 1023,  495,  231,  462,  330,    0,  858,
         561,  891,  198,  693,  297,  429,  150,  708,  264,  596,  658,  370,
         587,  372,  651,  534,  720,  114,  579,  604,  914,   80,  514,   67,
          98,   86,  706,   94,  962,  382,  971,   51,  609,   58,  833,   50,
         577], device='cuda:0')
tensor(61, device='cuda:0')
block_attn_mask compile
total pattern searching time (s): 0.11562228202819824
[]

Validation Results
Global Steps: 1199
Valid Loss: 0.95072
Valid Accuracy: 0.61190
time stamp: 464.09275817871094
[]

Validation Results
Global Steps: 1399
Valid Loss: 0.89537
Valid Accuracy: 0.63310
time stamp: 500.72357201576233
[]
best model saved: step =  1599 dev accu =  tensor(0.6376, device='cuda:0')

Validation Results
Global Steps: 1599
Valid Loss: 0.90358
Valid Accuracy: 0.63756
time stamp: 537.9410490989685
[]
best model saved: step =  1799 dev accu =  tensor(0.6453, device='cuda:0')

Validation Results
Global Steps: 1799
Valid Loss: 0.87605
Valid Accuracy: 0.64530
time stamp: 574.7963130474091
[]

Validation Results
Global Steps: 1999
Valid Loss: 0.87897
Valid Accuracy: 0.64059
time stamp: 611.6332719326019
[]
best model saved: step =  2199 dev accu =  tensor(0.6545, device='cuda:0')

Validation Results
Global Steps: 2199
Valid Loss: 0.86313
Valid Accuracy: 0.65445
time stamp: 648.6686780452728
[]
best model saved: step =  2399 dev accu =  tensor(0.6589, device='cuda:0')

Validation Results
Global Steps: 2399
Valid Loss: 0.85916
Valid Accuracy: 0.65886
time stamp: 685.3328611850739
[]
best model saved: step =  2599 dev accu =  tensor(0.6703, device='cuda:0')

Validation Results
Global Steps: 2599
Valid Loss: 0.83838
Valid Accuracy: 0.67034
time stamp: 722.1205406188965
[]

Validation Results
Global Steps: 2799
Valid Loss: 0.82903
Valid Accuracy: 0.66909
time stamp: 759.5623395442963
[]

Validation Results
Global Steps: 2999
Valid Loss: 0.83637
Valid Accuracy: 0.66759
time stamp: 796.6661081314087
[]
best model saved: step =  3199 dev accu =  tensor(0.6737, device='cuda:0')

Validation Results
Global Steps: 3199
Valid Loss: 0.82168
Valid Accuracy: 0.67375
time stamp: 833.7351272106171
[]

Validation Results
Global Steps: 3399
Valid Loss: 0.83796
Valid Accuracy: 0.66552
time stamp: 871.0558049678802
[]
best model saved: step =  3599 dev accu =  tensor(0.6768, device='cuda:0')

Validation Results
Global Steps: 3599
Valid Loss: 0.81992
Valid Accuracy: 0.67685
time stamp: 907.8184852600098
[]

Validation Results
Global Steps: 3799
Valid Loss: 0.81310
Valid Accuracy: 0.67612
time stamp: 944.7899532318115
[]
best model saved: step =  3999 dev accu =  tensor(0.6812, device='cuda:0')

Validation Results
Global Steps: 3999
Valid Loss: 0.80258
Valid Accuracy: 0.68115
time stamp: 981.4466223716736
[]

Validation Results
Global Steps: 4199
Valid Loss: 0.80699
Valid Accuracy: 0.67873
time stamp: 1018.1814403533936
[]

Validation Results
Global Steps: 4399
Valid Loss: 0.81670
Valid Accuracy: 0.68063
time stamp: 1054.970850944519
[]
best model saved: step =  4599 dev accu =  tensor(0.6873, device='cuda:0')

Validation Results
Global Steps: 4599
Valid Loss: 0.79678
Valid Accuracy: 0.68728
time stamp: 1092.050205230713
[]
best model saved: step =  4799 dev accu =  tensor(0.6885, device='cuda:0')

Validation Results
Global Steps: 4799
Valid Loss: 0.80131
Valid Accuracy: 0.68854
time stamp: 1129.217868089676
[]
best model saved: step =  4999 dev accu =  tensor(0.6912, device='cuda:0')

Validation Results
Global Steps: 4999
Valid Loss: 0.78945
Valid Accuracy: 0.69119
time stamp: 1166.0240952968597
[]

Validation Results
Global Steps: 5199
Valid Loss: 0.79460
Valid Accuracy: 0.68851
time stamp: 1203.0840039253235
[]
best model saved: step =  5399 dev accu =  tensor(0.7000, device='cuda:0')

Validation Results
Global Steps: 5399
Valid Loss: 0.77600
Valid Accuracy: 0.70004
time stamp: 1240.2944457530975
[]
best model saved: step =  5599 dev accu =  tensor(0.7032, device='cuda:0')

Validation Results
Global Steps: 5599
Valid Loss: 0.77256
Valid Accuracy: 0.70316
time stamp: 1277.3079285621643
[]

Validation Results
Global Steps: 5799
Valid Loss: 0.77187
Valid Accuracy: 0.69884
time stamp: 1314.1783952713013
[]
best model saved: step =  5999 dev accu =  tensor(0.7068, device='cuda:0')

Validation Results
Global Steps: 5999
Valid Loss: 0.75663
Valid Accuracy: 0.70681
time stamp: 1351.5864713191986
[]

Validation Results
Global Steps: 6199
Valid Loss: 0.77902
Valid Accuracy: 0.70242
time stamp: 1387.982078552246
[]

Validation Results
Global Steps: 6399
Valid Loss: 0.78581
Valid Accuracy: 0.70018
time stamp: 1424.9407608509064
[]

Validation Results
Global Steps: 6599
Valid Loss: 0.76101
Valid Accuracy: 0.70371
time stamp: 1461.6423704624176
[]
best model saved: step =  6799 dev accu =  tensor(0.7075, device='cuda:0')

Validation Results
Global Steps: 6799
Valid Loss: 0.76795
Valid Accuracy: 0.70747
time stamp: 1498.6839241981506
[]
best model saved: step =  6999 dev accu =  tensor(0.7083, device='cuda:0')

Validation Results
Global Steps: 6999
Valid Loss: 0.76166
Valid Accuracy: 0.70825
time stamp: 1535.7679767608643
[]
best model saved: step =  7199 dev accu =  tensor(0.7111, device='cuda:0')

Validation Results
Global Steps: 7199
Valid Loss: 0.74966
Valid Accuracy: 0.71113
time stamp: 1572.775493144989
[]
best model saved: step =  7399 dev accu =  tensor(0.7132, device='cuda:0')

Validation Results
Global Steps: 7399
Valid Loss: 0.75959
Valid Accuracy: 0.71324
time stamp: 1609.6638493537903
[]

Validation Results
Global Steps: 7599
Valid Loss: 0.75880
Valid Accuracy: 0.71180
time stamp: 1646.8282828330994
[]

Validation Results
Global Steps: 7799
Valid Loss: 0.74714
Valid Accuracy: 0.71291
time stamp: 1684.1218872070312
[]
best model saved: step =  7999 dev accu =  tensor(0.7153, device='cuda:0')

Validation Results
Global Steps: 7999
Valid Loss: 0.75783
Valid Accuracy: 0.71526
time stamp: 1721.4561638832092
[]
best model saved: step =  8199 dev accu =  tensor(0.7161, device='cuda:0')

Validation Results
Global Steps: 8199
Valid Loss: 0.74195
Valid Accuracy: 0.71606
time stamp: 1758.5053405761719
[]

Validation Results
Global Steps: 8399
Valid Loss: 0.75524
Valid Accuracy: 0.71381
time stamp: 1794.974879026413
[]
best model saved: step =  8599 dev accu =  tensor(0.7176, device='cuda:0')

Validation Results
Global Steps: 8599
Valid Loss: 0.73874
Valid Accuracy: 0.71757
time stamp: 1832.2177639007568
[]

Validation Results
Global Steps: 8799
Valid Loss: 0.77124
Valid Accuracy: 0.71059
time stamp: 1869.0672090053558
[]
best model saved: step =  8999 dev accu =  tensor(0.7215, device='cuda:0')

Validation Results
Global Steps: 8999
Valid Loss: 0.74812
Valid Accuracy: 0.72147
time stamp: 1906.49383020401
[]

Validation Results
Global Steps: 9199
Valid Loss: 0.74837
Valid Accuracy: 0.71980
time stamp: 1943.6983087062836
[]

Validation Results
Global Steps: 9399
Valid Loss: 0.74692
Valid Accuracy: 0.71675
time stamp: 1980.6245393753052
[]

Validation Results
Global Steps: 9599
Valid Loss: 0.75389
Valid Accuracy: 0.71856
time stamp: 2017.8162491321564
[]

Validation Results
Global Steps: 9799
Valid Loss: 0.74352
Valid Accuracy: 0.71376
time stamp: 2054.855321407318
[]

Validation Results
Global Steps: 9999
Valid Loss: 0.75500
Valid Accuracy: 0.72008
time stamp: 2091.4646334648132
[]
best model saved: step =  10199 dev accu =  tensor(0.7277, device='cuda:0')

Validation Results
Global Steps: 10199
Valid Loss: 0.73509
Valid Accuracy: 0.72767
time stamp: 2128.4241168498993
[]

Validation Results
Global Steps: 10399
Valid Loss: 0.74292
Valid Accuracy: 0.71858
time stamp: 2165.425957918167
[]

Validation Results
Global Steps: 10599
Valid Loss: 0.74832
Valid Accuracy: 0.72225
time stamp: 2202.058648586273
[]

Validation Results
Global Steps: 10799
Valid Loss: 0.73837
Valid Accuracy: 0.72312
time stamp: 2239.1824839115143
[]

Validation Results
Global Steps: 10999
Valid Loss: 0.72028
Valid Accuracy: 0.72648
time stamp: 2276.2109076976776
[]

Validation Results
Global Steps: 11199
Valid Loss: 0.72641
Valid Accuracy: 0.72650
time stamp: 2313.68403840065
[]

Validation Results
Global Steps: 11399
Valid Loss: 0.73976
Valid Accuracy: 0.72591
time stamp: 2350.9839930534363
[]

Validation Results
Global Steps: 11599
Valid Loss: 0.74791
Valid Accuracy: 0.72694
time stamp: 2388.1860349178314
[]

Validation Results
Global Steps: 11799
Valid Loss: 0.73485
Valid Accuracy: 0.72341
time stamp: 2424.884390592575
[]
best model saved: step =  11999 dev accu =  tensor(0.7323, device='cuda:0')

Validation Results
Global Steps: 11999
Valid Loss: 0.73658
Valid Accuracy: 0.73231
time stamp: 2461.9303538799286
[]

Validation Results
Global Steps: 12199
Valid Loss: 0.73846
Valid Accuracy: 0.72768
time stamp: 2498.867432117462
[]
best model saved: step =  12399 dev accu =  tensor(0.7328, device='cuda:0')

Validation Results
Global Steps: 12399
Valid Loss: 0.72146
Valid Accuracy: 0.73280
time stamp: 2535.7717905044556
[]

Validation Results
Global Steps: 12599
Valid Loss: 0.73010
Valid Accuracy: 0.73224
time stamp: 2572.615820169449
[]
best model saved: step =  12799 dev accu =  tensor(0.7360, device='cuda:0')

Validation Results
Global Steps: 12799
Valid Loss: 0.71588
Valid Accuracy: 0.73604
time stamp: 2609.399161338806
[]

Validation Results
Global Steps: 12999
Valid Loss: 0.71686
Valid Accuracy: 0.73415
time stamp: 2646.4382271766663
[]

Validation Results
Global Steps: 13199
Valid Loss: 0.72664
Valid Accuracy: 0.72867
time stamp: 2683.7470467090607
[]

Validation Results
Global Steps: 13399
Valid Loss: 0.72951
Valid Accuracy: 0.73493
time stamp: 2720.753960609436
[]
best model saved: step =  13599 dev accu =  tensor(0.7407, device='cuda:0')

Validation Results
Global Steps: 13599
Valid Loss: 0.71638
Valid Accuracy: 0.74072
time stamp: 2757.916326522827
[]

Validation Results
Global Steps: 13799
Valid Loss: 0.72672
Valid Accuracy: 0.73109
time stamp: 2795.2802884578705
[]

Validation Results
Global Steps: 13999
Valid Loss: 0.70927
Valid Accuracy: 0.73461
time stamp: 2832.2950921058655
[]

Validation Results
Global Steps: 14199
Valid Loss: 0.71910
Valid Accuracy: 0.73536
time stamp: 2869.3603925704956
[]

Validation Results
Global Steps: 14399
Valid Loss: 0.71749
Valid Accuracy: 0.73805
time stamp: 2906.3219032287598
[]

Validation Results
Global Steps: 14599
Valid Loss: 0.71373
Valid Accuracy: 0.73983
time stamp: 2943.286171913147
[]
best model saved: step =  14799 dev accu =  tensor(0.7470, device='cuda:0')

Validation Results
Global Steps: 14799
Valid Loss: 0.70809
Valid Accuracy: 0.74701
time stamp: 2980.4742515087128
[]

Validation Results
Global Steps: 14999
Valid Loss: 0.69316
Valid Accuracy: 0.74639
time stamp: 3017.502662420273
[]

Validation Results
Global Steps: 15199
Valid Loss: 0.70626
Valid Accuracy: 0.74462
time stamp: 3054.663340330124
[]

Validation Results
Global Steps: 15399
Valid Loss: 0.69192
Valid Accuracy: 0.74512
time stamp: 3091.7908170223236
[]
best model saved: step =  15599 dev accu =  tensor(0.7484, device='cuda:0')

Validation Results
Global Steps: 15599
Valid Loss: 0.69224
Valid Accuracy: 0.74843
time stamp: 3128.8049671649933
[]

Validation Results
Global Steps: 15799
Valid Loss: 0.72950
Valid Accuracy: 0.73654
time stamp: 3165.70090675354
[]

Validation Results
Global Steps: 15999
Valid Loss: 0.70690
Valid Accuracy: 0.74645
time stamp: 3202.624131679535
[]
best model saved: step =  16199 dev accu =  tensor(0.7485, device='cuda:0')

Validation Results
Global Steps: 16199
Valid Loss: 0.70404
Valid Accuracy: 0.74853
time stamp: 3239.7508404254913
[]
best model saved: step =  16399 dev accu =  tensor(0.7491, device='cuda:0')

Validation Results
Global Steps: 16399
Valid Loss: 0.70619
Valid Accuracy: 0.74911
time stamp: 3276.950433731079
[]

Validation Results
Global Steps: 16599
Valid Loss: 0.71895
Valid Accuracy: 0.74801
time stamp: 3313.4739739894867
[]
best model saved: step =  16799 dev accu =  tensor(0.7542, device='cuda:0')

Validation Results
Global Steps: 16799
Valid Loss: 0.69915
Valid Accuracy: 0.75422
time stamp: 3350.670785665512
[]

Validation Results
Global Steps: 16999
Valid Loss: 0.69302
Valid Accuracy: 0.75160
time stamp: 3387.8446702957153
[]

Validation Results
Global Steps: 17199
Valid Loss: 0.69275
Valid Accuracy: 0.74982
time stamp: 3424.6757357120514
[]
best model saved: step =  17399 dev accu =  tensor(0.7545, device='cuda:0')

Validation Results
Global Steps: 17399
Valid Loss: 0.68486
Valid Accuracy: 0.75453
time stamp: 3461.455540895462
[]

Validation Results
Global Steps: 17599
Valid Loss: 0.70002
Valid Accuracy: 0.75253
time stamp: 3498.469375371933
[]

Validation Results
Global Steps: 17799
Valid Loss: 0.69257
Valid Accuracy: 0.75263
time stamp: 3535.5062568187714
[]
best model saved: step =  17999 dev accu =  tensor(0.7573, device='cuda:0')

Validation Results
Global Steps: 17999
Valid Loss: 0.69119
Valid Accuracy: 0.75729
time stamp: 3572.870930671692
[]

Validation Results
Global Steps: 18199
Valid Loss: 0.67932
Valid Accuracy: 0.75281
time stamp: 3610.212749481201
[]
best model saved: step =  18399 dev accu =  tensor(0.7611, device='cuda:0')

Validation Results
Global Steps: 18399
Valid Loss: 0.67493
Valid Accuracy: 0.76106
time stamp: 3647.5356266498566
[]

Validation Results
Global Steps: 18599
Valid Loss: 0.69198
Valid Accuracy: 0.76036
time stamp: 3684.738114595413
[]

Validation Results
Global Steps: 18799
Valid Loss: 0.68220
Valid Accuracy: 0.75787
time stamp: 3721.4203972816467
[]

Validation Results
Global Steps: 18999
Valid Loss: 0.67250
Valid Accuracy: 0.75770
time stamp: 3758.5350000858307
[]
best model saved: step =  19199 dev accu =  tensor(0.7625, device='cuda:0')

Validation Results
Global Steps: 19199
Valid Loss: 0.67763
Valid Accuracy: 0.76248
time stamp: 3795.861751794815
[]

Validation Results
Global Steps: 19399
Valid Loss: 0.66729
Valid Accuracy: 0.76155
time stamp: 3833.3104844093323
[]
best model saved: step =  19599 dev accu =  tensor(0.7634, device='cuda:0')

Validation Results
Global Steps: 19599
Valid Loss: 0.66937
Valid Accuracy: 0.76338
time stamp: 3870.4428627490997
[]

Validation Results
Global Steps: 19799
Valid Loss: 0.67611
Valid Accuracy: 0.76018
time stamp: 3907.3113000392914
[]

Validation Results
Global Steps: 19999
Valid Loss: 0.68887
Valid Accuracy: 0.76219
time stamp: 3944.439263343811
[]

Validation Results
Global Steps: 20199
Valid Loss: 0.68006
Valid Accuracy: 0.76270
time stamp: 3981.8167090415955
[]
best model saved: step =  20399 dev accu =  tensor(0.7636, device='cuda:0')

Validation Results
Global Steps: 20399
Valid Loss: 0.66574
Valid Accuracy: 0.76356
time stamp: 4018.7243790626526
[]

Validation Results
Global Steps: 20599
Valid Loss: 0.66980
Valid Accuracy: 0.76354
time stamp: 4055.4070520401
[]
best model saved: step =  20799 dev accu =  tensor(0.7676, device='cuda:0')

Validation Results
Global Steps: 20799
Valid Loss: 0.67414
Valid Accuracy: 0.76759
time stamp: 4092.4601876735687
[]

Validation Results
Global Steps: 20999
Valid Loss: 0.67577
Valid Accuracy: 0.76335
time stamp: 4129.435836791992
[]

Validation Results
Global Steps: 21199
Valid Loss: 0.66666
Valid Accuracy: 0.76674
time stamp: 4166.332392454147
[]
best model saved: step =  21399 dev accu =  tensor(0.7684, device='cuda:0')

Validation Results
Global Steps: 21399
Valid Loss: 0.66727
Valid Accuracy: 0.76840
time stamp: 4203.418735980988
[]

Validation Results
Global Steps: 21599
Valid Loss: 0.66852
Valid Accuracy: 0.76543
time stamp: 4240.648775577545
[]

Validation Results
Global Steps: 21799
Valid Loss: 0.66734
Valid Accuracy: 0.76724
time stamp: 4277.432201862335
[]

Validation Results
Global Steps: 21999
Valid Loss: 0.66494
Valid Accuracy: 0.76724
time stamp: 4314.696735858917
[]

Validation Results
Global Steps: 22199
Valid Loss: 0.66420
Valid Accuracy: 0.76790
time stamp: 4351.7638602256775
[]
best model saved: step =  22399 dev accu =  tensor(0.7686, device='cuda:0')

Validation Results
Global Steps: 22399
Valid Loss: 0.66118
Valid Accuracy: 0.76861
time stamp: 4388.808593034744
[]
best model saved: step =  22599 dev accu =  tensor(0.7694, device='cuda:0')

Validation Results
Global Steps: 22599
Valid Loss: 0.65323
Valid Accuracy: 0.76941
time stamp: 4425.781269311905
[]
best model saved: step =  22799 dev accu =  tensor(0.7721, device='cuda:0')

Validation Results
Global Steps: 22799
Valid Loss: 0.65231
Valid Accuracy: 0.77214
time stamp: 4462.879004955292
[]
best model saved: step =  22999 dev accu =  tensor(0.7727, device='cuda:0')

Validation Results
Global Steps: 22999
Valid Loss: 0.66450
Valid Accuracy: 0.77270
time stamp: 4499.9616022109985
[]
best model saved: step =  23199 dev accu =  tensor(0.7762, device='cuda:0')

Validation Results
Global Steps: 23199
Valid Loss: 0.64156
Valid Accuracy: 0.77621
time stamp: 4537.157610654831
[]

Validation Results
Global Steps: 23399
Valid Loss: 0.65988
Valid Accuracy: 0.77185
time stamp: 4573.974791049957
[]

Validation Results
Global Steps: 23599
Valid Loss: 0.65540
Valid Accuracy: 0.77293
time stamp: 4611.12876701355
[]

Validation Results
Global Steps: 23799
Valid Loss: 0.64898
Valid Accuracy: 0.77330
time stamp: 4647.961898803711
[]

Validation Results
Global Steps: 23999
Valid Loss: 0.66806
Valid Accuracy: 0.77232
time stamp: 4685.15451669693
[]

Validation Results
Global Steps: 24199
Valid Loss: 0.65874
Valid Accuracy: 0.76984
time stamp: 4722.05312871933
[]

Validation Results
Global Steps: 24399
Valid Loss: 0.66018
Valid Accuracy: 0.77324
time stamp: 4759.123651742935
[]

Validation Results
Global Steps: 24599
Valid Loss: 0.65491
Valid Accuracy: 0.77346
time stamp: 4795.93933057785
[]

Validation Results
Global Steps: 24799
Valid Loss: 0.65144
Valid Accuracy: 0.77482
time stamp: 4832.75420331955
[]

Validation Results
Global Steps: 24999
Valid Loss: 0.66070
Valid Accuracy: 0.77419
time stamp: 4869.820760250092
[]

Validation Results
Global Steps: 25199
Valid Loss: 0.65112
Valid Accuracy: 0.77398
time stamp: 4906.728210926056
[]

Validation Results
Global Steps: 25399
Valid Loss: 0.65962
Valid Accuracy: 0.77311
time stamp: 4943.97878909111
[]

Validation Results
Global Steps: 25599
Valid Loss: 0.66469
Valid Accuracy: 0.77549
time stamp: 4980.884855031967
[]
best model saved: step =  25799 dev accu =  tensor(0.7784, device='cuda:0')

Validation Results
Global Steps: 25799
Valid Loss: 0.64916
Valid Accuracy: 0.77844
time stamp: 5017.949929237366
[]

Validation Results
Global Steps: 25999
Valid Loss: 0.64858
Valid Accuracy: 0.77659
time stamp: 5055.021955728531
[]

Validation Results
Global Steps: 26199
Valid Loss: 0.65655
Valid Accuracy: 0.77572
time stamp: 5092.007885217667
[]

Validation Results
Global Steps: 26399
Valid Loss: 0.64727
Valid Accuracy: 0.77446
time stamp: 5129.15803861618
[]

Validation Results
Global Steps: 26599
Valid Loss: 0.64744
Valid Accuracy: 0.77377
time stamp: 5166.291397809982
[]

Validation Results
Global Steps: 26799
Valid Loss: 0.65267
Valid Accuracy: 0.77608
time stamp: 5203.1030650138855
[]

Validation Results
Global Steps: 26999
Valid Loss: 0.64416
Valid Accuracy: 0.77608
time stamp: 5240.2219524383545
[]

Validation Results
Global Steps: 27199
Valid Loss: 0.64991
Valid Accuracy: 0.77622
time stamp: 5277.358667612076
[]

Validation Results
Global Steps: 27399
Valid Loss: 0.64967
Valid Accuracy: 0.77701
time stamp: 5314.552930593491
[]

Validation Results
Global Steps: 27599
Valid Loss: 0.65462
Valid Accuracy: 0.77593
time stamp: 5351.901957035065
[]

Validation Results
Global Steps: 27799
Valid Loss: 0.64594
Valid Accuracy: 0.77662
time stamp: 5388.889268398285
[]

Validation Results
Global Steps: 27999
Valid Loss: 0.65324
Valid Accuracy: 0.77720
time stamp: 5425.983848810196
[]

Validation Results
Global Steps: 28199
Valid Loss: 0.64896
Valid Accuracy: 0.77766
time stamp: 5463.345994710922
[]
best model saved: step =  28399 dev accu =  tensor(0.7795, device='cuda:0')

Validation Results
Global Steps: 28399
Valid Loss: 0.64675
Valid Accuracy: 0.77947
time stamp: 5500.080497503281
[]

Validation Results
Global Steps: 28599
Valid Loss: 0.64926
Valid Accuracy: 0.77680
time stamp: 5536.79908156395
[]

Validation Results
Global Steps: 28799
Valid Loss: 0.64569
Valid Accuracy: 0.77839
time stamp: 5573.712514162064
[]

Validation Results
Global Steps: 28999
Valid Loss: 0.64774
Valid Accuracy: 0.77844
time stamp: 5610.614936590195
[]

Validation Results
Global Steps: 29199
Valid Loss: 0.64858
Valid Accuracy: 0.77893
time stamp: 5647.809714794159
[]

Validation Results
Global Steps: 29399
Valid Loss: 0.64654
Valid Accuracy: 0.77864
time stamp: 5684.517754793167
[]

Validation Results
Global Steps: 29599
Valid Loss: 0.64478
Valid Accuracy: 0.77895
time stamp: 5721.539654016495
[]
best model saved: step =  29799 dev accu =  tensor(0.7803, device='cuda:0')

Validation Results
Global Steps: 29799
Valid Loss: 0.64569
Valid Accuracy: 0.78034
time stamp: 5758.4015645980835
[]

Validation Results
Global Steps: 29999
Valid Loss: 0.64507
Valid Accuracy: 0.77999
time stamp: 5795.382518291473
total training step (k): 30.0
total training time (s): 5795.38312625885
total training time (ms): 1551642.5810546875
peak memory usage (MB): 12762
allocated memory usage (MB): 410065561
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |   10094 KB |   12762 MB |  400454 GB |  400454 GB |
|       from large pool |    6144 KB |   12750 MB |  396847 GB |  396847 GB |
|       from small pool |    3950 KB |      27 MB |    3607 GB |    3607 GB |
|---------------------------------------------------------------------------|
| Active memory         |   10094 KB |   12762 MB |  400454 GB |  400454 GB |
|       from large pool |    6144 KB |   12750 MB |  396847 GB |  396847 GB |
|       from small pool |    3950 KB |      27 MB |    3607 GB |    3607 GB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   12848 MB |   12848 MB |   12848 MB |       0 B  |
|       from large pool |   12820 MB |   12820 MB |   12820 MB |       0 B  |
|       from small pool |      28 MB |      28 MB |      28 MB |       0 B  |
|---------------------------------------------------------------------------|
| Non-releasable memory |   14481 KB |    1523 MB |  509904 GB |  509904 GB |
|       from large pool |   10240 KB |    1522 MB |  506178 GB |  506178 GB |
|       from small pool |    4241 KB |       6 MB |    3725 GB |    3725 GB |
|---------------------------------------------------------------------------|
| Allocations           |     246    |     535    |   35706 K  |   35706 K  |
|       from large pool |       2    |      87    |   13488 K  |   13488 K  |
|       from small pool |     244    |     518    |   22218 K  |   22218 K  |
|---------------------------------------------------------------------------|
| Active allocs         |     246    |     535    |   35706 K  |   35706 K  |
|       from large pool |       2    |      87    |   13488 K  |   13488 K  |
|       from small pool |     244    |     518    |   22218 K  |   22218 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      44    |      44    |      44    |       0    |
|       from large pool |      30    |      30    |      30    |       0    |
|       from small pool |      14    |      14    |      14    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |      14    |      34    |   16345 K  |   16345 K  |
|       from large pool |       1    |      15    |    5923 K  |    5923 K  |
|       from small pool |      13    |      24    |   10421 K  |   10421 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

loading the best model from: ./checkpoints/checkpoints-0/lra-news1/density06.model
Evaluation Results
Loss: 0.64331
Accuracy: 0.78125
