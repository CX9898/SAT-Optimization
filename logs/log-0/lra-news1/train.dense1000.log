GPU list: [0, 1, 2, 3]
[
    {
        "learn_pos_emb": true,
        "tied_weights": false,
        "embedding_dim": 64,
        "transformer_dim": 64,
        "transformer_hidden_dim": 128,
        "head_dim": 32,
        "num_head": 2,
        "num_layers": 4,
        "vocab_size": 512,
        "max_seq_len": 1024,
        "dropout_prob": 0.1,
        "attention_dropout": 0.1,
        "pooling_mode": "MEAN",
        "num_classes": 4,
        "block_size": 32,
        "batch_size": 128,
        "density": 0.05,
        "mixed_precision": true,
        "random_seed": 0,
        "task": "lra-news1"
    },
    {
        "batch_size": 512,
        "learning_rate": 0.0007,
        "warmup": 80,
        "lr_decay": "linear",
        "weight_decay": 0,
        "eval_frequency": 200,
        "num_train_steps": 30000,
        "num_init_steps": 3000,
        "num_eval_steps": 200,
        "num_dense_train_steps": 1000,
        "patience": 10,
        "attn_loss_scale": 0.01
    }
]
attn_mask compile
attn_mask compile
attn_mask compile
attn_mask compile
DataParallel(
  (module): ModelForSC(
    (model): Model(
      (embeddings): Embeddings(
        (word_embeddings): Embedding(512, 64)
        (position_embeddings): Embedding(1024, 64)
        (dropout): Dropout(p=0.1, inplace=False)
      )
      (transformer_0): TransformerLayer(
        (norm1): LayerNorm((64,), eps=1e-05, elementwise_affine=True)
        (mha): Attention(
          (W_q): Linear(in_features=64, out_features=64, bias=True)
          (W_k): Linear(in_features=64, out_features=64, bias=True)
          (W_v): Linear(in_features=64, out_features=64, bias=True)
          (avg_pool): AvgPool2d(kernel_size=32, stride=32, padding=0)
          (MSEloss): MSELoss()
          (attn): CUDAMaskAttention()
          (ff): Linear(in_features=64, out_features=64, bias=True)
        )
        (dropout1): Dropout(p=0.1, inplace=False)
        (norm2): LayerNorm((64,), eps=1e-05, elementwise_affine=True)
        (mlpblock): Sequential(
          (0): Linear(in_features=64, out_features=128, bias=True)
          (1): GELU(approximate='none')
          (2): Dropout(p=0.1, inplace=False)
          (3): Linear(in_features=128, out_features=64, bias=True)
          (4): Dropout(p=0.1, inplace=False)
        )
      )
      (transformer_1): TransformerLayer(
        (norm1): LayerNorm((64,), eps=1e-05, elementwise_affine=True)
        (mha): Attention(
          (W_q): Linear(in_features=64, out_features=64, bias=True)
          (W_k): Linear(in_features=64, out_features=64, bias=True)
          (W_v): Linear(in_features=64, out_features=64, bias=True)
          (avg_pool): AvgPool2d(kernel_size=32, stride=32, padding=0)
          (MSEloss): MSELoss()
          (attn): CUDAMaskAttention()
          (ff): Linear(in_features=64, out_features=64, bias=True)
        )
        (dropout1): Dropout(p=0.1, inplace=False)
        (norm2): LayerNorm((64,), eps=1e-05, elementwise_affine=True)
        (mlpblock): Sequential(
          (0): Linear(in_features=64, out_features=128, bias=True)
          (1): GELU(approximate='none')
          (2): Dropout(p=0.1, inplace=False)
          (3): Linear(in_features=128, out_features=64, bias=True)
          (4): Dropout(p=0.1, inplace=False)
        )
      )
      (transformer_2): TransformerLayer(
        (norm1): LayerNorm((64,), eps=1e-05, elementwise_affine=True)
        (mha): Attention(
          (W_q): Linear(in_features=64, out_features=64, bias=True)
          (W_k): Linear(in_features=64, out_features=64, bias=True)
          (W_v): Linear(in_features=64, out_features=64, bias=True)
          (avg_pool): AvgPool2d(kernel_size=32, stride=32, padding=0)
          (MSEloss): MSELoss()
          (attn): CUDAMaskAttention()
          (ff): Linear(in_features=64, out_features=64, bias=True)
        )
        (dropout1): Dropout(p=0.1, inplace=False)
        (norm2): LayerNorm((64,), eps=1e-05, elementwise_affine=True)
        (mlpblock): Sequential(
          (0): Linear(in_features=64, out_features=128, bias=True)
          (1): GELU(approximate='none')
          (2): Dropout(p=0.1, inplace=False)
          (3): Linear(in_features=128, out_features=64, bias=True)
          (4): Dropout(p=0.1, inplace=False)
        )
      )
      (transformer_3): TransformerLayer(
        (norm1): LayerNorm((64,), eps=1e-05, elementwise_affine=True)
        (mha): Attention(
          (W_q): Linear(in_features=64, out_features=64, bias=True)
          (W_k): Linear(in_features=64, out_features=64, bias=True)
          (W_v): Linear(in_features=64, out_features=64, bias=True)
          (avg_pool): AvgPool2d(kernel_size=32, stride=32, padding=0)
          (MSEloss): MSELoss()
          (attn): CUDAMaskAttention()
          (ff): Linear(in_features=64, out_features=64, bias=True)
        )
        (dropout1): Dropout(p=0.1, inplace=False)
        (norm2): LayerNorm((64,), eps=1e-05, elementwise_affine=True)
        (mlpblock): Sequential(
          (0): Linear(in_features=64, out_features=128, bias=True)
          (1): GELU(approximate='none')
          (2): Dropout(p=0.1, inplace=False)
          (3): Linear(in_features=128, out_features=64, bias=True)
          (4): Dropout(p=0.1, inplace=False)
        )
      )
      (norm): LayerNorm((64,), eps=1e-05, elementwise_affine=True)
    )
    (seq_classifer): SCHead(
      (mlpblock): Sequential(
        (0): Linear(in_features=64, out_features=128, bias=True)
        (1): ReLU()
        (2): Linear(in_features=128, out_features=4, bias=True)
      )
    )
  )
)
parameter_size: [torch.Size([512, 64]), torch.Size([1024, 64]), torch.Size([64]), torch.Size([64]), torch.Size([32, 32]), torch.Size([64, 64]), torch.Size([64]), torch.Size([64, 64]), torch.Size([64]), torch.Size([64, 64]), torch.Size([64]), torch.Size([64, 64]), torch.Size([64]), torch.Size([64]), torch.Size([64]), torch.Size([128, 64]), torch.Size([128]), torch.Size([64, 128]), torch.Size([64]), torch.Size([64]), torch.Size([64]), torch.Size([32, 32]), torch.Size([64, 64]), torch.Size([64]), torch.Size([64, 64]), torch.Size([64]), torch.Size([64, 64]), torch.Size([64]), torch.Size([64, 64]), torch.Size([64]), torch.Size([64]), torch.Size([64]), torch.Size([128, 64]), torch.Size([128]), torch.Size([64, 128]), torch.Size([64]), torch.Size([64]), torch.Size([64]), torch.Size([32, 32]), torch.Size([64, 64]), torch.Size([64]), torch.Size([64, 64]), torch.Size([64]), torch.Size([64, 64]), torch.Size([64]), torch.Size([64, 64]), torch.Size([64]), torch.Size([64]), torch.Size([64]), torch.Size([128, 64]), torch.Size([128]), torch.Size([64, 128]), torch.Size([64]), torch.Size([64]), torch.Size([64]), torch.Size([32, 32]), torch.Size([64, 64]), torch.Size([64]), torch.Size([64, 64]), torch.Size([64]), torch.Size([64, 64]), torch.Size([64]), torch.Size([64, 64]), torch.Size([64]), torch.Size([64]), torch.Size([64]), torch.Size([128, 64]), torch.Size([128]), torch.Size([64, 128]), torch.Size([64]), torch.Size([64]), torch.Size([64]), torch.Size([128, 64]), torch.Size([128]), torch.Size([4, 128]), torch.Size([4])]
num_parameter: 245252
Loaded ../Skyformer/data/lra_processed/lra-news1.train.pickle... size=120000
Loaded ../Skyformer/data/lra_processed/lra-news1.dev.pickle... size=7600
Loaded ../Skyformer/data/lra_processed/lra-news1.test.pickle... size=7600
accumu_steps=1
[tensor([30.1570, 30.1570, 30.1570, 30.1570], device='cuda:0',
       grad_fn=<GatherBackward>), tensor([33.4075, 33.4075, 33.4075, 33.4075], device='cuda:0',
       grad_fn=<GatherBackward>), tensor([34.9609, 34.9609, 34.9609, 34.9608], device='cuda:0',
       grad_fn=<GatherBackward>), tensor([30.8442, 30.8442, 30.8442, 30.8443], device='cuda:0',
       grad_fn=<GatherBackward>)]
best model saved: step =  199 dev accu =  tensor(0.5913, device='cuda:0')

Validation Results
Global Steps: 199
Valid Loss: 1.00380
Valid Accuracy: 0.59134
time stamp: 87.17176413536072
[tensor([13.0929, 13.0929, 13.0929, 13.0929], device='cuda:0',
       grad_fn=<GatherBackward>), tensor([14.7288, 14.7288, 14.7288, 14.7288], device='cuda:0',
       grad_fn=<GatherBackward>), tensor([15.4773, 15.4773, 15.4773, 15.4773], device='cuda:0',
       grad_fn=<GatherBackward>), tensor([13.4487, 13.4487, 13.4487, 13.4487], device='cuda:0',
       grad_fn=<GatherBackward>)]
best model saved: step =  399 dev accu =  tensor(0.6197, device='cuda:0')

Validation Results
Global Steps: 399
Valid Loss: 0.94300
Valid Accuracy: 0.61972
time stamp: 172.03800535202026
[tensor([6.5830, 6.5830, 6.5830, 6.5830], device='cuda:0',
       grad_fn=<GatherBackward>), tensor([7.4768, 7.4768, 7.4768, 7.4768], device='cuda:0',
       grad_fn=<GatherBackward>), tensor([7.8610, 7.8610, 7.8610, 7.8610], device='cuda:0',
       grad_fn=<GatherBackward>), tensor([6.7726, 6.7726, 6.7726, 6.7726], device='cuda:0',
       grad_fn=<GatherBackward>)]

Validation Results
Global Steps: 599
Valid Loss: 0.94433
Valid Accuracy: 0.61688
time stamp: 257.0918447971344
[tensor([3.7193, 3.7193, 3.7193, 3.7193], device='cuda:0',
       grad_fn=<GatherBackward>), tensor([4.2451, 4.2451, 4.2451, 4.2451], device='cuda:0',
       grad_fn=<GatherBackward>), tensor([4.4534, 4.4534, 4.4534, 4.4534], device='cuda:0',
       grad_fn=<GatherBackward>), tensor([3.8224, 3.8224, 3.8224, 3.8224], device='cuda:0',
       grad_fn=<GatherBackward>)]
best model saved: step =  799 dev accu =  tensor(0.6309, device='cuda:0')

Validation Results
Global Steps: 799
Valid Loss: 0.90652
Valid Accuracy: 0.63094
time stamp: 343.34433913230896
[tensor([2.3067, 2.3067, 2.3067, 2.3067], device='cuda:0',
       grad_fn=<GatherBackward>), tensor([2.6360, 2.6360, 2.6360, 2.6360], device='cuda:0',
       grad_fn=<GatherBackward>), tensor([2.7542, 2.7542, 2.7542, 2.7542], device='cuda:0',
       grad_fn=<GatherBackward>), tensor([2.3629, 2.3629, 2.3629, 2.3629], device='cuda:0',
       grad_fn=<GatherBackward>)]
best model saved: step =  999 dev accu =  tensor(0.6359, device='cuda:0')

Validation Results
Global Steps: 999
Valid Loss: 0.90164
Valid Accuracy: 0.63595
time stamp: 429.0949637889862
module.model.transformer_0.mha.pattern saved
module.model.transformer_1.mha.pattern saved
module.model.transformer_2.mha.pattern saved
module.model.transformer_3.mha.pattern saved
./pickle/lra-news1/module.model.transformer_0.mha.pattern.pickle
tensor([ 660,  792,  627,  231,  759,  528,   33,  924,  264,  462,   99,  858,
         693,   66,  363,  429,  726,  297,  825,  891,  561,  495,  330,  396,
         957,  594,  990,  198, 1023,    0,  165,  764,  919,  243,  615,   35,
          97,  132,   58,  833,  666,  852,  499,  623,  694,  725,  373,  683,
         120,  771,  468], device='cuda:0')
tensor(51, device='cuda:0')
block_attn_mask compile
./pickle/lra-news1/module.model.transformer_1.mha.pattern.pickle
tensor([ 891,  297,  495,  627,  132,  924,  396,  693,    0,  429,  561,  990,
         759,  825,   33,  231,   99,  330,  858,  726,  660,  303,  489,  264,
         165,   47,  481,  792,  462,  629,  691,  155,  868,  528, 1023,   66,
         363,  594,  565,  689,  507,  879,  154,  836,  957,   59,  865,  763,
         887,  305,  553], device='cuda:0')
tensor(51, device='cuda:0')
block_attn_mask compile
./pickle/lra-news1/module.model.transformer_2.mha.pattern.pickle
tensor([858, 660, 594, 231, 429, 495, 330, 726,  66, 528, 165, 132, 891, 462,
        990, 825, 561,  99, 396, 957, 627, 264, 792, 759, 297,   0, 198,  33,
        730, 854, 363, 667, 884, 338, 586, 242, 583, 182, 709, 924, 731, 886,
        246, 711, 404, 652, 662, 724, 347, 874, 434], device='cuda:0')
tensor(51, device='cuda:0')
block_attn_mask compile
./pickle/lra-news1/module.model.transformer_3.mha.pattern.pickle
tensor([ 660,   66,  528,  165,  990,  726,  594,  759,  363,   99,  396,  924,
         132,  957,   33,  792,  627, 1023,  495,  231,  462,  330,    0,  858,
         561,  891,  198,  693,  297,  429,  150,  708,  264,  596,  658,  370,
         587,  372,  651,  534,  720,  114,  579,  604,  914,   80,  514,   67,
          98,   86,  706], device='cuda:0')
tensor(51, device='cuda:0')
block_attn_mask compile
total pattern searching time (s): 0.12223291397094727
[]

Validation Results
Global Steps: 1199
Valid Loss: 0.94792
Valid Accuracy: 0.61279
time stamp: 464.3993937969208
[]

Validation Results
Global Steps: 1399
Valid Loss: 0.89489
Valid Accuracy: 0.63487
time stamp: 499.4386429786682
[]
best model saved: step =  1599 dev accu =  tensor(0.6375, device='cuda:0')

Validation Results
Global Steps: 1599
Valid Loss: 0.90198
Valid Accuracy: 0.63749
time stamp: 534.6161053180695
[]
best model saved: step =  1799 dev accu =  tensor(0.6423, device='cuda:0')

Validation Results
Global Steps: 1799
Valid Loss: 0.87849
Valid Accuracy: 0.64228
time stamp: 569.2145659923553
[]
best model saved: step =  1999 dev accu =  tensor(0.6446, device='cuda:0')

Validation Results
Global Steps: 1999
Valid Loss: 0.87868
Valid Accuracy: 0.64462
time stamp: 604.4289426803589
[]
best model saved: step =  2199 dev accu =  tensor(0.6521, device='cuda:0')

Validation Results
Global Steps: 2199
Valid Loss: 0.85964
Valid Accuracy: 0.65215
time stamp: 639.7255854606628
[]
best model saved: step =  2399 dev accu =  tensor(0.6585, device='cuda:0')

Validation Results
Global Steps: 2399
Valid Loss: 0.85648
Valid Accuracy: 0.65854
time stamp: 674.9758992195129
[]
best model saved: step =  2599 dev accu =  tensor(0.6718, device='cuda:0')

Validation Results
Global Steps: 2599
Valid Loss: 0.83688
Valid Accuracy: 0.67184
time stamp: 709.5951995849609
[]

Validation Results
Global Steps: 2799
Valid Loss: 0.83286
Valid Accuracy: 0.66820
time stamp: 744.5936079025269
[]

Validation Results
Global Steps: 2999
Valid Loss: 0.83965
Valid Accuracy: 0.66670
time stamp: 779.9497833251953
[]
best model saved: step =  3199 dev accu =  tensor(0.6719, device='cuda:0')

Validation Results
Global Steps: 3199
Valid Loss: 0.82161
Valid Accuracy: 0.67188
time stamp: 814.8163681030273
[]

Validation Results
Global Steps: 3399
Valid Loss: 0.83778
Valid Accuracy: 0.66688
time stamp: 849.7358555793762
[]

Validation Results
Global Steps: 3599
Valid Loss: 0.82765
Valid Accuracy: 0.67007
time stamp: 884.5781357288361
[]
best model saved: step =  3799 dev accu =  tensor(0.6753, device='cuda:0')

Validation Results
Global Steps: 3799
Valid Loss: 0.81150
Valid Accuracy: 0.67531
time stamp: 919.2050294876099
[]
best model saved: step =  3999 dev accu =  tensor(0.6845, device='cuda:0')

Validation Results
Global Steps: 3999
Valid Loss: 0.80638
Valid Accuracy: 0.68449
time stamp: 954.3887479305267
[]

Validation Results
Global Steps: 4199
Valid Loss: 0.80820
Valid Accuracy: 0.67862
time stamp: 989.4535095691681
[]

Validation Results
Global Steps: 4399
Valid Loss: 0.81339
Valid Accuracy: 0.68378
time stamp: 1024.6743412017822
[]
best model saved: step =  4599 dev accu =  tensor(0.6856, device='cuda:0')

Validation Results
Global Steps: 4599
Valid Loss: 0.79890
Valid Accuracy: 0.68556
time stamp: 1059.5427811145782
[]

Validation Results
Global Steps: 4799
Valid Loss: 0.80132
Valid Accuracy: 0.68330
time stamp: 1094.7709126472473
[]
best model saved: step =  4999 dev accu =  tensor(0.6912, device='cuda:0')

Validation Results
Global Steps: 4999
Valid Loss: 0.79117
Valid Accuracy: 0.69120
time stamp: 1129.9066228866577
[]

Validation Results
Global Steps: 5199
Valid Loss: 0.80220
Valid Accuracy: 0.68878
time stamp: 1164.642967224121
[]
best model saved: step =  5399 dev accu =  tensor(0.7000, device='cuda:0')

Validation Results
Global Steps: 5399
Valid Loss: 0.78369
Valid Accuracy: 0.69995
time stamp: 1199.2506964206696
[]
best model saved: step =  5599 dev accu =  tensor(0.7022, device='cuda:0')

Validation Results
Global Steps: 5599
Valid Loss: 0.77930
Valid Accuracy: 0.70217
time stamp: 1234.547812461853
[]

Validation Results
Global Steps: 5799
Valid Loss: 0.77813
Valid Accuracy: 0.69771
time stamp: 1269.8713047504425
[]

Validation Results
Global Steps: 5999
Valid Loss: 0.76561
Valid Accuracy: 0.70216
time stamp: 1304.5928797721863
[]
best model saved: step =  6199 dev accu =  tensor(0.7027, device='cuda:0')

Validation Results
Global Steps: 6199
Valid Loss: 0.78002
Valid Accuracy: 0.70266
time stamp: 1339.5030813217163
[]

Validation Results
Global Steps: 6399
Valid Loss: 0.79779
Valid Accuracy: 0.69507
time stamp: 1374.674245595932
[]

Validation Results
Global Steps: 6599
Valid Loss: 0.77507
Valid Accuracy: 0.69859
time stamp: 1409.691267490387
[]
best model saved: step =  6799 dev accu =  tensor(0.7035, device='cuda:0')

Validation Results
Global Steps: 6799
Valid Loss: 0.76978
Valid Accuracy: 0.70354
time stamp: 1444.9398019313812
[]

Validation Results
Global Steps: 6999
Valid Loss: 0.77038
Valid Accuracy: 0.70292
time stamp: 1480.224835395813
[]
best model saved: step =  7199 dev accu =  tensor(0.7113, device='cuda:0')

Validation Results
Global Steps: 7199
Valid Loss: 0.75346
Valid Accuracy: 0.71129
time stamp: 1515.55801820755
[]

Validation Results
Global Steps: 7399
Valid Loss: 0.76268
Valid Accuracy: 0.70553
time stamp: 1550.6612405776978
[]

Validation Results
Global Steps: 7599
Valid Loss: 0.76527
Valid Accuracy: 0.71077
time stamp: 1585.8596591949463
[]

Validation Results
Global Steps: 7799
Valid Loss: 0.75563
Valid Accuracy: 0.70855
time stamp: 1621.0005822181702
[]

Validation Results
Global Steps: 7999
Valid Loss: 0.77099
Valid Accuracy: 0.70673
time stamp: 1655.3187866210938
[]

Validation Results
Global Steps: 8199
Valid Loss: 0.75336
Valid Accuracy: 0.70768
time stamp: 1690.0428223609924
[]

Validation Results
Global Steps: 8399
Valid Loss: 0.76397
Valid Accuracy: 0.70930
time stamp: 1724.807918548584
[]
best model saved: step =  8599 dev accu =  tensor(0.7194, device='cuda:0')

Validation Results
Global Steps: 8599
Valid Loss: 0.73711
Valid Accuracy: 0.71937
time stamp: 1759.5277111530304
[]

Validation Results
Global Steps: 8799
Valid Loss: 0.75634
Valid Accuracy: 0.71486
time stamp: 1794.4159443378448
[]

Validation Results
Global Steps: 8999
Valid Loss: 0.75655
Valid Accuracy: 0.71572
time stamp: 1829.2356350421906
[]

Validation Results
Global Steps: 9199
Valid Loss: 0.75070
Valid Accuracy: 0.71618
time stamp: 1863.8239195346832
[]

Validation Results
Global Steps: 9399
Valid Loss: 0.74470
Valid Accuracy: 0.71604
time stamp: 1898.435747385025
[]

Validation Results
Global Steps: 9599
Valid Loss: 0.74672
Valid Accuracy: 0.71538
time stamp: 1933.4976515769958
[]

Validation Results
Global Steps: 9799
Valid Loss: 0.74238
Valid Accuracy: 0.71695
time stamp: 1968.3186857700348
[]
best model saved: step =  9999 dev accu =  tensor(0.7215, device='cuda:0')

Validation Results
Global Steps: 9999
Valid Loss: 0.75173
Valid Accuracy: 0.72149
time stamp: 2003.1433317661285
[]
best model saved: step =  10199 dev accu =  tensor(0.7244, device='cuda:0')

Validation Results
Global Steps: 10199
Valid Loss: 0.73736
Valid Accuracy: 0.72439
time stamp: 2037.7473847866058
[]

Validation Results
Global Steps: 10399
Valid Loss: 0.74287
Valid Accuracy: 0.72335
time stamp: 2073.096783399582
[]
best model saved: step =  10599 dev accu =  tensor(0.7276, device='cuda:0')

Validation Results
Global Steps: 10599
Valid Loss: 0.73612
Valid Accuracy: 0.72760
time stamp: 2108.3530700206757
[]

Validation Results
Global Steps: 10799
Valid Loss: 0.74424
Valid Accuracy: 0.72249
time stamp: 2143.8323607444763
[]

Validation Results
Global Steps: 10999
Valid Loss: 0.73054
Valid Accuracy: 0.72533
time stamp: 2179.149482727051
[]
best model saved: step =  11199 dev accu =  tensor(0.7280, device='cuda:0')

Validation Results
Global Steps: 11199
Valid Loss: 0.72361
Valid Accuracy: 0.72802
time stamp: 2214.3368089199066
[]

Validation Results
Global Steps: 11399
Valid Loss: 0.72803
Valid Accuracy: 0.72562
time stamp: 2249.548607826233
[]

Validation Results
Global Steps: 11599
Valid Loss: 0.75330
Valid Accuracy: 0.72513
time stamp: 2285.059162378311
[]

Validation Results
Global Steps: 11799
Valid Loss: 0.73480
Valid Accuracy: 0.72625
time stamp: 2319.965476036072
[]
best model saved: step =  11999 dev accu =  tensor(0.7336, device='cuda:0')

Validation Results
Global Steps: 11999
Valid Loss: 0.73134
Valid Accuracy: 0.73358
time stamp: 2354.7458555698395
[]

Validation Results
Global Steps: 12199
Valid Loss: 0.74293
Valid Accuracy: 0.72681
time stamp: 2389.740599632263
[]
best model saved: step =  12399 dev accu =  tensor(0.7371, device='cuda:0')

Validation Results
Global Steps: 12399
Valid Loss: 0.71767
Valid Accuracy: 0.73712
time stamp: 2424.656448841095
[]

Validation Results
Global Steps: 12599
Valid Loss: 0.74089
Valid Accuracy: 0.73153
time stamp: 2459.6555638313293
[]
best model saved: step =  12799 dev accu =  tensor(0.7377, device='cuda:0')

Validation Results
Global Steps: 12799
Valid Loss: 0.70425
Valid Accuracy: 0.73766
time stamp: 2494.486819267273
[]

Validation Results
Global Steps: 12999
Valid Loss: 0.72496
Valid Accuracy: 0.73276
time stamp: 2529.9104652404785
[]

Validation Results
Global Steps: 13199
Valid Loss: 0.71758
Valid Accuracy: 0.73457
time stamp: 2564.600400686264
[]
best model saved: step =  13399 dev accu =  tensor(0.7386, device='cuda:0')

Validation Results
Global Steps: 13399
Valid Loss: 0.71927
Valid Accuracy: 0.73864
time stamp: 2599.631954431534
[]
best model saved: step =  13599 dev accu =  tensor(0.7422, device='cuda:0')

Validation Results
Global Steps: 13599
Valid Loss: 0.72429
Valid Accuracy: 0.74217
time stamp: 2634.4388246536255
[]

Validation Results
Global Steps: 13799
Valid Loss: 0.72535
Valid Accuracy: 0.73603
time stamp: 2669.354501247406
[]

Validation Results
Global Steps: 13999
Valid Loss: 0.70493
Valid Accuracy: 0.73844
time stamp: 2703.9821767807007
[]

Validation Results
Global Steps: 14199
Valid Loss: 0.70702
Valid Accuracy: 0.73924
time stamp: 2738.8897545337677
[]
best model saved: step =  14399 dev accu =  tensor(0.7430, device='cuda:0')

Validation Results
Global Steps: 14399
Valid Loss: 0.70665
Valid Accuracy: 0.74298
time stamp: 2773.7416837215424
[]
best model saved: step =  14599 dev accu =  tensor(0.7447, device='cuda:0')

Validation Results
Global Steps: 14599
Valid Loss: 0.70500
Valid Accuracy: 0.74470
time stamp: 2824.609620809555
[]
best model saved: step =  14799 dev accu =  tensor(0.7448, device='cuda:0')

Validation Results
Global Steps: 14799
Valid Loss: 0.69775
Valid Accuracy: 0.74482
time stamp: 2895.049586057663
[]

Validation Results
Global Steps: 14999
Valid Loss: 0.69116
Valid Accuracy: 0.74373
time stamp: 2965.5652141571045
[]

Validation Results
Global Steps: 15199
Valid Loss: 0.70581
Valid Accuracy: 0.74383
time stamp: 3036.899544239044
[]
best model saved: step =  15399 dev accu =  tensor(0.7485, device='cuda:0')

Validation Results
Global Steps: 15399
Valid Loss: 0.67833
Valid Accuracy: 0.74851
time stamp: 3091.240619659424
[]
best model saved: step =  15599 dev accu =  tensor(0.7507, device='cuda:0')

Validation Results
Global Steps: 15599
Valid Loss: 0.67079
Valid Accuracy: 0.75073
time stamp: 3126.687786579132
[]

Validation Results
Global Steps: 15799
Valid Loss: 0.70875
Valid Accuracy: 0.74752
time stamp: 3161.304095029831
[]

Validation Results
Global Steps: 15999
Valid Loss: 0.69650
Valid Accuracy: 0.74674
time stamp: 3195.972709417343
[]
best model saved: step =  16199 dev accu =  tensor(0.7517, device='cuda:0')

Validation Results
Global Steps: 16199
Valid Loss: 0.68387
Valid Accuracy: 0.75172
time stamp: 3230.731790781021
[]

Validation Results
Global Steps: 16399
Valid Loss: 0.68806
Valid Accuracy: 0.74881
time stamp: 3265.3333880901337
[]

Validation Results
Global Steps: 16599
Valid Loss: 0.69128
Valid Accuracy: 0.74987
time stamp: 3299.8484225273132
[]
best model saved: step =  16799 dev accu =  tensor(0.7540, device='cuda:0')

Validation Results
Global Steps: 16799
Valid Loss: 0.68568
Valid Accuracy: 0.75396
time stamp: 3335.0485870838165
[]

Validation Results
Global Steps: 16999
Valid Loss: 0.68324
Valid Accuracy: 0.75352
time stamp: 3370.39990901947
[]
best model saved: step =  17199 dev accu =  tensor(0.7603, device='cuda:0')

Validation Results
Global Steps: 17199
Valid Loss: 0.68392
Valid Accuracy: 0.76025
time stamp: 3405.4808292388916
[]

Validation Results
Global Steps: 17399
Valid Loss: 0.67166
Valid Accuracy: 0.75760
time stamp: 3440.4193155765533
[]
best model saved: step =  17599 dev accu =  tensor(0.7628, device='cuda:0')

Validation Results
Global Steps: 17599
Valid Loss: 0.68116
Valid Accuracy: 0.76276
time stamp: 3474.9165604114532
[]

Validation Results
Global Steps: 17799
Valid Loss: 0.68012
Valid Accuracy: 0.75884
time stamp: 3509.8977341651917
[]

Validation Results
Global Steps: 17999
Valid Loss: 0.67633
Valid Accuracy: 0.76067
time stamp: 3545.276247739792
[]

Validation Results
Global Steps: 18199
Valid Loss: 0.67447
Valid Accuracy: 0.75813
time stamp: 3580.655310153961
[]

Validation Results
Global Steps: 18399
Valid Loss: 0.67471
Valid Accuracy: 0.75846
time stamp: 3615.462984085083
[]

Validation Results
Global Steps: 18599
Valid Loss: 0.68132
Valid Accuracy: 0.75903
time stamp: 3650.347306251526
[]

Validation Results
Global Steps: 18799
Valid Loss: 0.66705
Valid Accuracy: 0.76004
time stamp: 3685.641114473343
[]
best model saved: step =  18999 dev accu =  tensor(0.7649, device='cuda:0')

Validation Results
Global Steps: 18999
Valid Loss: 0.66126
Valid Accuracy: 0.76485
time stamp: 3720.3596403598785
[]

Validation Results
Global Steps: 19199
Valid Loss: 0.66333
Valid Accuracy: 0.76375
time stamp: 3755.2230689525604
[]

Validation Results
Global Steps: 19399
Valid Loss: 0.65794
Valid Accuracy: 0.76184
time stamp: 3789.9287140369415
[]
best model saved: step =  19599 dev accu =  tensor(0.7672, device='cuda:0')

Validation Results
Global Steps: 19599
Valid Loss: 0.65217
Valid Accuracy: 0.76724
time stamp: 3824.9186713695526
[]
best model saved: step =  19799 dev accu =  tensor(0.7711, device='cuda:0')

Validation Results
Global Steps: 19799
Valid Loss: 0.65253
Valid Accuracy: 0.77107
time stamp: 3859.744210243225
[]

Validation Results
Global Steps: 19999
Valid Loss: 0.66753
Valid Accuracy: 0.77055
time stamp: 3894.8912580013275
[]

Validation Results
Global Steps: 20199
Valid Loss: 0.66265
Valid Accuracy: 0.76774
time stamp: 3930.0703473091125
[]

Validation Results
Global Steps: 20399
Valid Loss: 0.65229
Valid Accuracy: 0.76842
time stamp: 3964.9432051181793
[]

Validation Results
Global Steps: 20599
Valid Loss: 0.65224
Valid Accuracy: 0.76582
time stamp: 3999.850785255432
[]

Validation Results
Global Steps: 20799
Valid Loss: 0.65407
Valid Accuracy: 0.76747
time stamp: 4035.3724286556244
[]

Validation Results
Global Steps: 20999
Valid Loss: 0.66622
Valid Accuracy: 0.76653
time stamp: 4070.2881469726562
[]

Validation Results
Global Steps: 21199
Valid Loss: 0.64706
Valid Accuracy: 0.76888
time stamp: 4105.154177427292
[]
best model saved: step =  21399 dev accu =  tensor(0.7757, device='cuda:0')

Validation Results
Global Steps: 21399
Valid Loss: 0.64267
Valid Accuracy: 0.77565
time stamp: 4139.839482307434
[]

Validation Results
Global Steps: 21599
Valid Loss: 0.64916
Valid Accuracy: 0.77180
time stamp: 4174.822115421295
[]

Validation Results
Global Steps: 21799
Valid Loss: 0.65326
Valid Accuracy: 0.77307
time stamp: 4209.992931604385
[]

Validation Results
Global Steps: 21999
Valid Loss: 0.64648
Valid Accuracy: 0.77068
time stamp: 4244.818881988525
[]
best model saved: step =  22199 dev accu =  tensor(0.7759, device='cuda:0')

Validation Results
Global Steps: 22199
Valid Loss: 0.64296
Valid Accuracy: 0.77589
time stamp: 4279.659010648727
[]

Validation Results
Global Steps: 22399
Valid Loss: 0.64689
Valid Accuracy: 0.77438
time stamp: 4314.194888830185
[]
best model saved: step =  22599 dev accu =  tensor(0.7776, device='cuda:0')

Validation Results
Global Steps: 22599
Valid Loss: 0.63409
Valid Accuracy: 0.77761
time stamp: 4349.098491430283
[]

Validation Results
Global Steps: 22799
Valid Loss: 0.63347
Valid Accuracy: 0.77542
time stamp: 4384.055843114853
[]

Validation Results
Global Steps: 22999
Valid Loss: 0.64146
Valid Accuracy: 0.77587
time stamp: 4419.015176296234
[]
best model saved: step =  23199 dev accu =  tensor(0.7779, device='cuda:0')

Validation Results
Global Steps: 23199
Valid Loss: 0.63083
Valid Accuracy: 0.77792
time stamp: 4454.429914712906
[]

Validation Results
Global Steps: 23399
Valid Loss: 0.64144
Valid Accuracy: 0.77728
time stamp: 4489.252576112747
[]

Validation Results
Global Steps: 23599
Valid Loss: 0.63628
Valid Accuracy: 0.77691
time stamp: 4524.240694761276
[]
best model saved: step =  23799 dev accu =  tensor(0.7786, device='cuda:0')

Validation Results
Global Steps: 23799
Valid Loss: 0.62789
Valid Accuracy: 0.77855
time stamp: 4559.500059366226
[]
best model saved: step =  23999 dev accu =  tensor(0.7802, device='cuda:0')

Validation Results
Global Steps: 23999
Valid Loss: 0.63646
Valid Accuracy: 0.78024
time stamp: 4594.376996994019
[]

Validation Results
Global Steps: 24199
Valid Loss: 0.63946
Valid Accuracy: 0.77790
time stamp: 4629.403919696808
[]

Validation Results
Global Steps: 24399
Valid Loss: 0.64176
Valid Accuracy: 0.77725
time stamp: 4664.22212600708
[]
best model saved: step =  24599 dev accu =  tensor(0.7814, device='cuda:0')

Validation Results
Global Steps: 24599
Valid Loss: 0.63338
Valid Accuracy: 0.78145
time stamp: 4699.161163568497
[]

Validation Results
Global Steps: 24799
Valid Loss: 0.62047
Valid Accuracy: 0.78074
time stamp: 4733.668859243393
[]
best model saved: step =  24999 dev accu =  tensor(0.7823, device='cuda:0')

Validation Results
Global Steps: 24999
Valid Loss: 0.63314
Valid Accuracy: 0.78231
time stamp: 4768.616798400879
[]

Validation Results
Global Steps: 25199
Valid Loss: 0.62448
Valid Accuracy: 0.78069
time stamp: 4803.446734905243
[]
best model saved: step =  25399 dev accu =  tensor(0.7824, device='cuda:0')

Validation Results
Global Steps: 25399
Valid Loss: 0.63335
Valid Accuracy: 0.78238
time stamp: 4838.3957414627075
[]

Validation Results
Global Steps: 25599
Valid Loss: 0.63200
Valid Accuracy: 0.78167
time stamp: 4873.719841241837
[]
best model saved: step =  25799 dev accu =  tensor(0.7831, device='cuda:0')

Validation Results
Global Steps: 25799
Valid Loss: 0.62248
Valid Accuracy: 0.78309
time stamp: 4908.442756652832
[]

Validation Results
Global Steps: 25999
Valid Loss: 0.62331
Valid Accuracy: 0.78283
time stamp: 4943.473559856415
[]

Validation Results
Global Steps: 26199
Valid Loss: 0.63548
Valid Accuracy: 0.78268
time stamp: 4978.497372627258
[]
best model saved: step =  26399 dev accu =  tensor(0.7856, device='cuda:0')

Validation Results
Global Steps: 26399
Valid Loss: 0.62175
Valid Accuracy: 0.78563
time stamp: 5013.285108804703
[]

Validation Results
Global Steps: 26599
Valid Loss: 0.62193
Valid Accuracy: 0.78409
time stamp: 5048.175539731979
[]

Validation Results
Global Steps: 26799
Valid Loss: 0.63118
Valid Accuracy: 0.78424
time stamp: 5083.222052812576
[]
best model saved: step =  26999 dev accu =  tensor(0.7860, device='cuda:0')

Validation Results
Global Steps: 26999
Valid Loss: 0.62221
Valid Accuracy: 0.78597
time stamp: 5118.156814336777
[]

Validation Results
Global Steps: 27199
Valid Loss: 0.63032
Valid Accuracy: 0.78384
time stamp: 5152.829760313034
[]

Validation Results
Global Steps: 27399
Valid Loss: 0.62491
Valid Accuracy: 0.78386
time stamp: 5187.710426807404
[]

Validation Results
Global Steps: 27599
Valid Loss: 0.62864
Valid Accuracy: 0.78308
time stamp: 5222.233345985413
[]
best model saved: step =  27799 dev accu =  tensor(0.7860, device='cuda:0')

Validation Results
Global Steps: 27799
Valid Loss: 0.62086
Valid Accuracy: 0.78603
time stamp: 5257.071843147278
[]
best model saved: step =  27999 dev accu =  tensor(0.7867, device='cuda:0')

Validation Results
Global Steps: 27999
Valid Loss: 0.62701
Valid Accuracy: 0.78673
time stamp: 5291.897444963455
[]

Validation Results
Global Steps: 28199
Valid Loss: 0.62202
Valid Accuracy: 0.78518
time stamp: 5326.832391738892
[]

Validation Results
Global Steps: 28399
Valid Loss: 0.62222
Valid Accuracy: 0.78631
time stamp: 5361.912199020386
[]

Validation Results
Global Steps: 28599
Valid Loss: 0.63068
Valid Accuracy: 0.78383
time stamp: 5396.763332128525
[]

Validation Results
Global Steps: 28799
Valid Loss: 0.62284
Valid Accuracy: 0.78551
time stamp: 5431.191632270813
[]

Validation Results
Global Steps: 28999
Valid Loss: 0.62432
Valid Accuracy: 0.78399
time stamp: 5465.912415266037
[]

Validation Results
Global Steps: 29199
Valid Loss: 0.62483
Valid Accuracy: 0.78651
time stamp: 5501.500213861465
[]

Validation Results
Global Steps: 29399
Valid Loss: 0.62468
Valid Accuracy: 0.78521
time stamp: 5536.540226459503
[]

Validation Results
Global Steps: 29599
Valid Loss: 0.62345
Valid Accuracy: 0.78611
time stamp: 5571.617859363556
[]

Validation Results
Global Steps: 29799
Valid Loss: 0.62278
Valid Accuracy: 0.78554
time stamp: 5606.648473024368
[]

Validation Results
Global Steps: 29999
Valid Loss: 0.62239
Valid Accuracy: 0.78592
time stamp: 5641.481720924377
total training step (k): 30.0
total training time (s): 5641.482335329056
total training time (ms): 1523770.98046875
peak memory usage (MB): 12762
allocated memory usage (MB): 398400305
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |   10094 KB |   12762 MB |  389062 GB |  389062 GB |
|       from large pool |    6144 KB |   12750 MB |  385490 GB |  385490 GB |
|       from small pool |    3950 KB |      27 MB |    3572 GB |    3572 GB |
|---------------------------------------------------------------------------|
| Active memory         |   10094 KB |   12762 MB |  389062 GB |  389062 GB |
|       from large pool |    6144 KB |   12750 MB |  385490 GB |  385490 GB |
|       from small pool |    3950 KB |      27 MB |    3572 GB |    3572 GB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   12848 MB |   12848 MB |   12848 MB |       0 B  |
|       from large pool |   12820 MB |   12820 MB |   12820 MB |       0 B  |
|       from small pool |      28 MB |      28 MB |      28 MB |       0 B  |
|---------------------------------------------------------------------------|
| Non-releasable memory |   14481 KB |    1515 MB |  473907 GB |  473907 GB |
|       from large pool |   10240 KB |    1514 MB |  470216 GB |  470216 GB |
|       from small pool |    4241 KB |       6 MB |    3690 GB |    3690 GB |
|---------------------------------------------------------------------------|
| Allocations           |     246    |     535    |   35706 K  |   35706 K  |
|       from large pool |       2    |      87    |   13488 K  |   13488 K  |
|       from small pool |     244    |     518    |   22218 K  |   22218 K  |
|---------------------------------------------------------------------------|
| Active allocs         |     246    |     535    |   35706 K  |   35706 K  |
|       from large pool |       2    |      87    |   13488 K  |   13488 K  |
|       from small pool |     244    |     518    |   22218 K  |   22218 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      44    |      44    |      44    |       0    |
|       from large pool |      30    |      30    |      30    |       0    |
|       from small pool |      14    |      14    |      14    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |      11    |      33    |   15634 K  |   15634 K  |
|       from large pool |       1    |      16    |    5256 K  |    5256 K  |
|       from small pool |      10    |      23    |   10377 K  |   10377 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

loading the best model from: ./checkpoints/checkpoints-0/lra-news1/dense1000.model
Evaluation Results
Loss: 0.62746
Accuracy: 0.78655
