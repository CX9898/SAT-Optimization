GPU list: [0, 1, 2, 3]
[
    {
        "learn_pos_emb": true,
        "tied_weights": false,
        "embedding_dim": 64,
        "transformer_dim": 64,
        "transformer_hidden_dim": 128,
        "head_dim": 32,
        "num_head": 2,
        "num_layers": 4,
        "vocab_size": 512,
        "max_seq_len": 1024,
        "dropout_prob": 0.1,
        "attention_dropout": 0.1,
        "pooling_mode": "MEAN",
        "num_classes": 4,
        "block_size": 32,
        "batch_size": 128,
        "density": 0.08,
        "mixed_precision": true,
        "random_seed": 8,
        "task": "lra-news1"
    },
    {
        "batch_size": 512,
        "learning_rate": 0.0009,
        "warmup": 80,
        "lr_decay": "linear",
        "weight_decay": 0,
        "eval_frequency": 200,
        "num_train_steps": 30000,
        "num_init_steps": 3000,
        "num_eval_steps": 200,
        "num_dense_train_steps": 1000,
        "patience": 10,
        "attn_loss_scale": 0.01
    }
]
attn_mask compile
attn_mask compile
attn_mask compile
attn_mask compile
DataParallel(
  (module): ModelForSC(
    (model): Model(
      (embeddings): Embeddings(
        (word_embeddings): Embedding(512, 64)
        (position_embeddings): Embedding(1024, 64)
        (dropout): Dropout(p=0.1, inplace=False)
      )
      (transformer_0): TransformerLayer(
        (norm1): LayerNorm((64,), eps=1e-05, elementwise_affine=True)
        (mha): Attention(
          (W_q): Linear(in_features=64, out_features=64, bias=True)
          (W_k): Linear(in_features=64, out_features=64, bias=True)
          (W_v): Linear(in_features=64, out_features=64, bias=True)
          (avg_pool): AvgPool2d(kernel_size=32, stride=32, padding=0)
          (MSEloss): MSELoss()
          (attn): CUDAMaskAttention()
          (ff): Linear(in_features=64, out_features=64, bias=True)
        )
        (dropout1): Dropout(p=0.1, inplace=False)
        (norm2): LayerNorm((64,), eps=1e-05, elementwise_affine=True)
        (mlpblock): Sequential(
          (0): Linear(in_features=64, out_features=128, bias=True)
          (1): GELU(approximate='none')
          (2): Dropout(p=0.1, inplace=False)
          (3): Linear(in_features=128, out_features=64, bias=True)
          (4): Dropout(p=0.1, inplace=False)
        )
      )
      (transformer_1): TransformerLayer(
        (norm1): LayerNorm((64,), eps=1e-05, elementwise_affine=True)
        (mha): Attention(
          (W_q): Linear(in_features=64, out_features=64, bias=True)
          (W_k): Linear(in_features=64, out_features=64, bias=True)
          (W_v): Linear(in_features=64, out_features=64, bias=True)
          (avg_pool): AvgPool2d(kernel_size=32, stride=32, padding=0)
          (MSEloss): MSELoss()
          (attn): CUDAMaskAttention()
          (ff): Linear(in_features=64, out_features=64, bias=True)
        )
        (dropout1): Dropout(p=0.1, inplace=False)
        (norm2): LayerNorm((64,), eps=1e-05, elementwise_affine=True)
        (mlpblock): Sequential(
          (0): Linear(in_features=64, out_features=128, bias=True)
          (1): GELU(approximate='none')
          (2): Dropout(p=0.1, inplace=False)
          (3): Linear(in_features=128, out_features=64, bias=True)
          (4): Dropout(p=0.1, inplace=False)
        )
      )
      (transformer_2): TransformerLayer(
        (norm1): LayerNorm((64,), eps=1e-05, elementwise_affine=True)
        (mha): Attention(
          (W_q): Linear(in_features=64, out_features=64, bias=True)
          (W_k): Linear(in_features=64, out_features=64, bias=True)
          (W_v): Linear(in_features=64, out_features=64, bias=True)
          (avg_pool): AvgPool2d(kernel_size=32, stride=32, padding=0)
          (MSEloss): MSELoss()
          (attn): CUDAMaskAttention()
          (ff): Linear(in_features=64, out_features=64, bias=True)
        )
        (dropout1): Dropout(p=0.1, inplace=False)
        (norm2): LayerNorm((64,), eps=1e-05, elementwise_affine=True)
        (mlpblock): Sequential(
          (0): Linear(in_features=64, out_features=128, bias=True)
          (1): GELU(approximate='none')
          (2): Dropout(p=0.1, inplace=False)
          (3): Linear(in_features=128, out_features=64, bias=True)
          (4): Dropout(p=0.1, inplace=False)
        )
      )
      (transformer_3): TransformerLayer(
        (norm1): LayerNorm((64,), eps=1e-05, elementwise_affine=True)
        (mha): Attention(
          (W_q): Linear(in_features=64, out_features=64, bias=True)
          (W_k): Linear(in_features=64, out_features=64, bias=True)
          (W_v): Linear(in_features=64, out_features=64, bias=True)
          (avg_pool): AvgPool2d(kernel_size=32, stride=32, padding=0)
          (MSEloss): MSELoss()
          (attn): CUDAMaskAttention()
          (ff): Linear(in_features=64, out_features=64, bias=True)
        )
        (dropout1): Dropout(p=0.1, inplace=False)
        (norm2): LayerNorm((64,), eps=1e-05, elementwise_affine=True)
        (mlpblock): Sequential(
          (0): Linear(in_features=64, out_features=128, bias=True)
          (1): GELU(approximate='none')
          (2): Dropout(p=0.1, inplace=False)
          (3): Linear(in_features=128, out_features=64, bias=True)
          (4): Dropout(p=0.1, inplace=False)
        )
      )
      (norm): LayerNorm((64,), eps=1e-05, elementwise_affine=True)
    )
    (seq_classifer): SCHead(
      (mlpblock): Sequential(
        (0): Linear(in_features=64, out_features=128, bias=True)
        (1): ReLU()
        (2): Linear(in_features=128, out_features=4, bias=True)
      )
    )
  )
)
parameter_size: [torch.Size([512, 64]), torch.Size([1024, 64]), torch.Size([64]), torch.Size([64]), torch.Size([32, 32]), torch.Size([64, 64]), torch.Size([64]), torch.Size([64, 64]), torch.Size([64]), torch.Size([64, 64]), torch.Size([64]), torch.Size([64, 64]), torch.Size([64]), torch.Size([64]), torch.Size([64]), torch.Size([128, 64]), torch.Size([128]), torch.Size([64, 128]), torch.Size([64]), torch.Size([64]), torch.Size([64]), torch.Size([32, 32]), torch.Size([64, 64]), torch.Size([64]), torch.Size([64, 64]), torch.Size([64]), torch.Size([64, 64]), torch.Size([64]), torch.Size([64, 64]), torch.Size([64]), torch.Size([64]), torch.Size([64]), torch.Size([128, 64]), torch.Size([128]), torch.Size([64, 128]), torch.Size([64]), torch.Size([64]), torch.Size([64]), torch.Size([32, 32]), torch.Size([64, 64]), torch.Size([64]), torch.Size([64, 64]), torch.Size([64]), torch.Size([64, 64]), torch.Size([64]), torch.Size([64, 64]), torch.Size([64]), torch.Size([64]), torch.Size([64]), torch.Size([128, 64]), torch.Size([128]), torch.Size([64, 128]), torch.Size([64]), torch.Size([64]), torch.Size([64]), torch.Size([32, 32]), torch.Size([64, 64]), torch.Size([64]), torch.Size([64, 64]), torch.Size([64]), torch.Size([64, 64]), torch.Size([64]), torch.Size([64, 64]), torch.Size([64]), torch.Size([64]), torch.Size([64]), torch.Size([128, 64]), torch.Size([128]), torch.Size([64, 128]), torch.Size([64]), torch.Size([64]), torch.Size([64]), torch.Size([128, 64]), torch.Size([128]), torch.Size([4, 128]), torch.Size([4])]
num_parameter: 245252
Loaded ../Skyformer/data/lra_processed/lra-news1.train.pickle... size=120000
Loaded ../Skyformer/data/lra_processed/lra-news1.dev.pickle... size=7600
Loaded ../Skyformer/data/lra_processed/lra-news1.test.pickle... size=7600
accumu_steps=1
[tensor([23.4845, 23.4845, 23.4845, 23.4845], device='cuda:0',
       grad_fn=<GatherBackward>), tensor([25.3815, 25.3815, 25.3815, 25.3815], device='cuda:0',
       grad_fn=<GatherBackward>), tensor([23.8029, 23.8029, 23.8029, 23.8029], device='cuda:0',
       grad_fn=<GatherBackward>), tensor([23.5635, 23.5636, 23.5635, 23.5636], device='cuda:0',
       grad_fn=<GatherBackward>)]
best model saved: step =  199 dev accu =  tensor(0.5938, device='cuda:0')

Validation Results
Global Steps: 199
Valid Loss: 0.99844
Valid Accuracy: 0.59378
time stamp: 159.46361327171326
module.model.transformer_0.mha.pattern saved
module.model.transformer_1.mha.pattern saved
module.model.transformer_2.mha.pattern saved
module.model.transformer_3.mha.pattern saved
./pickle/lra-news1/module.model.transformer_0.mha.pattern.pickle
tensor([ 726,  396, 1023,  759,  363,  495,  957,  825,   99,  297,  693,  990,
         594,  733,  950,  462,  627,  924,  767, 1015,  503,  751,  415, 1004,
         727,  758,  364,  395,  735, 1014,  729,  822,  118,  707,  198,  406,
         716,  330,  413,  940,  405,  684,  299,  361,  764,  919,  502,  719,
         319, 1001,  127,  995,  429,  734,  982,  414,  972,  991, 1022,  107,
         355,  528,  300,  393,  959, 1021,  383, 1003,  215,  742,  132,  108,
         387,  927, 1020,  505,  815,  374,  715,  382,  971], device='cuda:0')
tensor(81, device='cuda:0')
block_attn_mask compile
./pickle/lra-news1/module.model.transformer_1.mha.pattern.pickle
tensor([726, 957, 495,   0, 198, 594, 132, 693, 264, 396, 429, 363, 330, 157,
        932, 990, 660, 509, 943, 462, 759, 891, 733, 950,  22, 704,   8, 256,
        221, 934, 792, 528, 605, 946, 413, 940, 598, 722, 210, 582, 825, 165,
        627,  18, 576, 924, 214, 710,  29, 928, 222, 966, 205, 422,   6, 192,
        134, 196, 662, 724, 728, 790, 637, 947, 207, 486, 399, 492, 445, 941,
        204, 390,  21, 672,  25, 800, 143, 484,  99, 213, 678],
       device='cuda:0')
tensor(81, device='cuda:0')
block_attn_mask compile
./pickle/lra-news1/module.model.transformer_2.mha.pattern.pickle
tensor([990, 462, 429, 693, 627, 264, 759, 594, 132, 891,  99, 430, 461, 478,
        974, 766, 983, 165,  33, 269, 424, 231, 726, 396, 702, 981, 469, 686,
        446, 973, 174, 453,  66, 330, 629, 691, 297, 467, 622, 528, 363, 471,
        750, 466, 590, 270, 456, 286, 968, 434, 589, 198,  46, 449, 142, 452,
        117, 675, 181, 677, 414, 972,  45, 417, 279, 744, 858, 660, 495, 439,
        749, 437, 685, 561, 435, 621, 699, 885,  53, 673, 179],
       device='cuda:0')
tensor(81, device='cuda:0')
block_attn_mask compile
./pickle/lra-news1/module.model.transformer_3.mha.pattern.pickle
tensor([693, 297,  33, 132, 858,  66, 495, 660, 561, 792, 330, 726,  53, 673,
        264, 698, 853, 303, 489, 957, 501, 687, 759, 891, 341, 682,  99,  58,
        833, 825,   0, 627, 594,  42, 321,  89, 802, 696, 789, 528, 924, 701,
        949, 429, 990, 165, 309, 681, 694, 725, 504, 783, 117, 675, 152, 772,
        148, 644, 566, 721,  88, 770, 533, 688, 143, 484, 137, 292, 727, 758,
         85, 674, 149, 676, 342, 714,  45, 417,  80, 514,  68],
       device='cuda:0')
tensor(81, device='cuda:0')
block_attn_mask compile
total pattern searching time (s): 0.09445405006408691
[]

Validation Results
Global Steps: 399
Valid Loss: 1.13934
Valid Accuracy: 0.51212
time stamp: 240.07693719863892
[]

Validation Results
Global Steps: 599
Valid Loss: 1.00381
Valid Accuracy: 0.57930
time stamp: 280.8835816383362
[]
best model saved: step =  799 dev accu =  tensor(0.6137, device='cuda:0')

Validation Results
Global Steps: 799
Valid Loss: 0.94525
Valid Accuracy: 0.61373
time stamp: 321.8423025608063
[]

Validation Results
Global Steps: 999
Valid Loss: 0.95391
Valid Accuracy: 0.61177
time stamp: 363.0654466152191
[]

Validation Results
Global Steps: 1199
Valid Loss: 0.95533
Valid Accuracy: 0.61342
time stamp: 404.4739806652069
[]
best model saved: step =  1399 dev accu =  tensor(0.6205, device='cuda:0')

Validation Results
Global Steps: 1399
Valid Loss: 0.92867
Valid Accuracy: 0.62048
time stamp: 445.5508942604065
[]
best model saved: step =  1599 dev accu =  tensor(0.6379, device='cuda:0')

Validation Results
Global Steps: 1599
Valid Loss: 0.90668
Valid Accuracy: 0.63790
time stamp: 487.03192377090454
[]
best model saved: step =  1799 dev accu =  tensor(0.6398, device='cuda:0')

Validation Results
Global Steps: 1799
Valid Loss: 0.89459
Valid Accuracy: 0.63978
time stamp: 528.0155539512634
[]

Validation Results
Global Steps: 1999
Valid Loss: 0.89077
Valid Accuracy: 0.63916
time stamp: 568.8239607810974
[]
best model saved: step =  2199 dev accu =  tensor(0.6436, device='cuda:0')

Validation Results
Global Steps: 2199
Valid Loss: 0.88102
Valid Accuracy: 0.64363
time stamp: 609.9410729408264
[]

Validation Results
Global Steps: 2399
Valid Loss: 0.89410
Valid Accuracy: 0.64141
time stamp: 651.282341003418
[]
best model saved: step =  2599 dev accu =  tensor(0.6463, device='cuda:0')

Validation Results
Global Steps: 2599
Valid Loss: 0.88035
Valid Accuracy: 0.64628
time stamp: 692.7028648853302
[]
best model saved: step =  2799 dev accu =  tensor(0.6466, device='cuda:0')

Validation Results
Global Steps: 2799
Valid Loss: 0.87588
Valid Accuracy: 0.64655
time stamp: 733.9649057388306
[]
best model saved: step =  2999 dev accu =  tensor(0.6543, device='cuda:0')

Validation Results
Global Steps: 2999
Valid Loss: 0.86503
Valid Accuracy: 0.65427
time stamp: 775.1142814159393
[]

Validation Results
Global Steps: 3199
Valid Loss: 0.86053
Valid Accuracy: 0.65388
time stamp: 816.2706751823425
[]

Validation Results
Global Steps: 3399
Valid Loss: 0.90102
Valid Accuracy: 0.63865
time stamp: 857.1816983222961
[]
best model saved: step =  3599 dev accu =  tensor(0.6584, device='cuda:0')

Validation Results
Global Steps: 3599
Valid Loss: 0.86688
Valid Accuracy: 0.65838
time stamp: 898.4584743976593
[]
best model saved: step =  3799 dev accu =  tensor(0.6642, device='cuda:0')

Validation Results
Global Steps: 3799
Valid Loss: 0.84765
Valid Accuracy: 0.66421
time stamp: 939.7618298530579
[]

Validation Results
Global Steps: 3999
Valid Loss: 0.85876
Valid Accuracy: 0.65663
time stamp: 980.8865284919739
[]

Validation Results
Global Steps: 4199
Valid Loss: 0.83944
Valid Accuracy: 0.66292
time stamp: 1021.8249835968018
[]
best model saved: step =  4399 dev accu =  tensor(0.6646, device='cuda:0')

Validation Results
Global Steps: 4399
Valid Loss: 0.84410
Valid Accuracy: 0.66463
time stamp: 1062.8559515476227
[]

Validation Results
Global Steps: 4599
Valid Loss: 0.84568
Valid Accuracy: 0.66115
time stamp: 1104.100599527359
[]

Validation Results
Global Steps: 4799
Valid Loss: 0.84664
Valid Accuracy: 0.66015
time stamp: 1145.269254207611
[]
best model saved: step =  4999 dev accu =  tensor(0.6707, device='cuda:0')

Validation Results
Global Steps: 4999
Valid Loss: 0.83097
Valid Accuracy: 0.67072
time stamp: 1186.1749000549316
[]

Validation Results
Global Steps: 5199
Valid Loss: 0.83755
Valid Accuracy: 0.66670
time stamp: 1227.6488530635834
[]
best model saved: step =  5399 dev accu =  tensor(0.6720, device='cuda:0')

Validation Results
Global Steps: 5399
Valid Loss: 0.83347
Valid Accuracy: 0.67204
time stamp: 1268.6812150478363
[]

Validation Results
Global Steps: 5599
Valid Loss: 0.82842
Valid Accuracy: 0.66762
time stamp: 1309.7059211730957
[]
best model saved: step =  5799 dev accu =  tensor(0.6745, device='cuda:0')

Validation Results
Global Steps: 5799
Valid Loss: 0.82251
Valid Accuracy: 0.67449
time stamp: 1350.702891588211
[]

Validation Results
Global Steps: 5999
Valid Loss: 0.85266
Valid Accuracy: 0.66396
time stamp: 1391.7507960796356
[]

Validation Results
Global Steps: 6199
Valid Loss: 0.83507
Valid Accuracy: 0.66941
time stamp: 1432.9617578983307
[]

Validation Results
Global Steps: 6399
Valid Loss: 0.83048
Valid Accuracy: 0.67051
time stamp: 1474.2277946472168
[]

Validation Results
Global Steps: 6599
Valid Loss: 0.83299
Valid Accuracy: 0.67028
time stamp: 1515.567322731018
[]
best model saved: step =  6799 dev accu =  tensor(0.6771, device='cuda:0')

Validation Results
Global Steps: 6799
Valid Loss: 0.82304
Valid Accuracy: 0.67713
time stamp: 1556.7570033073425
[]

Validation Results
Global Steps: 6999
Valid Loss: 0.82693
Valid Accuracy: 0.67456
time stamp: 1598.2153270244598
[]

Validation Results
Global Steps: 7199
Valid Loss: 0.82285
Valid Accuracy: 0.67636
time stamp: 1639.4217793941498
[]
best model saved: step =  7399 dev accu =  tensor(0.6796, device='cuda:0')

Validation Results
Global Steps: 7399
Valid Loss: 0.81507
Valid Accuracy: 0.67963
time stamp: 1680.647217988968
[]

Validation Results
Global Steps: 7599
Valid Loss: 0.82085
Valid Accuracy: 0.67792
time stamp: 1721.7254626750946
[]

Validation Results
Global Steps: 7799
Valid Loss: 0.82227
Valid Accuracy: 0.67812
time stamp: 1762.7633221149445
[]
best model saved: step =  7999 dev accu =  tensor(0.6803, device='cuda:0')

Validation Results
Global Steps: 7999
Valid Loss: 0.81479
Valid Accuracy: 0.68034
time stamp: 1804.1918499469757
[]
best model saved: step =  8199 dev accu =  tensor(0.6859, device='cuda:0')

Validation Results
Global Steps: 8199
Valid Loss: 0.80617
Valid Accuracy: 0.68590
time stamp: 1845.3493061065674
[]

Validation Results
Global Steps: 8399
Valid Loss: 0.81039
Valid Accuracy: 0.68510
time stamp: 1886.1652538776398
[]

Validation Results
Global Steps: 8599
Valid Loss: 0.80107
Valid Accuracy: 0.68433
time stamp: 1927.4084963798523
[]
best model saved: step =  8799 dev accu =  tensor(0.6862, device='cuda:0')

Validation Results
Global Steps: 8799
Valid Loss: 0.80260
Valid Accuracy: 0.68622
time stamp: 1968.419822692871
[]
best model saved: step =  8999 dev accu =  tensor(0.6866, device='cuda:0')

Validation Results
Global Steps: 8999
Valid Loss: 0.80869
Valid Accuracy: 0.68663
time stamp: 2009.539481163025
[]
best model saved: step =  9199 dev accu =  tensor(0.6894, device='cuda:0')

Validation Results
Global Steps: 9199
Valid Loss: 0.80112
Valid Accuracy: 0.68936
time stamp: 2050.668402194977
[]
best model saved: step =  9399 dev accu =  tensor(0.6922, device='cuda:0')

Validation Results
Global Steps: 9399
Valid Loss: 0.79848
Valid Accuracy: 0.69221
time stamp: 2091.8420374393463
[]

Validation Results
Global Steps: 9599
Valid Loss: 0.79219
Valid Accuracy: 0.68807
time stamp: 2133.0293266773224
[]

Validation Results
Global Steps: 9799
Valid Loss: 0.80259
Valid Accuracy: 0.68909
time stamp: 2173.904605150223
[]
best model saved: step =  9999 dev accu =  tensor(0.6922, device='cuda:0')

Validation Results
Global Steps: 9999
Valid Loss: 0.78803
Valid Accuracy: 0.69223
time stamp: 2215.126145839691
[]
best model saved: step =  10199 dev accu =  tensor(0.6924, device='cuda:0')

Validation Results
Global Steps: 10199
Valid Loss: 0.79105
Valid Accuracy: 0.69237
time stamp: 2256.2862691879272
[]

Validation Results
Global Steps: 10399
Valid Loss: 0.80988
Valid Accuracy: 0.68423
time stamp: 2297.4957139492035
[]

Validation Results
Global Steps: 10599
Valid Loss: 0.80337
Valid Accuracy: 0.69129
time stamp: 2338.6921033859253
[]
best model saved: step =  10799 dev accu =  tensor(0.6942, device='cuda:0')

Validation Results
Global Steps: 10799
Valid Loss: 0.79316
Valid Accuracy: 0.69416
time stamp: 2380.053454875946
[]
best model saved: step =  10999 dev accu =  tensor(0.6942, device='cuda:0')

Validation Results
Global Steps: 10999
Valid Loss: 0.79269
Valid Accuracy: 0.69420
time stamp: 2421.1144514083862
[]

Validation Results
Global Steps: 11199
Valid Loss: 0.78110
Valid Accuracy: 0.69345
time stamp: 2462.28359746933
[]

Validation Results
Global Steps: 11399
Valid Loss: 0.78842
Valid Accuracy: 0.69331
time stamp: 2503.3701462745667
[]
best model saved: step =  11599 dev accu =  tensor(0.6986, device='cuda:0')

Validation Results
Global Steps: 11599
Valid Loss: 0.79403
Valid Accuracy: 0.69857
time stamp: 2544.491627216339
[]
best model saved: step =  11799 dev accu =  tensor(0.6995, device='cuda:0')

Validation Results
Global Steps: 11799
Valid Loss: 0.78398
Valid Accuracy: 0.69952
time stamp: 2585.378702402115
[]
best model saved: step =  11999 dev accu =  tensor(0.7014, device='cuda:0')

Validation Results
Global Steps: 11999
Valid Loss: 0.78541
Valid Accuracy: 0.70139
time stamp: 2626.426571369171
[]

Validation Results
Global Steps: 12199
Valid Loss: 0.78129
Valid Accuracy: 0.69979
time stamp: 2667.6576755046844
[]

Validation Results
Global Steps: 12399
Valid Loss: 0.78770
Valid Accuracy: 0.69823
time stamp: 2708.7464985847473
[]

Validation Results
Global Steps: 12599
Valid Loss: 0.78279
Valid Accuracy: 0.70028
time stamp: 2749.5810983181
[]

Validation Results
Global Steps: 12799
Valid Loss: 0.79935
Valid Accuracy: 0.69521
time stamp: 2790.5820519924164
[]

Validation Results
Global Steps: 12999
Valid Loss: 0.79492
Valid Accuracy: 0.69817
time stamp: 2831.6101841926575
[]
best model saved: step =  13199 dev accu =  tensor(0.7062, device='cuda:0')

Validation Results
Global Steps: 13199
Valid Loss: 0.77244
Valid Accuracy: 0.70615
time stamp: 2872.6285989284515
[]
best model saved: step =  13399 dev accu =  tensor(0.7074, device='cuda:0')

Validation Results
Global Steps: 13399
Valid Loss: 0.78340
Valid Accuracy: 0.70738
time stamp: 2913.6830587387085
[]

Validation Results
Global Steps: 13599
Valid Loss: 0.77232
Valid Accuracy: 0.70539
time stamp: 2955.0180490016937
[]

Validation Results
Global Steps: 13799
Valid Loss: 0.77935
Valid Accuracy: 0.70679
time stamp: 2996.013903617859
[]
best model saved: step =  13999 dev accu =  tensor(0.7078, device='cuda:0')

Validation Results
Global Steps: 13999
Valid Loss: 0.76999
Valid Accuracy: 0.70783
time stamp: 3036.8223288059235
[]
best model saved: step =  14199 dev accu =  tensor(0.7092, device='cuda:0')

Validation Results
Global Steps: 14199
Valid Loss: 0.77327
Valid Accuracy: 0.70920
time stamp: 3078.131452322006
[]
best model saved: step =  14399 dev accu =  tensor(0.7139, device='cuda:0')

Validation Results
Global Steps: 14399
Valid Loss: 0.75929
Valid Accuracy: 0.71386
time stamp: 3119.464205980301
[]

Validation Results
Global Steps: 14599
Valid Loss: 0.77581
Valid Accuracy: 0.70730
time stamp: 3160.6058616638184
[]
best model saved: step =  14799 dev accu =  tensor(0.7150, device='cuda:0')

Validation Results
Global Steps: 14799
Valid Loss: 0.75837
Valid Accuracy: 0.71499
time stamp: 3201.708468914032
[]

Validation Results
Global Steps: 14999
Valid Loss: 0.75901
Valid Accuracy: 0.71217
time stamp: 3242.8571667671204
[]

Validation Results
Global Steps: 15199
Valid Loss: 0.76794
Valid Accuracy: 0.71361
time stamp: 3283.954768180847
[]
best model saved: step =  15399 dev accu =  tensor(0.7159, device='cuda:0')

Validation Results
Global Steps: 15399
Valid Loss: 0.75024
Valid Accuracy: 0.71586
time stamp: 3325.1219861507416
[]
best model saved: step =  15599 dev accu =  tensor(0.7202, device='cuda:0')

Validation Results
Global Steps: 15599
Valid Loss: 0.75117
Valid Accuracy: 0.72023
time stamp: 3366.430451154709
[]

Validation Results
Global Steps: 15799
Valid Loss: 0.79057
Valid Accuracy: 0.70460
time stamp: 3407.453561067581
[]

Validation Results
Global Steps: 15999
Valid Loss: 0.75025
Valid Accuracy: 0.71979
time stamp: 3448.3661766052246
[]

Validation Results
Global Steps: 16199
Valid Loss: 0.76455
Valid Accuracy: 0.71449
time stamp: 3489.269077539444
[]

Validation Results
Global Steps: 16399
Valid Loss: 0.75595
Valid Accuracy: 0.71552
time stamp: 3530.200432777405
[]
best model saved: step =  16599 dev accu =  tensor(0.7239, device='cuda:0')

Validation Results
Global Steps: 16599
Valid Loss: 0.74002
Valid Accuracy: 0.72393
time stamp: 3571.012223005295
[]

Validation Results
Global Steps: 16799
Valid Loss: 0.75176
Valid Accuracy: 0.71908
time stamp: 3612.0417590141296
[]

Validation Results
Global Steps: 16999
Valid Loss: 0.74414
Valid Accuracy: 0.72388
time stamp: 3653.0392351150513
[]

Validation Results
Global Steps: 17199
Valid Loss: 0.74534
Valid Accuracy: 0.72340
time stamp: 3694.1785128116608
[]

Validation Results
Global Steps: 17399
Valid Loss: 0.75966
Valid Accuracy: 0.72067
time stamp: 3735.2588262557983
[]

Validation Results
Global Steps: 17599
Valid Loss: 0.76137
Valid Accuracy: 0.72195
time stamp: 3776.137242078781
[]

Validation Results
Global Steps: 17799
Valid Loss: 0.74506
Valid Accuracy: 0.72320
time stamp: 3817.3660140037537
[]
best model saved: step =  17999 dev accu =  tensor(0.7299, device='cuda:0')

Validation Results
Global Steps: 17999
Valid Loss: 0.73739
Valid Accuracy: 0.72988
time stamp: 3858.392114877701
[]

Validation Results
Global Steps: 18199
Valid Loss: 0.75174
Valid Accuracy: 0.72555
time stamp: 3899.396775007248
[]

Validation Results
Global Steps: 18399
Valid Loss: 0.74142
Valid Accuracy: 0.72306
time stamp: 3940.591376543045
[]

Validation Results
Global Steps: 18599
Valid Loss: 0.76500
Valid Accuracy: 0.71821
time stamp: 3981.7152292728424
[]
best model saved: step =  18799 dev accu =  tensor(0.7302, device='cuda:0')

Validation Results
Global Steps: 18799
Valid Loss: 0.73281
Valid Accuracy: 0.73017
time stamp: 4023.13098859787
[]

Validation Results
Global Steps: 18999
Valid Loss: 0.75268
Valid Accuracy: 0.72058
time stamp: 4064.001356124878
[]

Validation Results
Global Steps: 19199
Valid Loss: 0.73923
Valid Accuracy: 0.72880
time stamp: 4105.023671388626
[]

Validation Results
Global Steps: 19399
Valid Loss: 0.73572
Valid Accuracy: 0.72700
time stamp: 4146.031859874725
[]
best model saved: step =  19599 dev accu =  tensor(0.7304, device='cuda:0')

Validation Results
Global Steps: 19599
Valid Loss: 0.74496
Valid Accuracy: 0.73045
time stamp: 4186.911737680435
[]

Validation Results
Global Steps: 19799
Valid Loss: 0.73037
Valid Accuracy: 0.72773
time stamp: 4228.061687469482
[]

Validation Results
Global Steps: 19999
Valid Loss: 0.74203
Valid Accuracy: 0.73043
time stamp: 4269.390599966049
[]
best model saved: step =  20199 dev accu =  tensor(0.7327, device='cuda:0')

Validation Results
Global Steps: 20199
Valid Loss: 0.73397
Valid Accuracy: 0.73273
time stamp: 4310.782390832901
[]

Validation Results
Global Steps: 20399
Valid Loss: 0.74419
Valid Accuracy: 0.72674
time stamp: 4351.989359617233
[]

Validation Results
Global Steps: 20599
Valid Loss: 0.73529
Valid Accuracy: 0.72562
time stamp: 4393.1814086437225
[]

Validation Results
Global Steps: 20799
Valid Loss: 0.74737
Valid Accuracy: 0.72589
time stamp: 4434.180196285248
[]

Validation Results
Global Steps: 20999
Valid Loss: 0.73782
Valid Accuracy: 0.73207
time stamp: 4475.316038370132
[]

Validation Results
Global Steps: 21199
Valid Loss: 0.72546
Valid Accuracy: 0.73134
time stamp: 4516.5055820941925
[]

Validation Results
Global Steps: 21399
Valid Loss: 0.72809
Valid Accuracy: 0.73220
time stamp: 4557.417545557022
[]

Validation Results
Global Steps: 21599
Valid Loss: 0.74412
Valid Accuracy: 0.73099
time stamp: 4598.767176628113
[]
best model saved: step =  21799 dev accu =  tensor(0.7388, device='cuda:0')

Validation Results
Global Steps: 21799
Valid Loss: 0.72268
Valid Accuracy: 0.73884
time stamp: 4639.591295480728
[]

Validation Results
Global Steps: 21999
Valid Loss: 0.71528
Valid Accuracy: 0.73861
time stamp: 4680.324472665787
[]
best model saved: step =  22199 dev accu =  tensor(0.7392, device='cuda:0')

Validation Results
Global Steps: 22199
Valid Loss: 0.71781
Valid Accuracy: 0.73921
time stamp: 4721.527549505234
[]

Validation Results
Global Steps: 22399
Valid Loss: 0.72473
Valid Accuracy: 0.73483
time stamp: 4762.659338235855
[]

Validation Results
Global Steps: 22599
Valid Loss: 0.72693
Valid Accuracy: 0.73568
time stamp: 4803.7413284778595
[]

Validation Results
Global Steps: 22799
Valid Loss: 0.71975
Valid Accuracy: 0.73699
time stamp: 4844.717688322067
[]

Validation Results
Global Steps: 22999
Valid Loss: 0.71952
Valid Accuracy: 0.73585
time stamp: 4886.0874106884
[]
best model saved: step =  23199 dev accu =  tensor(0.7425, device='cuda:0')

Validation Results
Global Steps: 23199
Valid Loss: 0.71530
Valid Accuracy: 0.74247
time stamp: 4926.894133090973
[]

Validation Results
Global Steps: 23399
Valid Loss: 0.72347
Valid Accuracy: 0.73812
time stamp: 4968.174160003662
[]

Validation Results
Global Steps: 23599
Valid Loss: 0.73240
Valid Accuracy: 0.73640
time stamp: 5009.424160957336
[]

Validation Results
Global Steps: 23799
Valid Loss: 0.72580
Valid Accuracy: 0.73515
time stamp: 5050.835922718048
[]

Validation Results
Global Steps: 23999
Valid Loss: 0.72661
Valid Accuracy: 0.73732
time stamp: 5091.839227437973
[]

Validation Results
Global Steps: 24199
Valid Loss: 0.70394
Valid Accuracy: 0.73948
time stamp: 5133.23085474968
[]

Validation Results
Global Steps: 24399
Valid Loss: 0.70783
Valid Accuracy: 0.73914
time stamp: 5174.298917770386
[]

Validation Results
Global Steps: 24599
Valid Loss: 0.70869
Valid Accuracy: 0.73921
time stamp: 5215.18803024292
[]

Validation Results
Global Steps: 24799
Valid Loss: 0.71456
Valid Accuracy: 0.73503
time stamp: 5256.345240354538
[]

Validation Results
Global Steps: 24999
Valid Loss: 0.71777
Valid Accuracy: 0.74107
time stamp: 5297.625769138336
[]
best model saved: step =  25199 dev accu =  tensor(0.7435, device='cuda:0')

Validation Results
Global Steps: 25199
Valid Loss: 0.70443
Valid Accuracy: 0.74354
time stamp: 5338.807419061661
[]
best model saved: step =  25399 dev accu =  tensor(0.7448, device='cuda:0')

Validation Results
Global Steps: 25399
Valid Loss: 0.69791
Valid Accuracy: 0.74477
time stamp: 5379.649803876877
[]

Validation Results
Global Steps: 25599
Valid Loss: 0.71057
Valid Accuracy: 0.73531
time stamp: 5420.555390357971
[]

Validation Results
Global Steps: 25799
Valid Loss: 0.70861
Valid Accuracy: 0.74200
time stamp: 5461.875619888306
[]

Validation Results
Global Steps: 25999
Valid Loss: 0.70888
Valid Accuracy: 0.73946
time stamp: 5502.985127449036
[]

Validation Results
Global Steps: 26199
Valid Loss: 0.71916
Valid Accuracy: 0.74034
time stamp: 5544.270074605942
[]

Validation Results
Global Steps: 26399
Valid Loss: 0.70645
Valid Accuracy: 0.74129
time stamp: 5585.052476882935
[]

Validation Results
Global Steps: 26599
Valid Loss: 0.70349
Valid Accuracy: 0.74286
time stamp: 5626.057819366455
[]

Validation Results
Global Steps: 26799
Valid Loss: 0.71159
Valid Accuracy: 0.74360
time stamp: 5667.429102897644
[]

Validation Results
Global Steps: 26999
Valid Loss: 0.71307
Valid Accuracy: 0.74038
time stamp: 5708.3064341545105
[]

Validation Results
Global Steps: 27199
Valid Loss: 0.70542
Valid Accuracy: 0.74313
time stamp: 5749.919631719589
[]
best model saved: step =  27399 dev accu =  tensor(0.7456, device='cuda:0')

Validation Results
Global Steps: 27399
Valid Loss: 0.70817
Valid Accuracy: 0.74560
time stamp: 5790.691418170929
[]

Validation Results
Global Steps: 27599
Valid Loss: 0.70197
Valid Accuracy: 0.74355
time stamp: 5831.684406042099
[]

Validation Results
Global Steps: 27799
Valid Loss: 0.71368
Valid Accuracy: 0.74144
time stamp: 5873.011481523514
[]

Validation Results
Global Steps: 27999
Valid Loss: 0.71853
Valid Accuracy: 0.74327
time stamp: 5913.82634973526
[]

Validation Results
Global Steps: 28199
Valid Loss: 0.70252
Valid Accuracy: 0.74486
time stamp: 5954.836057424545
[]

Validation Results
Global Steps: 28399
Valid Loss: 0.71757
Valid Accuracy: 0.74180
time stamp: 5996.046481370926
[]

Validation Results
Global Steps: 28599
Valid Loss: 0.70888
Valid Accuracy: 0.74515
time stamp: 6037.181062936783
[]

Validation Results
Global Steps: 28799
Valid Loss: 0.71821
Valid Accuracy: 0.73926
time stamp: 6078.3229904174805
[]

Validation Results
Global Steps: 28999
Valid Loss: 0.72155
Valid Accuracy: 0.74333
time stamp: 6119.6519865989685
[]
best model saved: step =  29199 dev accu =  tensor(0.7475, device='cuda:0')

Validation Results
Global Steps: 29199
Valid Loss: 0.70122
Valid Accuracy: 0.74751
time stamp: 6160.754716157913
[]

Validation Results
Global Steps: 29399
Valid Loss: 0.71539
Valid Accuracy: 0.74206
time stamp: 6201.867258310318
[]
best model saved: step =  29599 dev accu =  tensor(0.7509, device='cuda:0')

Validation Results
Global Steps: 29599
Valid Loss: 0.69489
Valid Accuracy: 0.75093
time stamp: 6243.137896299362
[]

Validation Results
Global Steps: 29799
Valid Loss: 0.70126
Valid Accuracy: 0.74894
time stamp: 6284.295560598373
[]
best model saved: step =  29999 dev accu =  tensor(0.7533, device='cuda:0')

Validation Results
Global Steps: 29999
Valid Loss: 0.70811
Valid Accuracy: 0.75327
time stamp: 6325.2605764865875
total training step (k): 30.0
total training time (s): 6325.26131939888
total training time (ms): 1633503.4599609375
peak memory usage (MB): 12858
allocated memory usage (MB): 409354423
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |   12031 KB |   12858 MB |  399760 GB |  399760 GB |
|       from large pool |    6144 KB |   12846 MB |  396394 GB |  396394 GB |
|       from small pool |    5887 KB |      27 MB |    3365 GB |    3365 GB |
|---------------------------------------------------------------------------|
| Active memory         |   12031 KB |   12858 MB |  399760 GB |  399760 GB |
|       from large pool |    6144 KB |   12846 MB |  396394 GB |  396394 GB |
|       from small pool |    5887 KB |      27 MB |    3365 GB |    3365 GB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   13776 MB |   13776 MB |   13776 MB |       0 B  |
|       from large pool |   13748 MB |   13748 MB |   13748 MB |       0 B  |
|       from small pool |      28 MB |      28 MB |      28 MB |       0 B  |
|---------------------------------------------------------------------------|
| Non-releasable memory |   12545 KB |    2073 MB |  474806 GB |  474806 GB |
|       from large pool |   10240 KB |    2070 MB |  471291 GB |  471291 GB |
|       from small pool |    2305 KB |       6 MB |    3514 GB |    3514 GB |
|---------------------------------------------------------------------------|
| Allocations           |     398    |     670    |   35729 K  |   35728 K  |
|       from large pool |       2    |      93    |   13738 K  |   13738 K  |
|       from small pool |     396    |     659    |   21990 K  |   21989 K  |
|---------------------------------------------------------------------------|
| Active allocs         |     398    |     670    |   35729 K  |   35728 K  |
|       from large pool |       2    |      93    |   13738 K  |   13738 K  |
|       from small pool |     396    |     659    |   21990 K  |   21989 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      42    |      42    |      42    |       0    |
|       from large pool |      28    |      28    |      28    |       0    |
|       from small pool |      14    |      14    |      14    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |      10    |      38    |   17180 K  |   17180 K  |
|       from large pool |       2    |      20    |    6223 K  |    6223 K  |
|       from small pool |       8    |      28    |   10957 K  |   10957 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

loading the best model from: ./checkpoints/checkpoints-8/lra-news1/learnable.model
Evaluation Results
Loss: 0.70798
Accuracy: 0.75446
