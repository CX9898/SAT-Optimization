GPU list: [0, 1, 2, 3]
[
    {
        "learn_pos_emb": true,
        "tied_weights": false,
        "embedding_dim": 64,
        "transformer_dim": 64,
        "transformer_hidden_dim": 128,
        "head_dim": 32,
        "num_head": 2,
        "num_layers": 4,
        "vocab_size": 512,
        "max_seq_len": 1024,
        "dropout_prob": 0.1,
        "attention_dropout": 0.1,
        "pooling_mode": "MEAN",
        "num_classes": 2,
        "block_size": 32,
        "batch_size": 128,
        "density": 0.05,
        "mixed_precision": true,
        "random_seed": 3,
        "task": "lra-yelp1"
    },
    {
        "batch_size": 512,
        "learning_rate": 0.0007,
        "warmup": 80,
        "lr_decay": "linear",
        "weight_decay": 0,
        "eval_frequency": 200,
        "num_train_steps": 30000,
        "num_init_steps": 17000,
        "num_eval_steps": 200,
        "num_dense_train_steps": 1000,
        "patience": 10,
        "attn_loss_scale": 0.01
    }
]
attn_mask compile
attn_mask compile
attn_mask compile
attn_mask compile
DataParallel(
  (module): ModelForSC(
    (model): Model(
      (embeddings): Embeddings(
        (word_embeddings): Embedding(512, 64)
        (position_embeddings): Embedding(1024, 64)
        (dropout): Dropout(p=0.1, inplace=False)
      )
      (transformer_0): TransformerLayer(
        (norm1): LayerNorm((64,), eps=1e-05, elementwise_affine=True)
        (mha): Attention(
          (W_q): Linear(in_features=64, out_features=64, bias=True)
          (W_k): Linear(in_features=64, out_features=64, bias=True)
          (W_v): Linear(in_features=64, out_features=64, bias=True)
          (avg_pool): AvgPool2d(kernel_size=32, stride=32, padding=0)
          (MSEloss): MSELoss()
          (attn): CUDAMaskAttention()
          (ff): Linear(in_features=64, out_features=64, bias=True)
        )
        (dropout1): Dropout(p=0.1, inplace=False)
        (norm2): LayerNorm((64,), eps=1e-05, elementwise_affine=True)
        (mlpblock): Sequential(
          (0): Linear(in_features=64, out_features=128, bias=True)
          (1): GELU(approximate='none')
          (2): Dropout(p=0.1, inplace=False)
          (3): Linear(in_features=128, out_features=64, bias=True)
          (4): Dropout(p=0.1, inplace=False)
        )
      )
      (transformer_1): TransformerLayer(
        (norm1): LayerNorm((64,), eps=1e-05, elementwise_affine=True)
        (mha): Attention(
          (W_q): Linear(in_features=64, out_features=64, bias=True)
          (W_k): Linear(in_features=64, out_features=64, bias=True)
          (W_v): Linear(in_features=64, out_features=64, bias=True)
          (avg_pool): AvgPool2d(kernel_size=32, stride=32, padding=0)
          (MSEloss): MSELoss()
          (attn): CUDAMaskAttention()
          (ff): Linear(in_features=64, out_features=64, bias=True)
        )
        (dropout1): Dropout(p=0.1, inplace=False)
        (norm2): LayerNorm((64,), eps=1e-05, elementwise_affine=True)
        (mlpblock): Sequential(
          (0): Linear(in_features=64, out_features=128, bias=True)
          (1): GELU(approximate='none')
          (2): Dropout(p=0.1, inplace=False)
          (3): Linear(in_features=128, out_features=64, bias=True)
          (4): Dropout(p=0.1, inplace=False)
        )
      )
      (transformer_2): TransformerLayer(
        (norm1): LayerNorm((64,), eps=1e-05, elementwise_affine=True)
        (mha): Attention(
          (W_q): Linear(in_features=64, out_features=64, bias=True)
          (W_k): Linear(in_features=64, out_features=64, bias=True)
          (W_v): Linear(in_features=64, out_features=64, bias=True)
          (avg_pool): AvgPool2d(kernel_size=32, stride=32, padding=0)
          (MSEloss): MSELoss()
          (attn): CUDAMaskAttention()
          (ff): Linear(in_features=64, out_features=64, bias=True)
        )
        (dropout1): Dropout(p=0.1, inplace=False)
        (norm2): LayerNorm((64,), eps=1e-05, elementwise_affine=True)
        (mlpblock): Sequential(
          (0): Linear(in_features=64, out_features=128, bias=True)
          (1): GELU(approximate='none')
          (2): Dropout(p=0.1, inplace=False)
          (3): Linear(in_features=128, out_features=64, bias=True)
          (4): Dropout(p=0.1, inplace=False)
        )
      )
      (transformer_3): TransformerLayer(
        (norm1): LayerNorm((64,), eps=1e-05, elementwise_affine=True)
        (mha): Attention(
          (W_q): Linear(in_features=64, out_features=64, bias=True)
          (W_k): Linear(in_features=64, out_features=64, bias=True)
          (W_v): Linear(in_features=64, out_features=64, bias=True)
          (avg_pool): AvgPool2d(kernel_size=32, stride=32, padding=0)
          (MSEloss): MSELoss()
          (attn): CUDAMaskAttention()
          (ff): Linear(in_features=64, out_features=64, bias=True)
        )
        (dropout1): Dropout(p=0.1, inplace=False)
        (norm2): LayerNorm((64,), eps=1e-05, elementwise_affine=True)
        (mlpblock): Sequential(
          (0): Linear(in_features=64, out_features=128, bias=True)
          (1): GELU(approximate='none')
          (2): Dropout(p=0.1, inplace=False)
          (3): Linear(in_features=128, out_features=64, bias=True)
          (4): Dropout(p=0.1, inplace=False)
        )
      )
      (norm): LayerNorm((64,), eps=1e-05, elementwise_affine=True)
    )
    (seq_classifer): SCHead(
      (mlpblock): Sequential(
        (0): Linear(in_features=64, out_features=128, bias=True)
        (1): ReLU()
        (2): Linear(in_features=128, out_features=2, bias=True)
      )
    )
  )
)
parameter_size: [torch.Size([512, 64]), torch.Size([1024, 64]), torch.Size([64]), torch.Size([64]), torch.Size([32, 32]), torch.Size([64, 64]), torch.Size([64]), torch.Size([64, 64]), torch.Size([64]), torch.Size([64, 64]), torch.Size([64]), torch.Size([64, 64]), torch.Size([64]), torch.Size([64]), torch.Size([64]), torch.Size([128, 64]), torch.Size([128]), torch.Size([64, 128]), torch.Size([64]), torch.Size([64]), torch.Size([64]), torch.Size([32, 32]), torch.Size([64, 64]), torch.Size([64]), torch.Size([64, 64]), torch.Size([64]), torch.Size([64, 64]), torch.Size([64]), torch.Size([64, 64]), torch.Size([64]), torch.Size([64]), torch.Size([64]), torch.Size([128, 64]), torch.Size([128]), torch.Size([64, 128]), torch.Size([64]), torch.Size([64]), torch.Size([64]), torch.Size([32, 32]), torch.Size([64, 64]), torch.Size([64]), torch.Size([64, 64]), torch.Size([64]), torch.Size([64, 64]), torch.Size([64]), torch.Size([64, 64]), torch.Size([64]), torch.Size([64]), torch.Size([64]), torch.Size([128, 64]), torch.Size([128]), torch.Size([64, 128]), torch.Size([64]), torch.Size([64]), torch.Size([64]), torch.Size([32, 32]), torch.Size([64, 64]), torch.Size([64]), torch.Size([64, 64]), torch.Size([64]), torch.Size([64, 64]), torch.Size([64]), torch.Size([64, 64]), torch.Size([64]), torch.Size([64]), torch.Size([64]), torch.Size([128, 64]), torch.Size([128]), torch.Size([64, 128]), torch.Size([64]), torch.Size([64]), torch.Size([64]), torch.Size([128, 64]), torch.Size([128]), torch.Size([2, 128]), torch.Size([2])]
num_parameter: 244994
Loaded ../Skyformer/data/lra_processed/lra-yelp1.train.pickle... size=560000
Loaded ../Skyformer/data/lra_processed/lra-yelp1.dev.pickle... size=38000
Loaded ../Skyformer/data/lra_processed/lra-yelp1.test.pickle... size=38000
accumu_steps=1
[tensor([29.9132, 29.9131, 29.9131, 29.9131], device='cuda:0',
       grad_fn=<GatherBackward>), tensor([32.3725, 32.3726, 32.3726, 32.3726], device='cuda:0',
       grad_fn=<GatherBackward>), tensor([28.5765, 28.5765, 28.5765, 28.5765], device='cuda:0',
       grad_fn=<GatherBackward>), tensor([30.4274, 30.4274, 30.4274, 30.4274], device='cuda:0',
       grad_fn=<GatherBackward>)]
best model saved: step =  199 dev accu =  tensor(0.7163, device='cuda:0')

Validation Results
Global Steps: 199
Valid Loss: 0.55367
Valid Accuracy: 0.71634
time stamp: 164.7090287208557
[tensor([12.9992, 12.9992, 12.9992, 12.9992], device='cuda:0',
       grad_fn=<GatherBackward>), tensor([14.1485, 14.1485, 14.1485, 14.1485], device='cuda:0',
       grad_fn=<GatherBackward>), tensor([12.3423, 12.3424, 12.3424, 12.3423], device='cuda:0',
       grad_fn=<GatherBackward>), tensor([13.2770, 13.2770, 13.2770, 13.2770], device='cuda:0',
       grad_fn=<GatherBackward>)]
best model saved: step =  399 dev accu =  tensor(0.7304, device='cuda:0')

Validation Results
Global Steps: 399
Valid Loss: 0.53616
Valid Accuracy: 0.73044
time stamp: 328.25686860084534
[tensor([6.5431, 6.5431, 6.5431, 6.5431], device='cuda:0',
       grad_fn=<GatherBackward>), tensor([7.1221, 7.1221, 7.1220, 7.1221], device='cuda:0',
       grad_fn=<GatherBackward>), tensor([6.1948, 6.1948, 6.1948, 6.1948], device='cuda:0',
       grad_fn=<GatherBackward>), tensor([6.7126, 6.7126, 6.7126, 6.7126], device='cuda:0',
       grad_fn=<GatherBackward>)]

Validation Results
Global Steps: 599
Valid Loss: 0.54332
Valid Accuracy: 0.72729
time stamp: 492.37893772125244
[tensor([3.7003, 3.7003, 3.7002, 3.7003], device='cuda:0',
       grad_fn=<GatherBackward>), tensor([4.0113, 4.0112, 4.0113, 4.0112], device='cuda:0',
       grad_fn=<GatherBackward>), tensor([3.5024, 3.5024, 3.5024, 3.5024], device='cuda:0',
       grad_fn=<GatherBackward>), tensor([3.8146, 3.8146, 3.8145, 3.8145], device='cuda:0',
       grad_fn=<GatherBackward>)]
best model saved: step =  799 dev accu =  tensor(0.7356, device='cuda:0')

Validation Results
Global Steps: 799
Valid Loss: 0.52467
Valid Accuracy: 0.73561
time stamp: 655.8868248462677
[tensor([2.2966, 2.2965, 2.2965, 2.2965], device='cuda:0',
       grad_fn=<GatherBackward>), tensor([2.4723, 2.4723, 2.4723, 2.4723], device='cuda:0',
       grad_fn=<GatherBackward>), tensor([2.1774, 2.1774, 2.1774, 2.1774], device='cuda:0',
       grad_fn=<GatherBackward>), tensor([2.3795, 2.3795, 2.3795, 2.3795], device='cuda:0',
       grad_fn=<GatherBackward>)]
best model saved: step =  999 dev accu =  tensor(0.7376, device='cuda:0')

Validation Results
Global Steps: 999
Valid Loss: 0.52289
Valid Accuracy: 0.73763
time stamp: 820.3637819290161
[tensor([1.5358, 1.5358, 1.5357, 1.5357], device='cuda:0',
       grad_fn=<GatherBackward>), tensor([1.6391, 1.6391, 1.6391, 1.6391], device='cuda:0',
       grad_fn=<GatherBackward>), tensor([1.4604, 1.4604, 1.4604, 1.4604], device='cuda:0',
       grad_fn=<GatherBackward>), tensor([1.5991, 1.5991, 1.5991, 1.5991], device='cuda:0',
       grad_fn=<GatherBackward>)]

Validation Results
Global Steps: 1199
Valid Loss: 0.55155
Valid Accuracy: 0.72704
time stamp: 985.4279861450195
[tensor([1.0902, 1.0902, 1.0902, 1.0902], device='cuda:0',
       grad_fn=<GatherBackward>), tensor([1.1529, 1.1529, 1.1529, 1.1529], device='cuda:0',
       grad_fn=<GatherBackward>), tensor([1.0404, 1.0404, 1.0404, 1.0404], device='cuda:0',
       grad_fn=<GatherBackward>), tensor([1.1402, 1.1402, 1.1402, 1.1402], device='cuda:0',
       grad_fn=<GatherBackward>)]
best model saved: step =  1399 dev accu =  tensor(0.7387, device='cuda:0')

Validation Results
Global Steps: 1399
Valid Loss: 0.52331
Valid Accuracy: 0.73866
time stamp: 1150.081241607666
[tensor([0.8114, 0.8114, 0.8114, 0.8114], device='cuda:0',
       grad_fn=<GatherBackward>), tensor([0.8506, 0.8506, 0.8506, 0.8506], device='cuda:0',
       grad_fn=<GatherBackward>), tensor([0.7773, 0.7773, 0.7773, 0.7773], device='cuda:0',
       grad_fn=<GatherBackward>), tensor([0.8517, 0.8517, 0.8517, 0.8517], device='cuda:0',
       grad_fn=<GatherBackward>)]
best model saved: step =  1599 dev accu =  tensor(0.7428, device='cuda:0')

Validation Results
Global Steps: 1599
Valid Loss: 0.51459
Valid Accuracy: 0.74277
time stamp: 1315.50616812706
[tensor([0.6267, 0.6267, 0.6268, 0.6268], device='cuda:0',
       grad_fn=<GatherBackward>), tensor([0.6521, 0.6520, 0.6520, 0.6520], device='cuda:0',
       grad_fn=<GatherBackward>), tensor([0.6026, 0.6026, 0.6026, 0.6026], device='cuda:0',
       grad_fn=<GatherBackward>), tensor([0.6597, 0.6597, 0.6597, 0.6597], device='cuda:0',
       grad_fn=<GatherBackward>)]

Validation Results
Global Steps: 1799
Valid Loss: 0.53042
Valid Accuracy: 0.73350
time stamp: 1480.653531551361
[tensor([0.4982, 0.4982, 0.4982, 0.4982], device='cuda:0',
       grad_fn=<GatherBackward>), tensor([0.5152, 0.5152, 0.5152, 0.5152], device='cuda:0',
       grad_fn=<GatherBackward>), tensor([0.4806, 0.4806, 0.4806, 0.4806], device='cuda:0',
       grad_fn=<GatherBackward>), tensor([0.5253, 0.5253, 0.5253, 0.5253], device='cuda:0',
       grad_fn=<GatherBackward>)]
best model saved: step =  1999 dev accu =  tensor(0.7443, device='cuda:0')

Validation Results
Global Steps: 1999
Valid Loss: 0.51695
Valid Accuracy: 0.74429
time stamp: 1645.4650526046753
[tensor([0.4049, 0.4049, 0.4049, 0.4048], device='cuda:0',
       grad_fn=<GatherBackward>), tensor([0.4167, 0.4167, 0.4167, 0.4167], device='cuda:0',
       grad_fn=<GatherBackward>), tensor([0.3916, 0.3916, 0.3916, 0.3916], device='cuda:0',
       grad_fn=<GatherBackward>), tensor([0.4272, 0.4272, 0.4272, 0.4272], device='cuda:0',
       grad_fn=<GatherBackward>)]

Validation Results
Global Steps: 2199
Valid Loss: 0.51478
Valid Accuracy: 0.74056
time stamp: 1810.2098016738892
[tensor([0.3345, 0.3345, 0.3345, 0.3345], device='cuda:0',
       grad_fn=<GatherBackward>), tensor([0.3433, 0.3433, 0.3433, 0.3433], device='cuda:0',
       grad_fn=<GatherBackward>), tensor([0.3244, 0.3243, 0.3243, 0.3243], device='cuda:0',
       grad_fn=<GatherBackward>), tensor([0.3530, 0.3530, 0.3530, 0.3530], device='cuda:0',
       grad_fn=<GatherBackward>)]

Validation Results
Global Steps: 2399
Valid Loss: 0.51586
Valid Accuracy: 0.74242
time stamp: 1975.8910949230194
[tensor([0.2798, 0.2799, 0.2798, 0.2799], device='cuda:0',
       grad_fn=<GatherBackward>), tensor([0.2868, 0.2868, 0.2868, 0.2868], device='cuda:0',
       grad_fn=<GatherBackward>), tensor([0.2719, 0.2719, 0.2719, 0.2719], device='cuda:0',
       grad_fn=<GatherBackward>), tensor([0.2952, 0.2952, 0.2952, 0.2952], device='cuda:0',
       grad_fn=<GatherBackward>)]
best model saved: step =  2599 dev accu =  tensor(0.7452, device='cuda:0')

Validation Results
Global Steps: 2599
Valid Loss: 0.51786
Valid Accuracy: 0.74521
time stamp: 2142.274498939514
[tensor([0.2363, 0.2363, 0.2363, 0.2363], device='cuda:0',
       grad_fn=<GatherBackward>), tensor([0.2421, 0.2421, 0.2421, 0.2421], device='cuda:0',
       grad_fn=<GatherBackward>), tensor([0.2301, 0.2301, 0.2301, 0.2301], device='cuda:0',
       grad_fn=<GatherBackward>), tensor([0.2490, 0.2490, 0.2490, 0.2490], device='cuda:0',
       grad_fn=<GatherBackward>)]

Validation Results
Global Steps: 2799
Valid Loss: 0.51782
Valid Accuracy: 0.73989
time stamp: 2308.169050693512
[tensor([0.2010, 0.2010, 0.2010, 0.2010], device='cuda:0',
       grad_fn=<GatherBackward>), tensor([0.2060, 0.2060, 0.2060, 0.2060], device='cuda:0',
       grad_fn=<GatherBackward>), tensor([0.1960, 0.1960, 0.1960, 0.1960], device='cuda:0',
       grad_fn=<GatherBackward>), tensor([0.2114, 0.2114, 0.2115, 0.2115], device='cuda:0',
       grad_fn=<GatherBackward>)]
best model saved: step =  2999 dev accu =  tensor(0.7483, device='cuda:0')

Validation Results
Global Steps: 2999
Valid Loss: 0.50813
Valid Accuracy: 0.74834
time stamp: 2473.496682167053
[tensor([0.1718, 0.1717, 0.1717, 0.1718], device='cuda:0',
       grad_fn=<GatherBackward>), tensor([0.1764, 0.1764, 0.1764, 0.1764], device='cuda:0',
       grad_fn=<GatherBackward>), tensor([0.1677, 0.1677, 0.1677, 0.1677], device='cuda:0',
       grad_fn=<GatherBackward>), tensor([0.1804, 0.1804, 0.1804, 0.1804], device='cuda:0',
       grad_fn=<GatherBackward>)]

Validation Results
Global Steps: 3199
Valid Loss: 0.50622
Valid Accuracy: 0.74729
time stamp: 2639.8941473960876
[tensor([0.1473, 0.1473, 0.1473, 0.1473], device='cuda:0',
       grad_fn=<GatherBackward>), tensor([0.1516, 0.1516, 0.1516, 0.1516], device='cuda:0',
       grad_fn=<GatherBackward>), tensor([0.1440, 0.1440, 0.1440, 0.1440], device='cuda:0',
       grad_fn=<GatherBackward>), tensor([0.1545, 0.1545, 0.1545, 0.1545], device='cuda:0',
       grad_fn=<GatherBackward>)]

Validation Results
Global Steps: 3399
Valid Loss: 0.50775
Valid Accuracy: 0.74706
time stamp: 2804.6658108234406
[tensor([0.1267, 0.1267, 0.1267, 0.1267], device='cuda:0',
       grad_fn=<GatherBackward>), tensor([0.1307, 0.1307, 0.1307, 0.1307], device='cuda:0',
       grad_fn=<GatherBackward>), tensor([0.1240, 0.1240, 0.1240, 0.1240], device='cuda:0',
       grad_fn=<GatherBackward>), tensor([0.1326, 0.1326, 0.1326, 0.1326], device='cuda:0',
       grad_fn=<GatherBackward>)]
best model saved: step =  3599 dev accu =  tensor(0.7490, device='cuda:0')

Validation Results
Global Steps: 3599
Valid Loss: 0.50818
Valid Accuracy: 0.74903
time stamp: 2969.02827000618
[tensor([0.1092, 0.1092, 0.1092, 0.1092], device='cuda:0',
       grad_fn=<GatherBackward>), tensor([0.1129, 0.1129, 0.1129, 0.1129], device='cuda:0',
       grad_fn=<GatherBackward>), tensor([0.1070, 0.1070, 0.1070, 0.1070], device='cuda:0',
       grad_fn=<GatherBackward>), tensor([0.1141, 0.1141, 0.1141, 0.1141], device='cuda:0',
       grad_fn=<GatherBackward>)]

Validation Results
Global Steps: 3799
Valid Loss: 0.50661
Valid Accuracy: 0.74641
time stamp: 3134.1109137535095
[tensor([0.0942, 0.0942, 0.0942, 0.0942], device='cuda:0',
       grad_fn=<GatherBackward>), tensor([0.0977, 0.0977, 0.0977, 0.0977], device='cuda:0',
       grad_fn=<GatherBackward>), tensor([0.0924, 0.0924, 0.0924, 0.0924], device='cuda:0',
       grad_fn=<GatherBackward>), tensor([0.0982, 0.0982, 0.0982, 0.0982], device='cuda:0',
       grad_fn=<GatherBackward>)]

Validation Results
Global Steps: 3999
Valid Loss: 0.50855
Valid Accuracy: 0.74552
time stamp: 3300.738522529602
[tensor([0.0813, 0.0813, 0.0813, 0.0813], device='cuda:0',
       grad_fn=<GatherBackward>), tensor([0.0846, 0.0846, 0.0846, 0.0846], device='cuda:0',
       grad_fn=<GatherBackward>), tensor([0.0798, 0.0798, 0.0798, 0.0798], device='cuda:0',
       grad_fn=<GatherBackward>), tensor([0.0847, 0.0847, 0.0847, 0.0847], device='cuda:0',
       grad_fn=<GatherBackward>)]
best model saved: step =  4199 dev accu =  tensor(0.7493, device='cuda:0')

Validation Results
Global Steps: 4199
Valid Loss: 0.50234
Valid Accuracy: 0.74931
time stamp: 3465.8465197086334
[tensor([0.0702, 0.0702, 0.0702, 0.0702], device='cuda:0',
       grad_fn=<GatherBackward>), tensor([0.0733, 0.0733, 0.0733, 0.0733], device='cuda:0',
       grad_fn=<GatherBackward>), tensor([0.0689, 0.0689, 0.0689, 0.0689], device='cuda:0',
       grad_fn=<GatherBackward>), tensor([0.0730, 0.0730, 0.0730, 0.0730], device='cuda:0',
       grad_fn=<GatherBackward>)]
best model saved: step =  4399 dev accu =  tensor(0.7514, device='cuda:0')

Validation Results
Global Steps: 4399
Valid Loss: 0.50107
Valid Accuracy: 0.75141
time stamp: 3631.661233186722
module.model.transformer_0.mha.pattern saved
module.model.transformer_1.mha.pattern saved
module.model.transformer_2.mha.pattern saved
module.model.transformer_3.mha.pattern saved
./pickle/lra-yelp1/module.model.transformer_0.mha.pattern.pickle
tensor([ 198,  759,  627,  231,   66,  363,   99,  957,  594,  858,  528,  561,
         825,  924,  396,   33,  990,  165,  132,  429,  495,  891,  792,  462,
         693,  297, 1023,  330,  264,    0,  726,  660,  497,  559,  156,  900,
         595,  626,  535,  752,  794,  856,  958,  989,   48,  513,  447, 1005,
         210,  582,  111], device='cuda:0')
tensor(51, device='cuda:0')
block_attn_mask compile
./pickle/lra-yelp1/module.model.transformer_1.mha.pattern.pickle
tensor([  66,  462,  528,  858,  396,  495,  825,  429,  693,  264,    0,  627,
        1023,  330,  726,  792,  957,  165,  891,  297,  231,  363,   99,  924,
         594,  561,   33,  660,  990,  132,  759,  198,  121,  803,   16,  512,
         407,  748,  831, 1017,  497,  559,  639, 1011,  127,  995,  107,  355,
         403,  620,  280], device='cuda:0')
tensor(51, device='cuda:0')
block_attn_mask compile
./pickle/lra-yelp1/module.model.transformer_2.mha.pattern.pickle
tensor([ 825,  891,    0,  264,  198,   33,  660,  759,  363,  594,  165,  231,
         330,  462,   99,  132,  990,  627,  429,  726,  528,  924,  792,   66,
         693,  396,  297, 1023,  858,  495,  561,  957,  191,  997,  232,  263,
         366,  459,  347,  874,  479, 1006,  569,  817,  246,  711,  315,  873,
           1,   32,   49], device='cuda:0')
tensor(51, device='cuda:0')
block_attn_mask compile
./pickle/lra-yelp1/module.model.transformer_3.mha.pattern.pickle
tensor([ 759,  528,  693,  363,  924, 1023,  594,  396,   66,  297,  990,  429,
         198,  462,   99,  726,  264,  330,    0,   33,  792,  165,  627,  891,
         957,  495,  825,  858,  132,  561,  660,  231,  275,  616,   22,  704,
         605,  946,  377,  811,  213,  678,  664,  788,  125,  931,   46,  449,
         319, 1001,  862], device='cuda:0')
tensor(51, device='cuda:0')
block_attn_mask compile
total pattern searching time (s): 0.0951545238494873
[]

Validation Results
Global Steps: 4599
Valid Loss: 0.54666
Valid Accuracy: 0.72629
time stamp: 3772.5952286720276
[]

Validation Results
Global Steps: 4799
Valid Loss: 0.51508
Valid Accuracy: 0.74445
time stamp: 3807.3459532260895
[]

Validation Results
Global Steps: 4999
Valid Loss: 0.51844
Valid Accuracy: 0.73677
time stamp: 3841.9071209430695
[]

Validation Results
Global Steps: 5199
Valid Loss: 0.50438
Valid Accuracy: 0.75002
time stamp: 3876.815193414688
[]
best model saved: step =  5399 dev accu =  tensor(0.7523, device='cuda:0')

Validation Results
Global Steps: 5399
Valid Loss: 0.50336
Valid Accuracy: 0.75227
time stamp: 3911.532970190048
[]

Validation Results
Global Steps: 5599
Valid Loss: 0.49937
Valid Accuracy: 0.75201
time stamp: 3946.445384502411
[]
best model saved: step =  5799 dev accu =  tensor(0.7526, device='cuda:0')

Validation Results
Global Steps: 5799
Valid Loss: 0.50304
Valid Accuracy: 0.75262
time stamp: 3981.048417329788
[]
best model saved: step =  5999 dev accu =  tensor(0.7566, device='cuda:0')

Validation Results
Global Steps: 5999
Valid Loss: 0.49021
Valid Accuracy: 0.75660
time stamp: 4016.312542438507
[]
best model saved: step =  6199 dev accu =  tensor(0.7604, device='cuda:0')

Validation Results
Global Steps: 6199
Valid Loss: 0.48722
Valid Accuracy: 0.76035
time stamp: 4051.0777530670166
[]

Validation Results
Global Steps: 6399
Valid Loss: 0.48851
Valid Accuracy: 0.75919
time stamp: 4086.096588611603
[]
best model saved: step =  6599 dev accu =  tensor(0.7613, device='cuda:0')

Validation Results
Global Steps: 6599
Valid Loss: 0.48819
Valid Accuracy: 0.76130
time stamp: 4121.154568433762
[]

Validation Results
Global Steps: 6799
Valid Loss: 0.48783
Valid Accuracy: 0.75916
time stamp: 4156.022045135498
[]
best model saved: step =  6999 dev accu =  tensor(0.7662, device='cuda:0')

Validation Results
Global Steps: 6999
Valid Loss: 0.47935
Valid Accuracy: 0.76624
time stamp: 4190.859961271286
[]

Validation Results
Global Steps: 7199
Valid Loss: 0.48013
Valid Accuracy: 0.76562
time stamp: 4225.640887737274
[]

Validation Results
Global Steps: 7399
Valid Loss: 0.48280
Valid Accuracy: 0.76258
time stamp: 4260.382040739059
[]
best model saved: step =  7599 dev accu =  tensor(0.7663, device='cuda:0')

Validation Results
Global Steps: 7599
Valid Loss: 0.47614
Valid Accuracy: 0.76628
time stamp: 4294.89435005188
[]

Validation Results
Global Steps: 7799
Valid Loss: 0.49405
Valid Accuracy: 0.75553
time stamp: 4330.361143112183
[]
best model saved: step =  7999 dev accu =  tensor(0.7695, device='cuda:0')

Validation Results
Global Steps: 7999
Valid Loss: 0.47406
Valid Accuracy: 0.76951
time stamp: 4364.980163097382
[]

Validation Results
Global Steps: 8199
Valid Loss: 0.49096
Valid Accuracy: 0.75863
time stamp: 4399.626080989838
[]

Validation Results
Global Steps: 8399
Valid Loss: 0.47278
Valid Accuracy: 0.76852
time stamp: 4434.654178142548
[]

Validation Results
Global Steps: 8599
Valid Loss: 0.48834
Valid Accuracy: 0.76234
time stamp: 4469.57678103447
[]

Validation Results
Global Steps: 8799
Valid Loss: 0.47947
Valid Accuracy: 0.76704
time stamp: 4504.640233755112
[]
best model saved: step =  8999 dev accu =  tensor(0.7714, device='cuda:0')

Validation Results
Global Steps: 8999
Valid Loss: 0.47302
Valid Accuracy: 0.77142
time stamp: 4539.579573631287
[]
best model saved: step =  9199 dev accu =  tensor(0.7734, device='cuda:0')

Validation Results
Global Steps: 9199
Valid Loss: 0.46791
Valid Accuracy: 0.77338
time stamp: 4574.451384305954
[]
best model saved: step =  9399 dev accu =  tensor(0.7742, device='cuda:0')

Validation Results
Global Steps: 9399
Valid Loss: 0.46468
Valid Accuracy: 0.77422
time stamp: 4609.515875339508
[]

Validation Results
Global Steps: 9599
Valid Loss: 0.46998
Valid Accuracy: 0.77104
time stamp: 4644.482824087143
[]

Validation Results
Global Steps: 9799
Valid Loss: 0.46872
Valid Accuracy: 0.77175
time stamp: 4679.371395349503
[]

Validation Results
Global Steps: 9999
Valid Loss: 0.48759
Valid Accuracy: 0.76190
time stamp: 4714.1582844257355
[]

Validation Results
Global Steps: 10199
Valid Loss: 0.49624
Valid Accuracy: 0.75098
time stamp: 4749.114723920822
[]

Validation Results
Global Steps: 10399
Valid Loss: 0.49614
Valid Accuracy: 0.75428
time stamp: 4784.224474668503
[]

Validation Results
Global Steps: 10599
Valid Loss: 0.47175
Valid Accuracy: 0.77157
time stamp: 4818.909488916397
[]

Validation Results
Global Steps: 10799
Valid Loss: 0.47536
Valid Accuracy: 0.76969
time stamp: 4854.025160551071
[]

Validation Results
Global Steps: 10999
Valid Loss: 0.47811
Valid Accuracy: 0.76474
time stamp: 4889.126382827759
[]

Validation Results
Global Steps: 11199
Valid Loss: 0.47611
Valid Accuracy: 0.76979
time stamp: 4923.753400087357
[]

Validation Results
Global Steps: 11399
Valid Loss: 0.47177
Valid Accuracy: 0.77159
time stamp: 4958.603413820267
[]
best model saved: step =  11599 dev accu =  tensor(0.7759, device='cuda:0')

Validation Results
Global Steps: 11599
Valid Loss: 0.46008
Valid Accuracy: 0.77594
time stamp: 4993.090058803558
[]
best model saved: step =  11799 dev accu =  tensor(0.7776, device='cuda:0')

Validation Results
Global Steps: 11799
Valid Loss: 0.45950
Valid Accuracy: 0.77763
time stamp: 5028.075644731522
[]

Validation Results
Global Steps: 11999
Valid Loss: 0.46041
Valid Accuracy: 0.77712
time stamp: 5062.687014341354
[]
best model saved: step =  12199 dev accu =  tensor(0.7789, device='cuda:0')

Validation Results
Global Steps: 12199
Valid Loss: 0.45840
Valid Accuracy: 0.77890
time stamp: 5097.745792627335
[]
best model saved: step =  12399 dev accu =  tensor(0.7795, device='cuda:0')

Validation Results
Global Steps: 12399
Valid Loss: 0.45785
Valid Accuracy: 0.77951
time stamp: 5133.107476949692
[]
best model saved: step =  12599 dev accu =  tensor(0.7817, device='cuda:0')

Validation Results
Global Steps: 12599
Valid Loss: 0.45674
Valid Accuracy: 0.78169
time stamp: 5167.895118713379
[]

Validation Results
Global Steps: 12799
Valid Loss: 0.45729
Valid Accuracy: 0.78117
time stamp: 5202.554520606995
[]
best model saved: step =  12999 dev accu =  tensor(0.7823, device='cuda:0')

Validation Results
Global Steps: 12999
Valid Loss: 0.45374
Valid Accuracy: 0.78234
time stamp: 5237.62122797966
[]

Validation Results
Global Steps: 13199
Valid Loss: 0.45624
Valid Accuracy: 0.78128
time stamp: 5272.8054213523865
[]
best model saved: step =  13399 dev accu =  tensor(0.7838, device='cuda:0')

Validation Results
Global Steps: 13399
Valid Loss: 0.45250
Valid Accuracy: 0.78379
time stamp: 5307.624606370926
[]

Validation Results
Global Steps: 13599
Valid Loss: 0.49969
Valid Accuracy: 0.75976
time stamp: 5342.900285720825
[]
best model saved: step =  13799 dev accu =  tensor(0.7839, device='cuda:0')

Validation Results
Global Steps: 13799
Valid Loss: 0.45063
Valid Accuracy: 0.78394
time stamp: 5377.755070924759
[]

Validation Results
Global Steps: 13999
Valid Loss: 0.46953
Valid Accuracy: 0.77349
time stamp: 5412.636221408844
[]

Validation Results
Global Steps: 14199
Valid Loss: 0.45102
Valid Accuracy: 0.78342
time stamp: 5447.602341413498
[]
best model saved: step =  14399 dev accu =  tensor(0.7844, device='cuda:0')

Validation Results
Global Steps: 14399
Valid Loss: 0.44837
Valid Accuracy: 0.78438
time stamp: 5482.608524084091
[]

Validation Results
Global Steps: 14599
Valid Loss: 0.45284
Valid Accuracy: 0.78385
time stamp: 5517.269462585449
[]

Validation Results
Global Steps: 14799
Valid Loss: 0.45609
Valid Accuracy: 0.77896
time stamp: 5552.232306241989
[]
best model saved: step =  14999 dev accu =  tensor(0.7850, device='cuda:0')

Validation Results
Global Steps: 14999
Valid Loss: 0.44919
Valid Accuracy: 0.78498
time stamp: 5586.936300754547
[]
best model saved: step =  15199 dev accu =  tensor(0.7852, device='cuda:0')

Validation Results
Global Steps: 15199
Valid Loss: 0.44929
Valid Accuracy: 0.78519
time stamp: 5621.8012611866
[]
best model saved: step =  15399 dev accu =  tensor(0.7858, device='cuda:0')

Validation Results
Global Steps: 15399
Valid Loss: 0.44391
Valid Accuracy: 0.78579
time stamp: 5656.893394470215
[]

Validation Results
Global Steps: 15599
Valid Loss: 0.45635
Valid Accuracy: 0.78345
time stamp: 5691.671442985535
[]

Validation Results
Global Steps: 15799
Valid Loss: 0.45245
Valid Accuracy: 0.78354
time stamp: 5726.369500398636
[]
best model saved: step =  15999 dev accu =  tensor(0.7862, device='cuda:0')

Validation Results
Global Steps: 15999
Valid Loss: 0.45014
Valid Accuracy: 0.78622
time stamp: 5761.291885375977
[]
best model saved: step =  16199 dev accu =  tensor(0.7864, device='cuda:0')

Validation Results
Global Steps: 16199
Valid Loss: 0.44897
Valid Accuracy: 0.78642
time stamp: 5796.636745452881
[]

Validation Results
Global Steps: 16399
Valid Loss: 0.44962
Valid Accuracy: 0.78210
time stamp: 5831.561411619186
[]

Validation Results
Global Steps: 16599
Valid Loss: 0.45963
Valid Accuracy: 0.78066
time stamp: 5866.6464965343475
[]
best model saved: step =  16799 dev accu =  tensor(0.7902, device='cuda:0')

Validation Results
Global Steps: 16799
Valid Loss: 0.44271
Valid Accuracy: 0.79018
time stamp: 5901.7057321071625
[]
best model saved: step =  16999 dev accu =  tensor(0.7915, device='cuda:0')

Validation Results
Global Steps: 16999
Valid Loss: 0.44103
Valid Accuracy: 0.79151
time stamp: 5936.942234754562
[]

Validation Results
Global Steps: 17199
Valid Loss: 0.43992
Valid Accuracy: 0.79031
time stamp: 5971.690028190613
[]

Validation Results
Global Steps: 17399
Valid Loss: 0.44342
Valid Accuracy: 0.78752
time stamp: 6006.39443898201
[]
best model saved: step =  17599 dev accu =  tensor(0.7945, device='cuda:0')

Validation Results
Global Steps: 17599
Valid Loss: 0.44196
Valid Accuracy: 0.79453
time stamp: 6041.295851230621
[]

Validation Results
Global Steps: 17799
Valid Loss: 0.44489
Valid Accuracy: 0.79005
time stamp: 6076.326136827469
[]

Validation Results
Global Steps: 17999
Valid Loss: 0.43093
Valid Accuracy: 0.79445
time stamp: 6111.272979021072
[]

Validation Results
Global Steps: 18199
Valid Loss: 0.43895
Valid Accuracy: 0.79285
time stamp: 6146.345307350159
[]

Validation Results
Global Steps: 18399
Valid Loss: 0.43384
Valid Accuracy: 0.79447
time stamp: 6180.833552837372
[]
best model saved: step =  18599 dev accu =  tensor(0.7958, device='cuda:0')

Validation Results
Global Steps: 18599
Valid Loss: 0.43197
Valid Accuracy: 0.79579
time stamp: 6215.937730312347
[]
best model saved: step =  18799 dev accu =  tensor(0.7960, device='cuda:0')

Validation Results
Global Steps: 18799
Valid Loss: 0.43301
Valid Accuracy: 0.79603
time stamp: 6250.615733385086
[]

Validation Results
Global Steps: 18999
Valid Loss: 0.44454
Valid Accuracy: 0.78945
time stamp: 6285.366399049759
[]

Validation Results
Global Steps: 19199
Valid Loss: 0.44377
Valid Accuracy: 0.78892
time stamp: 6320.403793334961
[]
best model saved: step =  19399 dev accu =  tensor(0.7980, device='cuda:0')

Validation Results
Global Steps: 19399
Valid Loss: 0.42738
Valid Accuracy: 0.79804
time stamp: 6355.136706829071
[]

Validation Results
Global Steps: 19599
Valid Loss: 0.43361
Valid Accuracy: 0.79335
time stamp: 6389.880055427551
[]
best model saved: step =  19799 dev accu =  tensor(0.7990, device='cuda:0')

Validation Results
Global Steps: 19799
Valid Loss: 0.43503
Valid Accuracy: 0.79897
time stamp: 6425.2161984443665
[]
best model saved: step =  19999 dev accu =  tensor(0.7999, device='cuda:0')

Validation Results
Global Steps: 19999
Valid Loss: 0.42601
Valid Accuracy: 0.79989
time stamp: 6459.699518203735
[]
best model saved: step =  20199 dev accu =  tensor(0.8012, device='cuda:0')

Validation Results
Global Steps: 20199
Valid Loss: 0.42441
Valid Accuracy: 0.80118
time stamp: 6494.831076622009
[]

Validation Results
Global Steps: 20399
Valid Loss: 0.43514
Valid Accuracy: 0.79820
time stamp: 6529.753975152969
[]

Validation Results
Global Steps: 20599
Valid Loss: 0.42479
Valid Accuracy: 0.80039
time stamp: 6564.523864269257
[]
best model saved: step =  20799 dev accu =  tensor(0.8024, device='cuda:0')

Validation Results
Global Steps: 20799
Valid Loss: 0.42922
Valid Accuracy: 0.80240
time stamp: 6599.729845046997
[]

Validation Results
Global Steps: 20999
Valid Loss: 0.41987
Valid Accuracy: 0.80175
time stamp: 6634.5968770980835
[]

Validation Results
Global Steps: 21199
Valid Loss: 0.43156
Valid Accuracy: 0.80206
time stamp: 6669.666879892349
[]

Validation Results
Global Steps: 21399
Valid Loss: 0.42206
Valid Accuracy: 0.80217
time stamp: 6704.575751781464
[]
best model saved: step =  21599 dev accu =  tensor(0.8041, device='cuda:0')

Validation Results
Global Steps: 21599
Valid Loss: 0.41893
Valid Accuracy: 0.80411
time stamp: 6739.561477899551
[]

Validation Results
Global Steps: 21799
Valid Loss: 0.41925
Valid Accuracy: 0.80300
time stamp: 6774.721532344818
[]
best model saved: step =  21999 dev accu =  tensor(0.8042, device='cuda:0')

Validation Results
Global Steps: 21999
Valid Loss: 0.41889
Valid Accuracy: 0.80422
time stamp: 6809.848260402679
[]

Validation Results
Global Steps: 22199
Valid Loss: 0.42151
Valid Accuracy: 0.80354
time stamp: 6844.767329692841
[]
best model saved: step =  22399 dev accu =  tensor(0.8052, device='cuda:0')

Validation Results
Global Steps: 22399
Valid Loss: 0.41478
Valid Accuracy: 0.80520
time stamp: 6880.015202283859
[]
best model saved: step =  22599 dev accu =  tensor(0.8090, device='cuda:0')

Validation Results
Global Steps: 22599
Valid Loss: 0.40902
Valid Accuracy: 0.80901
time stamp: 6914.850737571716
[]

Validation Results
Global Steps: 22799
Valid Loss: 0.41951
Valid Accuracy: 0.80645
time stamp: 6949.628518342972
[]

Validation Results
Global Steps: 22999
Valid Loss: 0.41651
Valid Accuracy: 0.80720
time stamp: 6984.511594295502
[]

Validation Results
Global Steps: 23199
Valid Loss: 0.41957
Valid Accuracy: 0.80528
time stamp: 7019.4023995399475
[]

Validation Results
Global Steps: 23399
Valid Loss: 0.41424
Valid Accuracy: 0.80885
time stamp: 7053.933794260025
[]

Validation Results
Global Steps: 23599
Valid Loss: 0.41070
Valid Accuracy: 0.80814
time stamp: 7088.570195674896
[]
best model saved: step =  23799 dev accu =  tensor(0.8091, device='cuda:0')

Validation Results
Global Steps: 23799
Valid Loss: 0.40913
Valid Accuracy: 0.80914
time stamp: 7123.121358394623
[]
best model saved: step =  23999 dev accu =  tensor(0.8118, device='cuda:0')

Validation Results
Global Steps: 23999
Valid Loss: 0.40741
Valid Accuracy: 0.81178
time stamp: 7158.21596121788
[]

Validation Results
Global Steps: 24199
Valid Loss: 0.41169
Valid Accuracy: 0.80883
time stamp: 7193.540873527527
[]

Validation Results
Global Steps: 24399
Valid Loss: 0.40910
Valid Accuracy: 0.80872
time stamp: 7228.303730249405
[]
best model saved: step =  24599 dev accu =  tensor(0.8140, device='cuda:0')

Validation Results
Global Steps: 24599
Valid Loss: 0.40258
Valid Accuracy: 0.81404
time stamp: 7263.296897172928
[]

Validation Results
Global Steps: 24799
Valid Loss: 0.41292
Valid Accuracy: 0.80952
time stamp: 7297.912765741348
[]
best model saved: step =  24999 dev accu =  tensor(0.8144, device='cuda:0')

Validation Results
Global Steps: 24999
Valid Loss: 0.40068
Valid Accuracy: 0.81436
time stamp: 7332.771427631378
[]

Validation Results
Global Steps: 25199
Valid Loss: 0.41093
Valid Accuracy: 0.81109
time stamp: 7367.995784521103
[]
best model saved: step =  25399 dev accu =  tensor(0.8155, device='cuda:0')

Validation Results
Global Steps: 25399
Valid Loss: 0.39932
Valid Accuracy: 0.81554
time stamp: 7402.761762619019
[]

Validation Results
Global Steps: 25599
Valid Loss: 0.39934
Valid Accuracy: 0.81508
time stamp: 7437.943652391434
[]
best model saved: step =  25799 dev accu =  tensor(0.8158, device='cuda:0')

Validation Results
Global Steps: 25799
Valid Loss: 0.39703
Valid Accuracy: 0.81577
time stamp: 7472.550358057022
[]

Validation Results
Global Steps: 25999
Valid Loss: 0.40023
Valid Accuracy: 0.81572
time stamp: 7507.299781084061
[]

Validation Results
Global Steps: 26199
Valid Loss: 0.40530
Valid Accuracy: 0.81474
time stamp: 7542.024702072144
[]

Validation Results
Global Steps: 26399
Valid Loss: 0.40151
Valid Accuracy: 0.81558
time stamp: 7577.550993919373
[]
best model saved: step =  26599 dev accu =  tensor(0.8178, device='cuda:0')

Validation Results
Global Steps: 26599
Valid Loss: 0.39829
Valid Accuracy: 0.81779
time stamp: 7612.435087442398
[]

Validation Results
Global Steps: 26799
Valid Loss: 0.39750
Valid Accuracy: 0.81731
time stamp: 7647.236961841583
[]

Validation Results
Global Steps: 26999
Valid Loss: 0.39719
Valid Accuracy: 0.81771
time stamp: 7682.445115804672
[]
best model saved: step =  27199 dev accu =  tensor(0.8185, device='cuda:0')

Validation Results
Global Steps: 27199
Valid Loss: 0.39725
Valid Accuracy: 0.81854
time stamp: 7717.466248512268
[]
best model saved: step =  27399 dev accu =  tensor(0.8209, device='cuda:0')

Validation Results
Global Steps: 27399
Valid Loss: 0.39030
Valid Accuracy: 0.82087
time stamp: 7752.677423477173
[]
best model saved: step =  27599 dev accu =  tensor(0.8218, device='cuda:0')

Validation Results
Global Steps: 27599
Valid Loss: 0.39285
Valid Accuracy: 0.82178
time stamp: 7787.609089374542
[]

Validation Results
Global Steps: 27799
Valid Loss: 0.39053
Valid Accuracy: 0.82098
time stamp: 7822.460488080978
[]
best model saved: step =  27999 dev accu =  tensor(0.8255, device='cuda:0')

Validation Results
Global Steps: 27999
Valid Loss: 0.37956
Valid Accuracy: 0.82550
time stamp: 7857.3056671619415
[]

Validation Results
Global Steps: 28199
Valid Loss: 0.40030
Valid Accuracy: 0.81759
time stamp: 7892.367969274521
[]

Validation Results
Global Steps: 28399
Valid Loss: 0.38820
Valid Accuracy: 0.82373
time stamp: 7927.067725419998
[]
best model saved: step =  28599 dev accu =  tensor(0.8276, device='cuda:0')

Validation Results
Global Steps: 28599
Valid Loss: 0.38138
Valid Accuracy: 0.82763
time stamp: 7962.034257650375
[]

Validation Results
Global Steps: 28799
Valid Loss: 0.38813
Valid Accuracy: 0.82664
time stamp: 7997.008635997772
[]
best model saved: step =  28999 dev accu =  tensor(0.8283, device='cuda:0')

Validation Results
Global Steps: 28999
Valid Loss: 0.37320
Valid Accuracy: 0.82829
time stamp: 8031.538952827454
[]

Validation Results
Global Steps: 29199
Valid Loss: 0.37599
Valid Accuracy: 0.82742
time stamp: 8066.507972002029
[]

Validation Results
Global Steps: 29399
Valid Loss: 0.38354
Valid Accuracy: 0.82733
time stamp: 8101.166079759598
[]
best model saved: step =  29599 dev accu =  tensor(0.8310, device='cuda:0')

Validation Results
Global Steps: 29599
Valid Loss: 0.37009
Valid Accuracy: 0.83103
time stamp: 8136.040591001511
[]

Validation Results
Global Steps: 29799
Valid Loss: 0.39842
Valid Accuracy: 0.81890
time stamp: 8170.650377988815
[]
best model saved: step =  29999 dev accu =  tensor(0.8312, device='cuda:0')

Validation Results
Global Steps: 29999
Valid Loss: 0.37613
Valid Accuracy: 0.83117
time stamp: 8205.633404016495
total training step (k): 30.0
total training time (s): 8205.634194850922
total training time (ms): 1682822.5693359375
peak memory usage (MB): 12858
allocated memory usage (MB): 521217094
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |   12024 KB |   12858 MB |  509001 GB |  509001 GB |
|       from large pool |    6144 KB |   12846 MB |  505328 GB |  505328 GB |
|       from small pool |    5880 KB |      27 MB |    3672 GB |    3672 GB |
|---------------------------------------------------------------------------|
| Active memory         |   12024 KB |   12858 MB |  509001 GB |  509001 GB |
|       from large pool |    6144 KB |   12846 MB |  505328 GB |  505328 GB |
|       from small pool |    5880 KB |      27 MB |    3672 GB |    3672 GB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   13776 MB |   13776 MB |   13776 MB |       0 B  |
|       from large pool |   13748 MB |   13748 MB |   13748 MB |       0 B  |
|       from small pool |      28 MB |      28 MB |      28 MB |       0 B  |
|---------------------------------------------------------------------------|
| Non-releasable memory |   10503 KB |    2073 MB |  449709 GB |  449709 GB |
|       from large pool |   10240 KB |    2070 MB |  445552 GB |  445552 GB |
|       from small pool |     263 KB |       6 MB |    4156 GB |    4156 GB |
|---------------------------------------------------------------------------|
| Allocations           |     398    |     670    |   35682 K  |   35682 K  |
|       from large pool |       2    |      93    |   13502 K  |   13502 K  |
|       from small pool |     396    |     659    |   22180 K  |   22180 K  |
|---------------------------------------------------------------------------|
| Active allocs         |     398    |     670    |   35682 K  |   35682 K  |
|       from large pool |       2    |      93    |   13502 K  |   13502 K  |
|       from small pool |     396    |     659    |   22180 K  |   22180 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      42    |      42    |      42    |       0    |
|       from large pool |      28    |      28    |      28    |       0    |
|       from small pool |      14    |      14    |      14    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       9    |      34    |   17400 K  |   17400 K  |
|       from large pool |       2    |      20    |    5225 K  |    5225 K  |
|       from small pool |       7    |      22    |   12175 K  |   12175 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

loading the best model from: ./checkpoints/checkpoints-3/lra-yelp1/learnable.model
Evaluation Results
Loss: 0.37554
Accuracy: 0.83177
