GPU list: [0, 1, 2, 3]
[
    {
        "learn_pos_emb": true,
        "tied_weights": false,
        "embedding_dim": 64,
        "transformer_dim": 64,
        "transformer_hidden_dim": 128,
        "head_dim": 32,
        "num_head": 2,
        "num_layers": 4,
        "vocab_size": 512,
        "max_seq_len": 1024,
        "dropout_prob": 0.1,
        "attention_dropout": 0.1,
        "pooling_mode": "MEAN",
        "num_classes": 2,
        "block_size": 32,
        "batch_size": 128,
        "density": 0.05,
        "mixed_precision": true,
        "random_seed": 7,
        "task": "lra-yelp1"
    },
    {
        "batch_size": 512,
        "learning_rate": 0.0007,
        "warmup": 80,
        "lr_decay": "linear",
        "weight_decay": 0,
        "eval_frequency": 200,
        "num_train_steps": 30000,
        "num_init_steps": 17000,
        "num_eval_steps": 200,
        "num_dense_train_steps": 1000,
        "patience": 10,
        "attn_loss_scale": 0.01
    }
]
attn_mask compile
attn_mask compile
attn_mask compile
attn_mask compile
DataParallel(
  (module): ModelForSC(
    (model): Model(
      (embeddings): Embeddings(
        (word_embeddings): Embedding(512, 64)
        (position_embeddings): Embedding(1024, 64)
        (dropout): Dropout(p=0.1, inplace=False)
      )
      (transformer_0): TransformerLayer(
        (norm1): LayerNorm((64,), eps=1e-05, elementwise_affine=True)
        (mha): Attention(
          (W_q): Linear(in_features=64, out_features=64, bias=True)
          (W_k): Linear(in_features=64, out_features=64, bias=True)
          (W_v): Linear(in_features=64, out_features=64, bias=True)
          (avg_pool): AvgPool2d(kernel_size=32, stride=32, padding=0)
          (MSEloss): MSELoss()
          (attn): CUDAMaskAttention()
          (ff): Linear(in_features=64, out_features=64, bias=True)
        )
        (dropout1): Dropout(p=0.1, inplace=False)
        (norm2): LayerNorm((64,), eps=1e-05, elementwise_affine=True)
        (mlpblock): Sequential(
          (0): Linear(in_features=64, out_features=128, bias=True)
          (1): GELU(approximate='none')
          (2): Dropout(p=0.1, inplace=False)
          (3): Linear(in_features=128, out_features=64, bias=True)
          (4): Dropout(p=0.1, inplace=False)
        )
      )
      (transformer_1): TransformerLayer(
        (norm1): LayerNorm((64,), eps=1e-05, elementwise_affine=True)
        (mha): Attention(
          (W_q): Linear(in_features=64, out_features=64, bias=True)
          (W_k): Linear(in_features=64, out_features=64, bias=True)
          (W_v): Linear(in_features=64, out_features=64, bias=True)
          (avg_pool): AvgPool2d(kernel_size=32, stride=32, padding=0)
          (MSEloss): MSELoss()
          (attn): CUDAMaskAttention()
          (ff): Linear(in_features=64, out_features=64, bias=True)
        )
        (dropout1): Dropout(p=0.1, inplace=False)
        (norm2): LayerNorm((64,), eps=1e-05, elementwise_affine=True)
        (mlpblock): Sequential(
          (0): Linear(in_features=64, out_features=128, bias=True)
          (1): GELU(approximate='none')
          (2): Dropout(p=0.1, inplace=False)
          (3): Linear(in_features=128, out_features=64, bias=True)
          (4): Dropout(p=0.1, inplace=False)
        )
      )
      (transformer_2): TransformerLayer(
        (norm1): LayerNorm((64,), eps=1e-05, elementwise_affine=True)
        (mha): Attention(
          (W_q): Linear(in_features=64, out_features=64, bias=True)
          (W_k): Linear(in_features=64, out_features=64, bias=True)
          (W_v): Linear(in_features=64, out_features=64, bias=True)
          (avg_pool): AvgPool2d(kernel_size=32, stride=32, padding=0)
          (MSEloss): MSELoss()
          (attn): CUDAMaskAttention()
          (ff): Linear(in_features=64, out_features=64, bias=True)
        )
        (dropout1): Dropout(p=0.1, inplace=False)
        (norm2): LayerNorm((64,), eps=1e-05, elementwise_affine=True)
        (mlpblock): Sequential(
          (0): Linear(in_features=64, out_features=128, bias=True)
          (1): GELU(approximate='none')
          (2): Dropout(p=0.1, inplace=False)
          (3): Linear(in_features=128, out_features=64, bias=True)
          (4): Dropout(p=0.1, inplace=False)
        )
      )
      (transformer_3): TransformerLayer(
        (norm1): LayerNorm((64,), eps=1e-05, elementwise_affine=True)
        (mha): Attention(
          (W_q): Linear(in_features=64, out_features=64, bias=True)
          (W_k): Linear(in_features=64, out_features=64, bias=True)
          (W_v): Linear(in_features=64, out_features=64, bias=True)
          (avg_pool): AvgPool2d(kernel_size=32, stride=32, padding=0)
          (MSEloss): MSELoss()
          (attn): CUDAMaskAttention()
          (ff): Linear(in_features=64, out_features=64, bias=True)
        )
        (dropout1): Dropout(p=0.1, inplace=False)
        (norm2): LayerNorm((64,), eps=1e-05, elementwise_affine=True)
        (mlpblock): Sequential(
          (0): Linear(in_features=64, out_features=128, bias=True)
          (1): GELU(approximate='none')
          (2): Dropout(p=0.1, inplace=False)
          (3): Linear(in_features=128, out_features=64, bias=True)
          (4): Dropout(p=0.1, inplace=False)
        )
      )
      (norm): LayerNorm((64,), eps=1e-05, elementwise_affine=True)
    )
    (seq_classifer): SCHead(
      (mlpblock): Sequential(
        (0): Linear(in_features=64, out_features=128, bias=True)
        (1): ReLU()
        (2): Linear(in_features=128, out_features=2, bias=True)
      )
    )
  )
)
parameter_size: [torch.Size([512, 64]), torch.Size([1024, 64]), torch.Size([64]), torch.Size([64]), torch.Size([32, 32]), torch.Size([64, 64]), torch.Size([64]), torch.Size([64, 64]), torch.Size([64]), torch.Size([64, 64]), torch.Size([64]), torch.Size([64, 64]), torch.Size([64]), torch.Size([64]), torch.Size([64]), torch.Size([128, 64]), torch.Size([128]), torch.Size([64, 128]), torch.Size([64]), torch.Size([64]), torch.Size([64]), torch.Size([32, 32]), torch.Size([64, 64]), torch.Size([64]), torch.Size([64, 64]), torch.Size([64]), torch.Size([64, 64]), torch.Size([64]), torch.Size([64, 64]), torch.Size([64]), torch.Size([64]), torch.Size([64]), torch.Size([128, 64]), torch.Size([128]), torch.Size([64, 128]), torch.Size([64]), torch.Size([64]), torch.Size([64]), torch.Size([32, 32]), torch.Size([64, 64]), torch.Size([64]), torch.Size([64, 64]), torch.Size([64]), torch.Size([64, 64]), torch.Size([64]), torch.Size([64, 64]), torch.Size([64]), torch.Size([64]), torch.Size([64]), torch.Size([128, 64]), torch.Size([128]), torch.Size([64, 128]), torch.Size([64]), torch.Size([64]), torch.Size([64]), torch.Size([32, 32]), torch.Size([64, 64]), torch.Size([64]), torch.Size([64, 64]), torch.Size([64]), torch.Size([64, 64]), torch.Size([64]), torch.Size([64, 64]), torch.Size([64]), torch.Size([64]), torch.Size([64]), torch.Size([128, 64]), torch.Size([128]), torch.Size([64, 128]), torch.Size([64]), torch.Size([64]), torch.Size([64]), torch.Size([128, 64]), torch.Size([128]), torch.Size([2, 128]), torch.Size([2])]
num_parameter: 244994
Loaded ../Skyformer/data/lra_processed/lra-yelp1.train.pickle... size=560000
Loaded ../Skyformer/data/lra_processed/lra-yelp1.dev.pickle... size=38000
Loaded ../Skyformer/data/lra_processed/lra-yelp1.test.pickle... size=38000
accumu_steps=1
[tensor([30.7326, 30.7326, 30.7326, 30.7326], device='cuda:0',
       grad_fn=<GatherBackward>), tensor([26.5117, 26.5117, 26.5117, 26.5118], device='cuda:0',
       grad_fn=<GatherBackward>), tensor([26.2626, 26.2626, 26.2626, 26.2626], device='cuda:0',
       grad_fn=<GatherBackward>), tensor([33.9896, 33.9896, 33.9896, 33.9896], device='cuda:0',
       grad_fn=<GatherBackward>)]
best model saved: step =  199 dev accu =  tensor(0.7136, device='cuda:0')

Validation Results
Global Steps: 199
Valid Loss: 0.57159
Valid Accuracy: 0.71363
time stamp: 163.6669065952301
[tensor([13.4239, 13.4239, 13.4239, 13.4239], device='cuda:0',
       grad_fn=<GatherBackward>), tensor([11.3906, 11.3906, 11.3906, 11.3906], device='cuda:0',
       grad_fn=<GatherBackward>), tensor([11.2428, 11.2428, 11.2428, 11.2428], device='cuda:0',
       grad_fn=<GatherBackward>), tensor([15.0427, 15.0427, 15.0428, 15.0428], device='cuda:0',
       grad_fn=<GatherBackward>)]
best model saved: step =  399 dev accu =  tensor(0.7244, device='cuda:0')

Validation Results
Global Steps: 399
Valid Loss: 0.56011
Valid Accuracy: 0.72440
time stamp: 325.92248940467834
[tensor([6.7913, 6.7913, 6.7913, 6.7913], device='cuda:0',
       grad_fn=<GatherBackward>), tensor([5.7035, 5.7035, 5.7035, 5.7035], device='cuda:0',
       grad_fn=<GatherBackward>), tensor([5.6216, 5.6216, 5.6216, 5.6216], device='cuda:0',
       grad_fn=<GatherBackward>), tensor([7.6677, 7.6677, 7.6677, 7.6677], device='cuda:0',
       grad_fn=<GatherBackward>)]
best model saved: step =  599 dev accu =  tensor(0.7251, device='cuda:0')

Validation Results
Global Steps: 599
Valid Loss: 0.54784
Valid Accuracy: 0.72509
time stamp: 489.1833417415619
[tensor([3.8606, 3.8606, 3.8607, 3.8607], device='cuda:0',
       grad_fn=<GatherBackward>), tensor([3.2203, 3.2202, 3.2202, 3.2202], device='cuda:0',
       grad_fn=<GatherBackward>), tensor([3.1774, 3.1774, 3.1774, 3.1774], device='cuda:0',
       grad_fn=<GatherBackward>), tensor([4.3744, 4.3744, 4.3744, 4.3744], device='cuda:0',
       grad_fn=<GatherBackward>)]
best model saved: step =  799 dev accu =  tensor(0.7309, device='cuda:0')

Validation Results
Global Steps: 799
Valid Loss: 0.52711
Valid Accuracy: 0.73091
time stamp: 653.1202030181885
[tensor([2.4083, 2.4083, 2.4083, 2.4083], device='cuda:0',
       grad_fn=<GatherBackward>), tensor([1.9994, 1.9994, 1.9994, 1.9994], device='cuda:0',
       grad_fn=<GatherBackward>), tensor([1.9793, 1.9793, 1.9793, 1.9794], device='cuda:0',
       grad_fn=<GatherBackward>), tensor([2.7312, 2.7312, 2.7312, 2.7312], device='cuda:0',
       grad_fn=<GatherBackward>)]

Validation Results
Global Steps: 999
Valid Loss: 0.53543
Valid Accuracy: 0.72760
time stamp: 816.1114902496338
[tensor([1.6179, 1.6179, 1.6179, 1.6179], device='cuda:0',
       grad_fn=<GatherBackward>), tensor([1.3388, 1.3388, 1.3388, 1.3388], device='cuda:0',
       grad_fn=<GatherBackward>), tensor([1.3320, 1.3319, 1.3319, 1.3320], device='cuda:0',
       grad_fn=<GatherBackward>), tensor([1.8334, 1.8334, 1.8334, 1.8334], device='cuda:0',
       grad_fn=<GatherBackward>)]
best model saved: step =  1199 dev accu =  tensor(0.7328, device='cuda:0')

Validation Results
Global Steps: 1199
Valid Loss: 0.52783
Valid Accuracy: 0.73283
time stamp: 980.0586042404175
[tensor([1.1526, 1.1526, 1.1526, 1.1526], device='cuda:0',
       grad_fn=<GatherBackward>), tensor([0.9518, 0.9518, 0.9517, 0.9517], device='cuda:0',
       grad_fn=<GatherBackward>), tensor([0.9525, 0.9525, 0.9525, 0.9525], device='cuda:0',
       grad_fn=<GatherBackward>), tensor([1.3042, 1.3042, 1.3042, 1.3042], device='cuda:0',
       grad_fn=<GatherBackward>)]
best model saved: step =  1399 dev accu =  tensor(0.7396, device='cuda:0')

Validation Results
Global Steps: 1399
Valid Loss: 0.51560
Valid Accuracy: 0.73956
time stamp: 1143.6389722824097
[tensor([0.8600, 0.8600, 0.8600, 0.8600], device='cuda:0',
       grad_fn=<GatherBackward>), tensor([0.7092, 0.7092, 0.7092, 0.7092], device='cuda:0',
       grad_fn=<GatherBackward>), tensor([0.7142, 0.7142, 0.7142, 0.7142], device='cuda:0',
       grad_fn=<GatherBackward>), tensor([0.9713, 0.9713, 0.9713, 0.9713], device='cuda:0',
       grad_fn=<GatherBackward>)]
best model saved: step =  1599 dev accu =  tensor(0.7410, device='cuda:0')

Validation Results
Global Steps: 1599
Valid Loss: 0.51479
Valid Accuracy: 0.74100
time stamp: 1307.299190044403
[tensor([0.6651, 0.6651, 0.6651, 0.6651], device='cuda:0',
       grad_fn=<GatherBackward>), tensor([0.5482, 0.5482, 0.5482, 0.5482], device='cuda:0',
       grad_fn=<GatherBackward>), tensor([0.5553, 0.5553, 0.5553, 0.5553], device='cuda:0',
       grad_fn=<GatherBackward>), tensor([0.7500, 0.7500, 0.7500, 0.7500], device='cuda:0',
       grad_fn=<GatherBackward>)]

Validation Results
Global Steps: 1799
Valid Loss: 0.52566
Valid Accuracy: 0.73227
time stamp: 1470.50164103508
[tensor([0.5288, 0.5288, 0.5288, 0.5288], device='cuda:0',
       grad_fn=<GatherBackward>), tensor([0.4358, 0.4358, 0.4358, 0.4358], device='cuda:0',
       grad_fn=<GatherBackward>), tensor([0.4438, 0.4438, 0.4438, 0.4438], device='cuda:0',
       grad_fn=<GatherBackward>), tensor([0.5956, 0.5956, 0.5956, 0.5956], device='cuda:0',
       grad_fn=<GatherBackward>)]
best model saved: step =  1999 dev accu =  tensor(0.7427, device='cuda:0')

Validation Results
Global Steps: 1999
Valid Loss: 0.51292
Valid Accuracy: 0.74269
time stamp: 1634.62015914917
[tensor([0.4294, 0.4294, 0.4294, 0.4294], device='cuda:0',
       grad_fn=<GatherBackward>), tensor([0.3540, 0.3540, 0.3540, 0.3540], device='cuda:0',
       grad_fn=<GatherBackward>), tensor([0.3621, 0.3621, 0.3621, 0.3621], device='cuda:0',
       grad_fn=<GatherBackward>), tensor([0.4832, 0.4832, 0.4832, 0.4832], device='cuda:0',
       grad_fn=<GatherBackward>)]

Validation Results
Global Steps: 2199
Valid Loss: 0.52174
Valid Accuracy: 0.73896
time stamp: 1798.5764465332031
[tensor([0.3543, 0.3543, 0.3543, 0.3543], device='cuda:0',
       grad_fn=<GatherBackward>), tensor([0.2922, 0.2922, 0.2922, 0.2922], device='cuda:0',
       grad_fn=<GatherBackward>), tensor([0.3000, 0.3000, 0.3000, 0.3000], device='cuda:0',
       grad_fn=<GatherBackward>), tensor([0.3986, 0.3986, 0.3986, 0.3986], device='cuda:0',
       grad_fn=<GatherBackward>)]

Validation Results
Global Steps: 2399
Valid Loss: 0.51439
Valid Accuracy: 0.74210
time stamp: 1962.9631140232086
[tensor([0.2959, 0.2959, 0.2959, 0.2959], device='cuda:0',
       grad_fn=<GatherBackward>), tensor([0.2441, 0.2441, 0.2441, 0.2441], device='cuda:0',
       grad_fn=<GatherBackward>), tensor([0.2513, 0.2513, 0.2513, 0.2513], device='cuda:0',
       grad_fn=<GatherBackward>), tensor([0.3328, 0.3328, 0.3328, 0.3328], device='cuda:0',
       grad_fn=<GatherBackward>)]

Validation Results
Global Steps: 2599
Valid Loss: 0.51119
Valid Accuracy: 0.74208
time stamp: 2126.8259739875793
[tensor([0.2494, 0.2494, 0.2494, 0.2494], device='cuda:0',
       grad_fn=<GatherBackward>), tensor([0.2059, 0.2059, 0.2059, 0.2059], device='cuda:0',
       grad_fn=<GatherBackward>), tensor([0.2124, 0.2124, 0.2124, 0.2124], device='cuda:0',
       grad_fn=<GatherBackward>), tensor([0.2806, 0.2806, 0.2806, 0.2806], device='cuda:0',
       grad_fn=<GatherBackward>)]

Validation Results
Global Steps: 2799
Valid Loss: 0.51642
Valid Accuracy: 0.74031
time stamp: 2290.971884727478
[tensor([0.2116, 0.2116, 0.2116, 0.2116], device='cuda:0',
       grad_fn=<GatherBackward>), tensor([0.1748, 0.1748, 0.1748, 0.1748], device='cuda:0',
       grad_fn=<GatherBackward>), tensor([0.1805, 0.1805, 0.1805, 0.1805], device='cuda:0',
       grad_fn=<GatherBackward>), tensor([0.2382, 0.2382, 0.2382, 0.2382], device='cuda:0',
       grad_fn=<GatherBackward>)]
best model saved: step =  2999 dev accu =  tensor(0.7437, device='cuda:0')

Validation Results
Global Steps: 2999
Valid Loss: 0.51027
Valid Accuracy: 0.74366
time stamp: 2455.014801263809
[tensor([0.1804, 0.1804, 0.1804, 0.1804], device='cuda:0',
       grad_fn=<GatherBackward>), tensor([0.1491, 0.1491, 0.1491, 0.1491], device='cuda:0',
       grad_fn=<GatherBackward>), tensor([0.1541, 0.1541, 0.1541, 0.1541], device='cuda:0',
       grad_fn=<GatherBackward>), tensor([0.2033, 0.2033, 0.2033, 0.2033], device='cuda:0',
       grad_fn=<GatherBackward>)]
best model saved: step =  3199 dev accu =  tensor(0.7445, device='cuda:0')

Validation Results
Global Steps: 3199
Valid Loss: 0.51206
Valid Accuracy: 0.74452
time stamp: 2618.878668785095
[tensor([0.1544, 0.1544, 0.1544, 0.1544], device='cuda:0',
       grad_fn=<GatherBackward>), tensor([0.1277, 0.1277, 0.1277, 0.1277], device='cuda:0',
       grad_fn=<GatherBackward>), tensor([0.1320, 0.1320, 0.1320, 0.1320], device='cuda:0',
       grad_fn=<GatherBackward>), tensor([0.1742, 0.1742, 0.1742, 0.1742], device='cuda:0',
       grad_fn=<GatherBackward>)]

Validation Results
Global Steps: 3399
Valid Loss: 0.51089
Valid Accuracy: 0.74229
time stamp: 2784.037879705429
[tensor([0.1325, 0.1325, 0.1325, 0.1325], device='cuda:0',
       grad_fn=<GatherBackward>), tensor([0.1097, 0.1097, 0.1097, 0.1097], device='cuda:0',
       grad_fn=<GatherBackward>), tensor([0.1133, 0.1133, 0.1133, 0.1133], device='cuda:0',
       grad_fn=<GatherBackward>), tensor([0.1496, 0.1496, 0.1496, 0.1496], device='cuda:0',
       grad_fn=<GatherBackward>)]
best model saved: step =  3599 dev accu =  tensor(0.7496, device='cuda:0')

Validation Results
Global Steps: 3599
Valid Loss: 0.50603
Valid Accuracy: 0.74957
time stamp: 2948.934135198593
[tensor([0.1139, 0.1139, 0.1139, 0.1139], device='cuda:0',
       grad_fn=<GatherBackward>), tensor([0.0944, 0.0944, 0.0944, 0.0944], device='cuda:0',
       grad_fn=<GatherBackward>), tensor([0.0974, 0.0974, 0.0974, 0.0974], device='cuda:0',
       grad_fn=<GatherBackward>), tensor([0.1288, 0.1288, 0.1288, 0.1288], device='cuda:0',
       grad_fn=<GatherBackward>)]
best model saved: step =  3799 dev accu =  tensor(0.7500, device='cuda:0')

Validation Results
Global Steps: 3799
Valid Loss: 0.50247
Valid Accuracy: 0.75005
time stamp: 3114.8470962047577
[tensor([0.0981, 0.0981, 0.0981, 0.0981], device='cuda:0',
       grad_fn=<GatherBackward>), tensor([0.0813, 0.0813, 0.0813, 0.0813], device='cuda:0',
       grad_fn=<GatherBackward>), tensor([0.0838, 0.0838, 0.0838, 0.0838], device='cuda:0',
       grad_fn=<GatherBackward>), tensor([0.1110, 0.1110, 0.1110, 0.1110], device='cuda:0',
       grad_fn=<GatherBackward>)]

Validation Results
Global Steps: 3999
Valid Loss: 0.50300
Valid Accuracy: 0.74830
time stamp: 3280.234461069107
[tensor([0.0845, 0.0845, 0.0845, 0.0845], device='cuda:0',
       grad_fn=<GatherBackward>), tensor([0.0701, 0.0701, 0.0701, 0.0701], device='cuda:0',
       grad_fn=<GatherBackward>), tensor([0.0721, 0.0721, 0.0721, 0.0721], device='cuda:0',
       grad_fn=<GatherBackward>), tensor([0.0958, 0.0958, 0.0958, 0.0958], device='cuda:0',
       grad_fn=<GatherBackward>)]

Validation Results
Global Steps: 4199
Valid Loss: 0.50330
Valid Accuracy: 0.74856
time stamp: 3445.761736869812
[tensor([0.0728, 0.0728, 0.0728, 0.0728], device='cuda:0',
       grad_fn=<GatherBackward>), tensor([0.0605, 0.0605, 0.0605, 0.0605], device='cuda:0',
       grad_fn=<GatherBackward>), tensor([0.0621, 0.0621, 0.0621, 0.0621], device='cuda:0',
       grad_fn=<GatherBackward>), tensor([0.0827, 0.0827, 0.0827, 0.0827], device='cuda:0',
       grad_fn=<GatherBackward>)]
best model saved: step =  4399 dev accu =  tensor(0.7507, device='cuda:0')

Validation Results
Global Steps: 4399
Valid Loss: 0.50327
Valid Accuracy: 0.75065
time stamp: 3611.155829191208
[tensor([0.0628, 0.0628, 0.0628, 0.0628], device='cuda:0',
       grad_fn=<GatherBackward>), tensor([0.0522, 0.0522, 0.0522, 0.0522], device='cuda:0',
       grad_fn=<GatherBackward>), tensor([0.0534, 0.0534, 0.0534, 0.0534], device='cuda:0',
       grad_fn=<GatherBackward>), tensor([0.0714, 0.0714, 0.0714, 0.0714], device='cuda:0',
       grad_fn=<GatherBackward>)]

Validation Results
Global Steps: 4599
Valid Loss: 0.50424
Valid Accuracy: 0.75004
time stamp: 3776.40811085701
[tensor([0.0541, 0.0541, 0.0541, 0.0541], device='cuda:0',
       grad_fn=<GatherBackward>), tensor([0.0450, 0.0450, 0.0450, 0.0450], device='cuda:0',
       grad_fn=<GatherBackward>), tensor([0.0460, 0.0460, 0.0460, 0.0460], device='cuda:0',
       grad_fn=<GatherBackward>), tensor([0.0616, 0.0616, 0.0616, 0.0616], device='cuda:0',
       grad_fn=<GatherBackward>)]

Validation Results
Global Steps: 4799
Valid Loss: 0.50832
Valid Accuracy: 0.75005
time stamp: 3941.1070370674133
[tensor([0.0466, 0.0466, 0.0466, 0.0466], device='cuda:0',
       grad_fn=<GatherBackward>), tensor([0.0388, 0.0388, 0.0388, 0.0388], device='cuda:0',
       grad_fn=<GatherBackward>), tensor([0.0396, 0.0396, 0.0396, 0.0396], device='cuda:0',
       grad_fn=<GatherBackward>), tensor([0.0532, 0.0532, 0.0532, 0.0532], device='cuda:0',
       grad_fn=<GatherBackward>)]

Validation Results
Global Steps: 4999
Valid Loss: 0.50042
Valid Accuracy: 0.75001
time stamp: 4105.720328807831
[tensor([0.0401, 0.0401, 0.0401, 0.0401], device='cuda:0',
       grad_fn=<GatherBackward>), tensor([0.0335, 0.0335, 0.0335, 0.0335], device='cuda:0',
       grad_fn=<GatherBackward>), tensor([0.0340, 0.0340, 0.0340, 0.0340], device='cuda:0',
       grad_fn=<GatherBackward>), tensor([0.0459, 0.0459, 0.0459, 0.0459], device='cuda:0',
       grad_fn=<GatherBackward>)]

Validation Results
Global Steps: 5199
Valid Loss: 0.50460
Valid Accuracy: 0.74843
time stamp: 4270.174228429794
[tensor([0.0346, 0.0346, 0.0346, 0.0346], device='cuda:0',
       grad_fn=<GatherBackward>), tensor([0.0288, 0.0288, 0.0288, 0.0288], device='cuda:0',
       grad_fn=<GatherBackward>), tensor([0.0293, 0.0293, 0.0293, 0.0293], device='cuda:0',
       grad_fn=<GatherBackward>), tensor([0.0395, 0.0395, 0.0395, 0.0395], device='cuda:0',
       grad_fn=<GatherBackward>)]
best model saved: step =  5399 dev accu =  tensor(0.7513, device='cuda:0')

Validation Results
Global Steps: 5399
Valid Loss: 0.49808
Valid Accuracy: 0.75135
time stamp: 4434.278277873993
[tensor([0.0297, 0.0297, 0.0297, 0.0297], device='cuda:0',
       grad_fn=<GatherBackward>), tensor([0.0248, 0.0248, 0.0248, 0.0248], device='cuda:0',
       grad_fn=<GatherBackward>), tensor([0.0251, 0.0251, 0.0251, 0.0251], device='cuda:0',
       grad_fn=<GatherBackward>), tensor([0.0341, 0.0341, 0.0341, 0.0341], device='cuda:0',
       grad_fn=<GatherBackward>)]
best model saved: step =  5599 dev accu =  tensor(0.7522, device='cuda:0')

Validation Results
Global Steps: 5599
Valid Loss: 0.50309
Valid Accuracy: 0.75224
time stamp: 4599.208750247955
[tensor([0.0256, 0.0256, 0.0256, 0.0256], device='cuda:0',
       grad_fn=<GatherBackward>), tensor([0.0214, 0.0214, 0.0214, 0.0214], device='cuda:0',
       grad_fn=<GatherBackward>), tensor([0.0216, 0.0216, 0.0216, 0.0216], device='cuda:0',
       grad_fn=<GatherBackward>), tensor([0.0293, 0.0293, 0.0293, 0.0293], device='cuda:0',
       grad_fn=<GatherBackward>)]
best model saved: step =  5799 dev accu =  tensor(0.7542, device='cuda:0')

Validation Results
Global Steps: 5799
Valid Loss: 0.49639
Valid Accuracy: 0.75425
time stamp: 4763.975964784622
[tensor([0.0220, 0.0220, 0.0220, 0.0220], device='cuda:0',
       grad_fn=<GatherBackward>), tensor([0.0184, 0.0184, 0.0184, 0.0184], device='cuda:0',
       grad_fn=<GatherBackward>), tensor([0.0185, 0.0185, 0.0185, 0.0185], device='cuda:0',
       grad_fn=<GatherBackward>), tensor([0.0252, 0.0252, 0.0252, 0.0252], device='cuda:0',
       grad_fn=<GatherBackward>)]

Validation Results
Global Steps: 5999
Valid Loss: 0.50992
Valid Accuracy: 0.74548
time stamp: 4929.5619077682495
[tensor([0.0189, 0.0189, 0.0189, 0.0189], device='cuda:0',
       grad_fn=<GatherBackward>), tensor([0.0158, 0.0158, 0.0158, 0.0158], device='cuda:0',
       grad_fn=<GatherBackward>), tensor([0.0159, 0.0159, 0.0159, 0.0159], device='cuda:0',
       grad_fn=<GatherBackward>), tensor([0.0217, 0.0217, 0.0217, 0.0217], device='cuda:0',
       grad_fn=<GatherBackward>)]
best model saved: step =  6199 dev accu =  tensor(0.7548, device='cuda:0')

Validation Results
Global Steps: 6199
Valid Loss: 0.49536
Valid Accuracy: 0.75483
time stamp: 5094.720241069794
[tensor([0.0162, 0.0162, 0.0162, 0.0162], device='cuda:0',
       grad_fn=<GatherBackward>), tensor([0.0136, 0.0136, 0.0136, 0.0136], device='cuda:0',
       grad_fn=<GatherBackward>), tensor([0.0136, 0.0136, 0.0136, 0.0136], device='cuda:0',
       grad_fn=<GatherBackward>), tensor([0.0186, 0.0186, 0.0186, 0.0186], device='cuda:0',
       grad_fn=<GatherBackward>)]

Validation Results
Global Steps: 6399
Valid Loss: 0.49839
Valid Accuracy: 0.74942
time stamp: 5259.915281534195
[tensor([0.0139, 0.0139, 0.0139, 0.0139], device='cuda:0',
       grad_fn=<GatherBackward>), tensor([0.0116, 0.0116, 0.0116, 0.0116], device='cuda:0',
       grad_fn=<GatherBackward>), tensor([0.0117, 0.0117, 0.0117, 0.0117], device='cuda:0',
       grad_fn=<GatherBackward>), tensor([0.0160, 0.0160, 0.0160, 0.0160], device='cuda:0',
       grad_fn=<GatherBackward>)]
best model saved: step =  6599 dev accu =  tensor(0.7551, device='cuda:0')

Validation Results
Global Steps: 6599
Valid Loss: 0.49975
Valid Accuracy: 0.75511
time stamp: 5425.512798786163
[tensor([0.0119, 0.0119, 0.0119, 0.0119], device='cuda:0',
       grad_fn=<GatherBackward>), tensor([0.0100, 0.0100, 0.0100, 0.0100], device='cuda:0',
       grad_fn=<GatherBackward>), tensor([0.0100, 0.0100, 0.0100, 0.0100], device='cuda:0',
       grad_fn=<GatherBackward>), tensor([0.0137, 0.0137, 0.0137, 0.0137], device='cuda:0',
       grad_fn=<GatherBackward>)]

Validation Results
Global Steps: 6799
Valid Loss: 0.49434
Valid Accuracy: 0.75333
time stamp: 5592.207976579666
[tensor([0.0102, 0.0102, 0.0102, 0.0102], device='cuda:0',
       grad_fn=<GatherBackward>), tensor([0.0085, 0.0085, 0.0085, 0.0085], device='cuda:0',
       grad_fn=<GatherBackward>), tensor([0.0085, 0.0085, 0.0085, 0.0085], device='cuda:0',
       grad_fn=<GatherBackward>), tensor([0.0117, 0.0117, 0.0117, 0.0117], device='cuda:0',
       grad_fn=<GatherBackward>)]
best model saved: step =  6999 dev accu =  tensor(0.7577, device='cuda:0')

Validation Results
Global Steps: 6999
Valid Loss: 0.49180
Valid Accuracy: 0.75771
time stamp: 5759.180091381073
[tensor([0.0087, 0.0087, 0.0087, 0.0087], device='cuda:0',
       grad_fn=<GatherBackward>), tensor([0.0073, 0.0073, 0.0073, 0.0073], device='cuda:0',
       grad_fn=<GatherBackward>), tensor([0.0073, 0.0073, 0.0073, 0.0073], device='cuda:0',
       grad_fn=<GatherBackward>), tensor([0.0101, 0.0101, 0.0101, 0.0101], device='cuda:0',
       grad_fn=<GatherBackward>)]

Validation Results
Global Steps: 7199
Valid Loss: 0.49989
Valid Accuracy: 0.74868
time stamp: 5925.10436630249
[tensor([0.0075, 0.0075, 0.0075, 0.0075], device='cuda:0',
       grad_fn=<GatherBackward>), tensor([0.0063, 0.0063, 0.0063, 0.0063], device='cuda:0',
       grad_fn=<GatherBackward>), tensor([0.0062, 0.0062, 0.0062, 0.0062], device='cuda:0',
       grad_fn=<GatherBackward>), tensor([0.0086, 0.0086, 0.0086, 0.0086], device='cuda:0',
       grad_fn=<GatherBackward>)]

Validation Results
Global Steps: 7399
Valid Loss: 0.49558
Valid Accuracy: 0.75309
time stamp: 6090.2782390117645
[tensor([0.0064, 0.0064, 0.0064, 0.0064], device='cuda:0',
       grad_fn=<GatherBackward>), tensor([0.0053, 0.0053, 0.0053, 0.0053], device='cuda:0',
       grad_fn=<GatherBackward>), tensor([0.0053, 0.0053, 0.0053, 0.0053], device='cuda:0',
       grad_fn=<GatherBackward>), tensor([0.0074, 0.0074, 0.0073, 0.0073], device='cuda:0',
       grad_fn=<GatherBackward>)]

Validation Results
Global Steps: 7599
Valid Loss: 0.51053
Valid Accuracy: 0.74678
time stamp: 6256.062759399414
[tensor([0.0054, 0.0054, 0.0054, 0.0054], device='cuda:0',
       grad_fn=<GatherBackward>), tensor([0.0046, 0.0046, 0.0046, 0.0046], device='cuda:0',
       grad_fn=<GatherBackward>), tensor([0.0045, 0.0045, 0.0045, 0.0045], device='cuda:0',
       grad_fn=<GatherBackward>), tensor([0.0063, 0.0063, 0.0063, 0.0063], device='cuda:0',
       grad_fn=<GatherBackward>)]

Validation Results
Global Steps: 7799
Valid Loss: 0.49337
Valid Accuracy: 0.75679
time stamp: 6421.602822542191
[tensor([0.0046, 0.0046, 0.0046, 0.0046], device='cuda:0',
       grad_fn=<GatherBackward>), tensor([0.0039, 0.0039, 0.0039, 0.0039], device='cuda:0',
       grad_fn=<GatherBackward>), tensor([0.0039, 0.0039, 0.0039, 0.0039], device='cuda:0',
       grad_fn=<GatherBackward>), tensor([0.0054, 0.0054, 0.0054, 0.0054], device='cuda:0',
       grad_fn=<GatherBackward>)]

Validation Results
Global Steps: 7999
Valid Loss: 0.49601
Valid Accuracy: 0.75229
time stamp: 6586.761023521423
module.model.transformer_0.mha.pattern saved
module.model.transformer_1.mha.pattern saved
module.model.transformer_2.mha.pattern saved
module.model.transformer_3.mha.pattern saved
./pickle/lra-yelp1/module.model.transformer_0.mha.pattern.pickle
tensor([ 165,  396,  264,  759,  627,  429,   66,  198,  726,  825,   33,  990,
         924, 1023,  363,  132,  561,  528,  693,  495,  297,  462,  660,  792,
         891,   99,  231,  957,    0,  330,  858,  594,  149,  676,  371,  619,
         237,  423,    2,   64,    1,   32,  100,  131,  157,  932,  331,  362,
         268,  392,  314], device='cuda:0')
tensor(51, device='cuda:0')
block_attn_mask compile
./pickle/lra-yelp1/module.model.transformer_1.mha.pattern.pickle
tensor([  33,  396,  957,  627,  330,   66,  792,    0,  363,  726,  660,  528,
         759,  297,  264,  594,  825,  132,  858,  231,  495,  165, 1023,  561,
          99,  891,  990,  462,  429,  198,  924,  693,   82,  578,  413,  940,
         154,  836,  859,  890,  399,  492,   58,  833,  332,  394,   84,  642,
         146,  580,  506], device='cuda:0')
tensor(51, device='cuda:0')
block_attn_mask compile
./pickle/lra-yelp1/module.model.transformer_2.mha.pattern.pickle
tensor([ 561,  990,  198,  165,  726,  594,   33,  330,  396,  792,  891,  528,
         858,  924,  627,  132,  297,  957,  693, 1023,  825,    0,   66,  363,
         660,   99,  429,  462,  231,  264,  495,  759,   95,  994,  664,  788,
         761,  823,  636,  915,  282,  840,  127,  995,  564,  657,   16,  512,
          34,   65,  138], device='cuda:0')
tensor(51, device='cuda:0')
block_attn_mask compile
./pickle/lra-yelp1/module.model.transformer_3.mha.pattern.pickle
tensor([ 561,  627,  429,  726,  396,  924,    0,  462,  528,  792,  330,  198,
         495,  858,  891,   33,  825,  957,   99,  693,  132,  759,  264,   66,
         990,  594,  231,  297,  660,  165, 1023,  363,   69,  162,  178,  581,
         567,  753,    3,   96,  496,  527,  208,  518,  366,  459,  175,  485,
         110,  451,  310], device='cuda:0')
tensor(51, device='cuda:0')
block_attn_mask compile
total pattern searching time (s): 0.0942690372467041
[]

Validation Results
Global Steps: 8199
Valid Loss: 0.51199
Valid Accuracy: 0.73892
time stamp: 6622.238098621368
[]

Validation Results
Global Steps: 8399
Valid Loss: 0.51314
Valid Accuracy: 0.74483
time stamp: 6657.309720277786
[]

Validation Results
Global Steps: 8599
Valid Loss: 0.49659
Valid Accuracy: 0.75450
time stamp: 6692.174472570419
[]

Validation Results
Global Steps: 8799
Valid Loss: 0.50098
Valid Accuracy: 0.75158
time stamp: 6727.172719478607
[]

Validation Results
Global Steps: 8999
Valid Loss: 0.49393
Valid Accuracy: 0.75542
time stamp: 6761.896507501602
[]

Validation Results
Global Steps: 9199
Valid Loss: 0.49037
Valid Accuracy: 0.75489
time stamp: 6796.589141607285
[]

Validation Results
Global Steps: 9399
Valid Loss: 0.49546
Valid Accuracy: 0.75165
time stamp: 6831.252184391022
[]
best model saved: step =  9599 dev accu =  tensor(0.7633, device='cuda:0')

Validation Results
Global Steps: 9599
Valid Loss: 0.48499
Valid Accuracy: 0.76333
time stamp: 6866.1762483119965
[]

Validation Results
Global Steps: 9799
Valid Loss: 0.48254
Valid Accuracy: 0.76309
time stamp: 6900.830231666565
[]

Validation Results
Global Steps: 9999
Valid Loss: 0.48448
Valid Accuracy: 0.76003
time stamp: 6935.773524045944
[]

Validation Results
Global Steps: 10199
Valid Loss: 0.48800
Valid Accuracy: 0.75837
time stamp: 6970.6470601558685
[]

Validation Results
Global Steps: 10399
Valid Loss: 0.49054
Valid Accuracy: 0.75908
time stamp: 7005.745611906052
[]
best model saved: step =  10599 dev accu =  tensor(0.7637, device='cuda:0')

Validation Results
Global Steps: 10599
Valid Loss: 0.48231
Valid Accuracy: 0.76372
time stamp: 7040.709337234497
[]
best model saved: step =  10799 dev accu =  tensor(0.7645, device='cuda:0')

Validation Results
Global Steps: 10799
Valid Loss: 0.47849
Valid Accuracy: 0.76451
time stamp: 7075.663795471191
[]
best model saved: step =  10999 dev accu =  tensor(0.7655, device='cuda:0')

Validation Results
Global Steps: 10999
Valid Loss: 0.47748
Valid Accuracy: 0.76555
time stamp: 7110.89533495903
[]

Validation Results
Global Steps: 11199
Valid Loss: 0.48554
Valid Accuracy: 0.76441
time stamp: 7145.921177625656
[]
best model saved: step =  11399 dev accu =  tensor(0.7671, device='cuda:0')

Validation Results
Global Steps: 11399
Valid Loss: 0.48227
Valid Accuracy: 0.76713
time stamp: 7180.962564468384
[]

Validation Results
Global Steps: 11599
Valid Loss: 0.48268
Valid Accuracy: 0.76633
time stamp: 7216.374950408936
[]
best model saved: step =  11799 dev accu =  tensor(0.7696, device='cuda:0')

Validation Results
Global Steps: 11799
Valid Loss: 0.47145
Valid Accuracy: 0.76962
time stamp: 7251.812330722809
[]

Validation Results
Global Steps: 11999
Valid Loss: 0.47876
Valid Accuracy: 0.76666
time stamp: 7286.817268610001
[]

Validation Results
Global Steps: 12199
Valid Loss: 0.47665
Valid Accuracy: 0.76708
time stamp: 7322.148199081421
[]
best model saved: step =  12399 dev accu =  tensor(0.7696, device='cuda:0')

Validation Results
Global Steps: 12399
Valid Loss: 0.47167
Valid Accuracy: 0.76965
time stamp: 7357.047484397888
[]

Validation Results
Global Steps: 12599
Valid Loss: 0.48232
Valid Accuracy: 0.76430
time stamp: 7391.758028268814
[]
best model saved: step =  12799 dev accu =  tensor(0.7729, device='cuda:0')

Validation Results
Global Steps: 12799
Valid Loss: 0.46863
Valid Accuracy: 0.77295
time stamp: 7426.831898450851
[]

Validation Results
Global Steps: 12999
Valid Loss: 0.47860
Valid Accuracy: 0.77003
time stamp: 7461.943112611771
[]

Validation Results
Global Steps: 13199
Valid Loss: 0.47054
Valid Accuracy: 0.77123
time stamp: 7497.204875469208
[]

Validation Results
Global Steps: 13399
Valid Loss: 0.49566
Valid Accuracy: 0.75814
time stamp: 7532.305175065994
[]
best model saved: step =  13599 dev accu =  tensor(0.7734, device='cuda:0')

Validation Results
Global Steps: 13599
Valid Loss: 0.46706
Valid Accuracy: 0.77344
time stamp: 7567.1626625061035
[]
best model saved: step =  13799 dev accu =  tensor(0.7737, device='cuda:0')

Validation Results
Global Steps: 13799
Valid Loss: 0.46572
Valid Accuracy: 0.77372
time stamp: 7602.40189743042
[]
best model saved: step =  13999 dev accu =  tensor(0.7748, device='cuda:0')

Validation Results
Global Steps: 13999
Valid Loss: 0.46803
Valid Accuracy: 0.77480
time stamp: 7637.530867576599
[]

Validation Results
Global Steps: 14199
Valid Loss: 0.48196
Valid Accuracy: 0.76124
time stamp: 7672.861603975296
[]

Validation Results
Global Steps: 14399
Valid Loss: 0.46585
Valid Accuracy: 0.77353
time stamp: 7707.804936885834
[]

Validation Results
Global Steps: 14599
Valid Loss: 0.46475
Valid Accuracy: 0.77233
time stamp: 7742.9222757816315
[]
best model saved: step =  14799 dev accu =  tensor(0.7751, device='cuda:0')

Validation Results
Global Steps: 14799
Valid Loss: 0.46331
Valid Accuracy: 0.77511
time stamp: 7777.701435804367
[]
best model saved: step =  14999 dev accu =  tensor(0.7782, device='cuda:0')

Validation Results
Global Steps: 14999
Valid Loss: 0.45928
Valid Accuracy: 0.77823
time stamp: 7812.603623867035
[]
best model saved: step =  15199 dev accu =  tensor(0.7783, device='cuda:0')

Validation Results
Global Steps: 15199
Valid Loss: 0.46233
Valid Accuracy: 0.77827
time stamp: 7847.880939245224
[]

Validation Results
Global Steps: 15399
Valid Loss: 0.46985
Valid Accuracy: 0.77357
time stamp: 7883.31884765625
[]

Validation Results
Global Steps: 15599
Valid Loss: 0.46596
Valid Accuracy: 0.77718
time stamp: 7918.1898057460785
[]

Validation Results
Global Steps: 15799
Valid Loss: 0.46233
Valid Accuracy: 0.77604
time stamp: 7953.39657330513
[]

Validation Results
Global Steps: 15999
Valid Loss: 0.45990
Valid Accuracy: 0.77758
time stamp: 7988.381134986877
[]

Validation Results
Global Steps: 16199
Valid Loss: 0.45910
Valid Accuracy: 0.77790
time stamp: 8023.5686202049255
[]
best model saved: step =  16399 dev accu =  tensor(0.7787, device='cuda:0')

Validation Results
Global Steps: 16399
Valid Loss: 0.45652
Valid Accuracy: 0.77868
time stamp: 8058.456331253052
[]

Validation Results
Global Steps: 16599
Valid Loss: 0.46298
Valid Accuracy: 0.77653
time stamp: 8093.392799377441
[]
best model saved: step =  16799 dev accu =  tensor(0.7796, device='cuda:0')

Validation Results
Global Steps: 16799
Valid Loss: 0.46344
Valid Accuracy: 0.77963
time stamp: 8128.181306600571
[]

Validation Results
Global Steps: 16999
Valid Loss: 0.46854
Valid Accuracy: 0.77489
time stamp: 8163.338263511658
[]

Validation Results
Global Steps: 17199
Valid Loss: 0.45976
Valid Accuracy: 0.77785
time stamp: 8198.13368678093
[]

Validation Results
Global Steps: 17399
Valid Loss: 0.45738
Valid Accuracy: 0.77864
time stamp: 8233.313927412033
[]

Validation Results
Global Steps: 17599
Valid Loss: 0.47834
Valid Accuracy: 0.76736
time stamp: 8268.361170053482
[]
best model saved: step =  17799 dev accu =  tensor(0.7799, device='cuda:0')

Validation Results
Global Steps: 17799
Valid Loss: 0.45615
Valid Accuracy: 0.77992
time stamp: 8303.27691936493
[]

Validation Results
Global Steps: 17999
Valid Loss: 0.45915
Valid Accuracy: 0.77818
time stamp: 8338.64463877678
[]

Validation Results
Global Steps: 18199
Valid Loss: 0.45689
Valid Accuracy: 0.77974
time stamp: 8373.573673009872
[]

Validation Results
Global Steps: 18399
Valid Loss: 0.45893
Valid Accuracy: 0.77923
time stamp: 8408.468684196472
[]

Validation Results
Global Steps: 18599
Valid Loss: 0.45324
Valid Accuracy: 0.77963
time stamp: 8443.250631570816
[]

Validation Results
Global Steps: 18799
Valid Loss: 0.45762
Valid Accuracy: 0.77936
time stamp: 8478.267436742783
[]

Validation Results
Global Steps: 18999
Valid Loss: 0.47510
Valid Accuracy: 0.76980
time stamp: 8512.937189102173
[]

Validation Results
Global Steps: 19199
Valid Loss: 0.45804
Valid Accuracy: 0.77882
time stamp: 8547.715676784515
[]
best model saved: step =  19399 dev accu =  tensor(0.7838, device='cuda:0')

Validation Results
Global Steps: 19399
Valid Loss: 0.44997
Valid Accuracy: 0.78378
time stamp: 8582.774741649628
[]

Validation Results
Global Steps: 19599
Valid Loss: 0.47620
Valid Accuracy: 0.77326
time stamp: 8617.501546621323
[]

Validation Results
Global Steps: 19799
Valid Loss: 0.45428
Valid Accuracy: 0.78100
time stamp: 8652.597570896149
[]

Validation Results
Global Steps: 19999
Valid Loss: 0.46288
Valid Accuracy: 0.77595
time stamp: 8687.53758430481
[]

Validation Results
Global Steps: 20199
Valid Loss: 0.46113
Valid Accuracy: 0.77792
time stamp: 8722.675128936768
[]

Validation Results
Global Steps: 20399
Valid Loss: 0.47225
Valid Accuracy: 0.77794
time stamp: 8757.99189209938
[]

Validation Results
Global Steps: 20599
Valid Loss: 0.45548
Valid Accuracy: 0.78007
time stamp: 8793.202642202377
[]

Validation Results
Global Steps: 20799
Valid Loss: 0.47141
Valid Accuracy: 0.77709
time stamp: 8828.43738436699
[]

Validation Results
Global Steps: 20999
Valid Loss: 0.46109
Valid Accuracy: 0.78230
time stamp: 8863.539377689362
[]

Validation Results
Global Steps: 21199
Valid Loss: 0.45439
Valid Accuracy: 0.78222
time stamp: 8898.638104200363
[]

Validation Results
Global Steps: 21399
Valid Loss: 0.44904
Valid Accuracy: 0.78229
time stamp: 8933.90894651413
[]

Validation Results
Global Steps: 21599
Valid Loss: 0.44945
Valid Accuracy: 0.78203
time stamp: 8968.831231117249
[]
best model saved: step =  21799 dev accu =  tensor(0.7851, device='cuda:0')

Validation Results
Global Steps: 21799
Valid Loss: 0.44509
Valid Accuracy: 0.78512
time stamp: 9003.703456401825
[]
best model saved: step =  21999 dev accu =  tensor(0.7863, device='cuda:0')

Validation Results
Global Steps: 21999
Valid Loss: 0.44477
Valid Accuracy: 0.78631
time stamp: 9038.845396995544
[]

Validation Results
Global Steps: 22199
Valid Loss: 0.45181
Valid Accuracy: 0.78600
time stamp: 9073.897760391235
[]

Validation Results
Global Steps: 22399
Valid Loss: 0.45335
Valid Accuracy: 0.78505
time stamp: 9108.98661184311
[]

Validation Results
Global Steps: 22599
Valid Loss: 0.45175
Valid Accuracy: 0.78382
time stamp: 9144.308439016342
[]

Validation Results
Global Steps: 22799
Valid Loss: 0.44639
Valid Accuracy: 0.78626
time stamp: 9179.044475078583
[]

Validation Results
Global Steps: 22999
Valid Loss: 0.45343
Valid Accuracy: 0.78511
time stamp: 9214.553140640259
[]

Validation Results
Global Steps: 23199
Valid Loss: 0.44487
Valid Accuracy: 0.78606
time stamp: 9249.129528284073
[]

Validation Results
Global Steps: 23399
Valid Loss: 0.47023
Valid Accuracy: 0.77585
time stamp: 9284.047102451324
[]

Validation Results
Global Steps: 23599
Valid Loss: 0.45275
Valid Accuracy: 0.78263
time stamp: 9319.133340120316
[]
best model saved: step =  23799 dev accu =  tensor(0.7873, device='cuda:0')

Validation Results
Global Steps: 23799
Valid Loss: 0.44488
Valid Accuracy: 0.78730
time stamp: 9354.014855861664
[]

Validation Results
Global Steps: 23999
Valid Loss: 0.44807
Valid Accuracy: 0.78572
time stamp: 9388.81211066246
[]
best model saved: step =  24199 dev accu =  tensor(0.7892, device='cuda:0')

Validation Results
Global Steps: 24199
Valid Loss: 0.44308
Valid Accuracy: 0.78915
time stamp: 9423.48126578331
[]

Validation Results
Global Steps: 24399
Valid Loss: 0.45129
Valid Accuracy: 0.78654
time stamp: 9459.16082072258
[]

Validation Results
Global Steps: 24599
Valid Loss: 0.45404
Valid Accuracy: 0.78458
time stamp: 9494.065563678741
[]

Validation Results
Global Steps: 24799
Valid Loss: 0.45272
Valid Accuracy: 0.78652
time stamp: 9528.949352502823
[]

Validation Results
Global Steps: 24999
Valid Loss: 0.44605
Valid Accuracy: 0.78727
time stamp: 9564.175770521164
[]

Validation Results
Global Steps: 25199
Valid Loss: 0.45876
Valid Accuracy: 0.78517
time stamp: 9599.30515241623
[]
best model saved: step =  25399 dev accu =  tensor(0.7900, device='cuda:0')

Validation Results
Global Steps: 25399
Valid Loss: 0.43973
Valid Accuracy: 0.78995
time stamp: 9634.326216936111
[]

Validation Results
Global Steps: 25599
Valid Loss: 0.45964
Valid Accuracy: 0.78380
time stamp: 9669.05963921547
[]

Validation Results
Global Steps: 25799
Valid Loss: 0.44806
Valid Accuracy: 0.78521
time stamp: 9704.06479549408
[]

Validation Results
Global Steps: 25999
Valid Loss: 0.45046
Valid Accuracy: 0.78542
time stamp: 9739.148380279541
[]

Validation Results
Global Steps: 26199
Valid Loss: 0.44099
Valid Accuracy: 0.78982
time stamp: 9774.385281324387
[]
best model saved: step =  26399 dev accu =  tensor(0.7903, device='cuda:0')

Validation Results
Global Steps: 26399
Valid Loss: 0.44320
Valid Accuracy: 0.79029
time stamp: 9809.779995918274
[]

Validation Results
Global Steps: 26599
Valid Loss: 0.44473
Valid Accuracy: 0.78866
time stamp: 9844.695251226425
[]
best model saved: step =  26799 dev accu =  tensor(0.7929, device='cuda:0')

Validation Results
Global Steps: 26799
Valid Loss: 0.43312
Valid Accuracy: 0.79291
time stamp: 9879.395213127136
[]

Validation Results
Global Steps: 26999
Valid Loss: 0.43798
Valid Accuracy: 0.78970
time stamp: 9914.715033769608
[]

Validation Results
Global Steps: 27199
Valid Loss: 0.43900
Valid Accuracy: 0.79173
time stamp: 9949.633209228516
[]

Validation Results
Global Steps: 27399
Valid Loss: 0.44756
Valid Accuracy: 0.78927
time stamp: 9984.660281896591
[]

Validation Results
Global Steps: 27599
Valid Loss: 0.44137
Valid Accuracy: 0.79041
time stamp: 10020.139242649078
[]
best model saved: step =  27799 dev accu =  tensor(0.7935, device='cuda:0')

Validation Results
Global Steps: 27799
Valid Loss: 0.44147
Valid Accuracy: 0.79348
time stamp: 10055.071079969406
[]
best model saved: step =  27999 dev accu =  tensor(0.7949, device='cuda:0')

Validation Results
Global Steps: 27999
Valid Loss: 0.44080
Valid Accuracy: 0.79488
time stamp: 10090.254888772964
[]

Validation Results
Global Steps: 28199
Valid Loss: 0.43690
Valid Accuracy: 0.79349
time stamp: 10125.224985599518
[]

Validation Results
Global Steps: 28399
Valid Loss: 0.43885
Valid Accuracy: 0.79385
time stamp: 10160.471658229828
[]

Validation Results
Global Steps: 28599
Valid Loss: 0.43355
Valid Accuracy: 0.79457
time stamp: 10195.429673671722
[]
best model saved: step =  28799 dev accu =  tensor(0.7963, device='cuda:0')

Validation Results
Global Steps: 28799
Valid Loss: 0.43574
Valid Accuracy: 0.79634
time stamp: 10230.73085308075
[]
best model saved: step =  28999 dev accu =  tensor(0.7972, device='cuda:0')

Validation Results
Global Steps: 28999
Valid Loss: 0.42670
Valid Accuracy: 0.79724
time stamp: 10265.649887084961
[]

Validation Results
Global Steps: 29199
Valid Loss: 0.43534
Valid Accuracy: 0.79523
time stamp: 10300.277794122696
[]

Validation Results
Global Steps: 29399
Valid Loss: 0.43317
Valid Accuracy: 0.79518
time stamp: 10335.712408781052
[]
best model saved: step =  29599 dev accu =  tensor(0.7978, device='cuda:0')

Validation Results
Global Steps: 29599
Valid Loss: 0.42922
Valid Accuracy: 0.79776
time stamp: 10370.7523291111
[]
best model saved: step =  29799 dev accu =  tensor(0.7984, device='cuda:0')

Validation Results
Global Steps: 29799
Valid Loss: 0.43611
Valid Accuracy: 0.79841
time stamp: 10405.553869247437
[]

Validation Results
Global Steps: 29999
Valid Loss: 0.43279
Valid Accuracy: 0.79783
time stamp: 10440.181505203247
total training step (k): 30.0
total training time (s): 10440.182188749313
total training time (ms): 1878673.1728515625
peak memory usage (MB): 12858
allocated memory usage (MB): 641282543
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |   12024 KB |   12858 MB |  626252 GB |  626252 GB |
|       from large pool |    6144 KB |   12846 MB |  622480 GB |  622480 GB |
|       from small pool |    5880 KB |      27 MB |    3772 GB |    3772 GB |
|---------------------------------------------------------------------------|
| Active memory         |   12024 KB |   12858 MB |  626252 GB |  626252 GB |
|       from large pool |    6144 KB |   12846 MB |  622480 GB |  622480 GB |
|       from small pool |    5880 KB |      27 MB |    3772 GB |    3772 GB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   13776 MB |   13776 MB |   13776 MB |       0 B  |
|       from large pool |   13748 MB |   13748 MB |   13748 MB |       0 B  |
|       from small pool |      28 MB |      28 MB |      28 MB |       0 B  |
|---------------------------------------------------------------------------|
| Non-releasable memory |   10503 KB |    2073 MB |  415897 GB |  415897 GB |
|       from large pool |   10240 KB |    2070 MB |  411681 GB |  411681 GB |
|       from small pool |     263 KB |       6 MB |    4216 GB |    4216 GB |
|---------------------------------------------------------------------------|
| Allocations           |     398    |     670    |   35637 K  |   35636 K  |
|       from large pool |       2    |      93    |   13500 K  |   13500 K  |
|       from small pool |     396    |     659    |   22137 K  |   22136 K  |
|---------------------------------------------------------------------------|
| Active allocs         |     398    |     670    |   35637 K  |   35636 K  |
|       from large pool |       2    |      93    |   13500 K  |   13500 K  |
|       from small pool |     396    |     659    |   22137 K  |   22136 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      42    |      42    |      42    |       0    |
|       from large pool |      28    |      28    |      28    |       0    |
|       from small pool |      14    |      14    |      14    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       9    |      37    |   17718 K  |   17718 K  |
|       from large pool |       2    |      20    |    5248 K  |    5248 K  |
|       from small pool |       7    |      24    |   12469 K  |   12469 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

loading the best model from: ./checkpoints/checkpoints-7/lra-yelp1/learnable.model
Evaluation Results
Loss: 0.43566
Accuracy: 0.79859
