GPU list: [0, 1, 2, 3]
[
    {
        "learn_pos_emb": true,
        "tied_weights": false,
        "embedding_dim": 64,
        "transformer_dim": 64,
        "transformer_hidden_dim": 128,
        "head_dim": 32,
        "num_head": 2,
        "num_layers": 4,
        "vocab_size": 512,
        "max_seq_len": 1024,
        "dropout_prob": 0.1,
        "attention_dropout": 0.1,
        "pooling_mode": "MEAN",
        "num_classes": 4,
        "block_size": 32,
        "batch_size": 128,
        "density": 0.08,
        "mixed_precision": true,
        "random_seed": 9,
        "task": "lra-news1"
    },
    {
        "batch_size": 512,
        "learning_rate": 0.0009,
        "warmup": 80,
        "lr_decay": "linear",
        "weight_decay": 0,
        "eval_frequency": 200,
        "num_train_steps": 30000,
        "num_init_steps": 3000,
        "num_eval_steps": 200,
        "num_dense_train_steps": 1000,
        "patience": 10,
        "attn_loss_scale": 0.01
    }
]
attn_mask compile
attn_mask compile
attn_mask compile
attn_mask compile
DataParallel(
  (module): ModelForSC(
    (model): Model(
      (embeddings): Embeddings(
        (word_embeddings): Embedding(512, 64)
        (position_embeddings): Embedding(1024, 64)
        (dropout): Dropout(p=0.1, inplace=False)
      )
      (transformer_0): TransformerLayer(
        (norm1): LayerNorm((64,), eps=1e-05, elementwise_affine=True)
        (mha): Attention(
          (W_q): Linear(in_features=64, out_features=64, bias=True)
          (W_k): Linear(in_features=64, out_features=64, bias=True)
          (W_v): Linear(in_features=64, out_features=64, bias=True)
          (avg_pool): AvgPool2d(kernel_size=32, stride=32, padding=0)
          (MSEloss): MSELoss()
          (attn): CUDAMaskAttention()
          (ff): Linear(in_features=64, out_features=64, bias=True)
        )
        (dropout1): Dropout(p=0.1, inplace=False)
        (norm2): LayerNorm((64,), eps=1e-05, elementwise_affine=True)
        (mlpblock): Sequential(
          (0): Linear(in_features=64, out_features=128, bias=True)
          (1): GELU(approximate='none')
          (2): Dropout(p=0.1, inplace=False)
          (3): Linear(in_features=128, out_features=64, bias=True)
          (4): Dropout(p=0.1, inplace=False)
        )
      )
      (transformer_1): TransformerLayer(
        (norm1): LayerNorm((64,), eps=1e-05, elementwise_affine=True)
        (mha): Attention(
          (W_q): Linear(in_features=64, out_features=64, bias=True)
          (W_k): Linear(in_features=64, out_features=64, bias=True)
          (W_v): Linear(in_features=64, out_features=64, bias=True)
          (avg_pool): AvgPool2d(kernel_size=32, stride=32, padding=0)
          (MSEloss): MSELoss()
          (attn): CUDAMaskAttention()
          (ff): Linear(in_features=64, out_features=64, bias=True)
        )
        (dropout1): Dropout(p=0.1, inplace=False)
        (norm2): LayerNorm((64,), eps=1e-05, elementwise_affine=True)
        (mlpblock): Sequential(
          (0): Linear(in_features=64, out_features=128, bias=True)
          (1): GELU(approximate='none')
          (2): Dropout(p=0.1, inplace=False)
          (3): Linear(in_features=128, out_features=64, bias=True)
          (4): Dropout(p=0.1, inplace=False)
        )
      )
      (transformer_2): TransformerLayer(
        (norm1): LayerNorm((64,), eps=1e-05, elementwise_affine=True)
        (mha): Attention(
          (W_q): Linear(in_features=64, out_features=64, bias=True)
          (W_k): Linear(in_features=64, out_features=64, bias=True)
          (W_v): Linear(in_features=64, out_features=64, bias=True)
          (avg_pool): AvgPool2d(kernel_size=32, stride=32, padding=0)
          (MSEloss): MSELoss()
          (attn): CUDAMaskAttention()
          (ff): Linear(in_features=64, out_features=64, bias=True)
        )
        (dropout1): Dropout(p=0.1, inplace=False)
        (norm2): LayerNorm((64,), eps=1e-05, elementwise_affine=True)
        (mlpblock): Sequential(
          (0): Linear(in_features=64, out_features=128, bias=True)
          (1): GELU(approximate='none')
          (2): Dropout(p=0.1, inplace=False)
          (3): Linear(in_features=128, out_features=64, bias=True)
          (4): Dropout(p=0.1, inplace=False)
        )
      )
      (transformer_3): TransformerLayer(
        (norm1): LayerNorm((64,), eps=1e-05, elementwise_affine=True)
        (mha): Attention(
          (W_q): Linear(in_features=64, out_features=64, bias=True)
          (W_k): Linear(in_features=64, out_features=64, bias=True)
          (W_v): Linear(in_features=64, out_features=64, bias=True)
          (avg_pool): AvgPool2d(kernel_size=32, stride=32, padding=0)
          (MSEloss): MSELoss()
          (attn): CUDAMaskAttention()
          (ff): Linear(in_features=64, out_features=64, bias=True)
        )
        (dropout1): Dropout(p=0.1, inplace=False)
        (norm2): LayerNorm((64,), eps=1e-05, elementwise_affine=True)
        (mlpblock): Sequential(
          (0): Linear(in_features=64, out_features=128, bias=True)
          (1): GELU(approximate='none')
          (2): Dropout(p=0.1, inplace=False)
          (3): Linear(in_features=128, out_features=64, bias=True)
          (4): Dropout(p=0.1, inplace=False)
        )
      )
      (norm): LayerNorm((64,), eps=1e-05, elementwise_affine=True)
    )
    (seq_classifer): SCHead(
      (mlpblock): Sequential(
        (0): Linear(in_features=64, out_features=128, bias=True)
        (1): ReLU()
        (2): Linear(in_features=128, out_features=4, bias=True)
      )
    )
  )
)
parameter_size: [torch.Size([512, 64]), torch.Size([1024, 64]), torch.Size([64]), torch.Size([64]), torch.Size([32, 32]), torch.Size([64, 64]), torch.Size([64]), torch.Size([64, 64]), torch.Size([64]), torch.Size([64, 64]), torch.Size([64]), torch.Size([64, 64]), torch.Size([64]), torch.Size([64]), torch.Size([64]), torch.Size([128, 64]), torch.Size([128]), torch.Size([64, 128]), torch.Size([64]), torch.Size([64]), torch.Size([64]), torch.Size([32, 32]), torch.Size([64, 64]), torch.Size([64]), torch.Size([64, 64]), torch.Size([64]), torch.Size([64, 64]), torch.Size([64]), torch.Size([64, 64]), torch.Size([64]), torch.Size([64]), torch.Size([64]), torch.Size([128, 64]), torch.Size([128]), torch.Size([64, 128]), torch.Size([64]), torch.Size([64]), torch.Size([64]), torch.Size([32, 32]), torch.Size([64, 64]), torch.Size([64]), torch.Size([64, 64]), torch.Size([64]), torch.Size([64, 64]), torch.Size([64]), torch.Size([64, 64]), torch.Size([64]), torch.Size([64]), torch.Size([64]), torch.Size([128, 64]), torch.Size([128]), torch.Size([64, 128]), torch.Size([64]), torch.Size([64]), torch.Size([64]), torch.Size([32, 32]), torch.Size([64, 64]), torch.Size([64]), torch.Size([64, 64]), torch.Size([64]), torch.Size([64, 64]), torch.Size([64]), torch.Size([64, 64]), torch.Size([64]), torch.Size([64]), torch.Size([64]), torch.Size([128, 64]), torch.Size([128]), torch.Size([64, 128]), torch.Size([64]), torch.Size([64]), torch.Size([64]), torch.Size([128, 64]), torch.Size([128]), torch.Size([4, 128]), torch.Size([4])]
num_parameter: 245252
Loaded ../Skyformer/data/lra_processed/lra-news1.train.pickle... size=120000
Loaded ../Skyformer/data/lra_processed/lra-news1.dev.pickle... size=7600
Loaded ../Skyformer/data/lra_processed/lra-news1.test.pickle... size=7600
accumu_steps=1
module.model.transformer_0.mha.pattern saved
module.model.transformer_1.mha.pattern saved
module.model.transformer_2.mha.pattern saved
module.model.transformer_3.mha.pattern saved
./pickle/lra-news1/module.model.transformer_0.mha.pattern.pickle
tensor([231,  66, 957,  99, 297, 198, 594, 495,   0, 561, 233, 295, 627, 363,
        235, 359, 528, 253, 935, 201, 294, 125, 931,  93, 930, 243, 615, 132,
        726, 239, 487, 241, 551, 605, 946, 199, 230, 573, 945, 242, 583, 240,
        519, 637, 947,  29, 928, 135, 228, 891, 396,   7, 224, 221, 934, 103,
        227, 541, 944, 317, 937, 299, 361, 825, 509, 943,  70, 194, 115, 611,
        563, 625, 246, 711,  33, 693,  39, 225,  83, 610, 203],
       device='cuda:0')
tensor(81, device='cuda:0')
block_attn_mask compile
./pickle/lra-news1/module.model.transformer_1.mha.pattern.pickle
tensor([ 990,  363,  264,  759,  198,  891,  924,  222,  966,  462,  894,  987,
         858,  660,  528,  396,  798,  984,  297,  766,  983,  382,  971,   99,
         792,  594,  957,  286,  968,  606,  978,  478,  974,  414,  972,  126,
         963,  219,  870, 1023,  200,  262,  379,  875,  862,  986,  510,  975,
         542,  976,  495,  366,  459,  330,  763,  887,  734,  982,  670,  980,
         539,  880,  364,  395,  726,  372,  651,  638,  979,  270,  456,  267,
         360,  667,  884,  407,  748,  318,  969,  926,  988], device='cuda:0')
tensor(81, device='cuda:0')
block_attn_mask compile
./pickle/lra-news1/module.model.transformer_2.mha.pattern.pickle
tensor([297, 165, 396,  99, 429,  66, 231,  33, 726, 561, 132, 825, 363, 300,
        393,  73, 290, 528, 169, 293, 693, 792, 172, 389, 105, 291, 433, 557,
        330, 891,   0, 198, 167, 229, 924, 236, 391, 301, 425, 233, 295, 118,
        707, 237, 423, 264, 397, 428, 305, 553,  44, 385,  76, 386, 438, 717,
        990, 299, 361, 566, 721, 310, 713, 173, 421, 101, 163,  37, 161, 406,
        716, 185, 805, 113, 547, 182, 709, 401, 556, 241, 551],
       device='cuda:0')
tensor(81, device='cuda:0')
block_attn_mask compile
./pickle/lra-news1/module.model.transformer_3.mha.pattern.pickle
tensor([ 462,  627,   99,  363,  660,   66,  924,  297,  495,  858,  891, 1023,
         132,  198,  825,  366,  459,  476,  910,  302,  457,  726,  231,  372,
         651,   73,  290,   33,  474,  846,  371,  619,  380,  907,  668,  916,
         463,  494,  206,  454,  203,  358,  634,  851,  468,  654,  561,  299,
         361,  429,  110,  451,   34,   65,  330,  367,  491,  123,  867,  122,
         835,  632,  787,  102,  195,   72,  258,  396,  860,  922,  308,  649,
         264,  111,  483,  505,  815,  759,  792,  927, 1020], device='cuda:0')
tensor(81, device='cuda:0')
block_attn_mask compile
total pattern searching time (s): 0.10701370239257812
[]
best model saved: step =  199 dev accu =  tensor(0.4844, device='cuda:0')

Validation Results
Global Steps: 199
Valid Loss: 1.14467
Valid Accuracy: 0.48444
time stamp: 60.85710644721985
[]
best model saved: step =  399 dev accu =  tensor(0.5344, device='cuda:0')

Validation Results
Global Steps: 399
Valid Loss: 1.04355
Valid Accuracy: 0.53440
time stamp: 102.02839016914368
[]
best model saved: step =  599 dev accu =  tensor(0.5658, device='cuda:0')

Validation Results
Global Steps: 599
Valid Loss: 1.01100
Valid Accuracy: 0.56579
time stamp: 143.5195140838623
[]
best model saved: step =  799 dev accu =  tensor(0.5969, device='cuda:0')

Validation Results
Global Steps: 799
Valid Loss: 0.96687
Valid Accuracy: 0.59688
time stamp: 184.82537055015564
[]
best model saved: step =  999 dev accu =  tensor(0.6134, device='cuda:0')

Validation Results
Global Steps: 999
Valid Loss: 0.93588
Valid Accuracy: 0.61336
time stamp: 226.4262137413025
[]
best model saved: step =  1199 dev accu =  tensor(0.6222, device='cuda:0')

Validation Results
Global Steps: 1199
Valid Loss: 0.91369
Valid Accuracy: 0.62224
time stamp: 267.76811695098877
[]
best model saved: step =  1399 dev accu =  tensor(0.6332, device='cuda:0')

Validation Results
Global Steps: 1399
Valid Loss: 0.89518
Valid Accuracy: 0.63324
time stamp: 309.08139848709106
[]

Validation Results
Global Steps: 1599
Valid Loss: 0.90752
Valid Accuracy: 0.62306
time stamp: 350.50822854042053
[]
best model saved: step =  1799 dev accu =  tensor(0.6343, device='cuda:0')

Validation Results
Global Steps: 1799
Valid Loss: 0.89517
Valid Accuracy: 0.63432
time stamp: 391.94105291366577
[]
best model saved: step =  1999 dev accu =  tensor(0.6412, device='cuda:0')

Validation Results
Global Steps: 1999
Valid Loss: 0.87524
Valid Accuracy: 0.64120
time stamp: 433.4661431312561
[]
best model saved: step =  2199 dev accu =  tensor(0.6424, device='cuda:0')

Validation Results
Global Steps: 2199
Valid Loss: 0.87658
Valid Accuracy: 0.64237
time stamp: 474.9355707168579
[]
best model saved: step =  2399 dev accu =  tensor(0.6459, device='cuda:0')

Validation Results
Global Steps: 2399
Valid Loss: 0.86505
Valid Accuracy: 0.64588
time stamp: 516.3860502243042
[]

Validation Results
Global Steps: 2599
Valid Loss: 0.88423
Valid Accuracy: 0.64401
time stamp: 558.2130341529846
[]
best model saved: step =  2799 dev accu =  tensor(0.6543, device='cuda:0')

Validation Results
Global Steps: 2799
Valid Loss: 0.86443
Valid Accuracy: 0.65433
time stamp: 599.8351275920868
[]
best model saved: step =  2999 dev accu =  tensor(0.6594, device='cuda:0')

Validation Results
Global Steps: 2999
Valid Loss: 0.85100
Valid Accuracy: 0.65940
time stamp: 641.0403401851654
[]
best model saved: step =  3199 dev accu =  tensor(0.6605, device='cuda:0')

Validation Results
Global Steps: 3199
Valid Loss: 0.86337
Valid Accuracy: 0.66046
time stamp: 682.4838645458221
[]

Validation Results
Global Steps: 3399
Valid Loss: 0.85088
Valid Accuracy: 0.65604
time stamp: 723.6768627166748
[]
best model saved: step =  3599 dev accu =  tensor(0.6610, device='cuda:0')

Validation Results
Global Steps: 3599
Valid Loss: 0.84464
Valid Accuracy: 0.66097
time stamp: 765.2422890663147
[]

Validation Results
Global Steps: 3799
Valid Loss: 0.85227
Valid Accuracy: 0.65857
time stamp: 806.7268390655518
[]

Validation Results
Global Steps: 3999
Valid Loss: 0.84973
Valid Accuracy: 0.65783
time stamp: 848.0288944244385
[]
best model saved: step =  4199 dev accu =  tensor(0.6678, device='cuda:0')

Validation Results
Global Steps: 4199
Valid Loss: 0.84923
Valid Accuracy: 0.66776
time stamp: 889.5288784503937
[]

Validation Results
Global Steps: 4399
Valid Loss: 0.84924
Valid Accuracy: 0.65834
time stamp: 931.1085178852081
[]
best model saved: step =  4599 dev accu =  tensor(0.6760, device='cuda:0')

Validation Results
Global Steps: 4599
Valid Loss: 0.82531
Valid Accuracy: 0.67597
time stamp: 972.4815504550934
[]

Validation Results
Global Steps: 4799
Valid Loss: 0.82435
Valid Accuracy: 0.67317
time stamp: 1013.5851383209229
[]

Validation Results
Global Steps: 4999
Valid Loss: 0.84148
Valid Accuracy: 0.66889
time stamp: 1054.8229587078094
[]
best model saved: step =  5199 dev accu =  tensor(0.6776, device='cuda:0')

Validation Results
Global Steps: 5199
Valid Loss: 0.82071
Valid Accuracy: 0.67760
time stamp: 1096.0908675193787
[]
best model saved: step =  5399 dev accu =  tensor(0.6821, device='cuda:0')

Validation Results
Global Steps: 5399
Valid Loss: 0.81591
Valid Accuracy: 0.68209
time stamp: 1137.3681342601776
[]

Validation Results
Global Steps: 5599
Valid Loss: 0.82307
Valid Accuracy: 0.67836
time stamp: 1178.839448928833
[]

Validation Results
Global Steps: 5799
Valid Loss: 0.83916
Valid Accuracy: 0.67327
time stamp: 1220.4282593727112
[]

Validation Results
Global Steps: 5999
Valid Loss: 0.82391
Valid Accuracy: 0.67720
time stamp: 1261.7650244235992
[]
best model saved: step =  6199 dev accu =  tensor(0.6861, device='cuda:0')

Validation Results
Global Steps: 6199
Valid Loss: 0.81479
Valid Accuracy: 0.68613
time stamp: 1303.645456790924
[]

Validation Results
Global Steps: 6399
Valid Loss: 0.80813
Valid Accuracy: 0.68604
time stamp: 1345.1275935173035
[]
best model saved: step =  6599 dev accu =  tensor(0.6875, device='cuda:0')

Validation Results
Global Steps: 6599
Valid Loss: 0.80128
Valid Accuracy: 0.68747
time stamp: 1386.6135671138763
[]

Validation Results
Global Steps: 6799
Valid Loss: 0.80457
Valid Accuracy: 0.68733
time stamp: 1427.5673425197601
[]
best model saved: step =  6999 dev accu =  tensor(0.6935, device='cuda:0')

Validation Results
Global Steps: 6999
Valid Loss: 0.79341
Valid Accuracy: 0.69354
time stamp: 1468.7497301101685
[]

Validation Results
Global Steps: 7199
Valid Loss: 0.79123
Valid Accuracy: 0.69298
time stamp: 1510.0487685203552
[]
best model saved: step =  7399 dev accu =  tensor(0.6945, device='cuda:0')

Validation Results
Global Steps: 7399
Valid Loss: 0.79265
Valid Accuracy: 0.69447
time stamp: 1551.3939654827118
[]

Validation Results
Global Steps: 7599
Valid Loss: 0.79584
Valid Accuracy: 0.68973
time stamp: 1592.6606018543243
[]

Validation Results
Global Steps: 7799
Valid Loss: 0.80572
Valid Accuracy: 0.69287
time stamp: 1634.0280539989471
[]
best model saved: step =  7999 dev accu =  tensor(0.6961, device='cuda:0')

Validation Results
Global Steps: 7999
Valid Loss: 0.78655
Valid Accuracy: 0.69607
time stamp: 1675.4908373355865
[]

Validation Results
Global Steps: 8199
Valid Loss: 0.78661
Valid Accuracy: 0.69262
time stamp: 1716.7747886180878
[]
best model saved: step =  8399 dev accu =  tensor(0.6970, device='cuda:0')

Validation Results
Global Steps: 8399
Valid Loss: 0.77964
Valid Accuracy: 0.69698
time stamp: 1758.2169089317322
[]
best model saved: step =  8599 dev accu =  tensor(0.7034, device='cuda:0')

Validation Results
Global Steps: 8599
Valid Loss: 0.76932
Valid Accuracy: 0.70343
time stamp: 1799.5882983207703
[]

Validation Results
Global Steps: 8799
Valid Loss: 0.77908
Valid Accuracy: 0.70004
time stamp: 1841.135000705719
[]

Validation Results
Global Steps: 8999
Valid Loss: 0.77486
Valid Accuracy: 0.69884
time stamp: 1882.6887686252594
[]
best model saved: step =  9199 dev accu =  tensor(0.7079, device='cuda:0')

Validation Results
Global Steps: 9199
Valid Loss: 0.75898
Valid Accuracy: 0.70789
time stamp: 1923.8602125644684
[]

Validation Results
Global Steps: 9399
Valid Loss: 0.77831
Valid Accuracy: 0.70211
time stamp: 1964.9726729393005
[]

Validation Results
Global Steps: 9599
Valid Loss: 0.76638
Valid Accuracy: 0.70664
time stamp: 2006.572023153305
[]

Validation Results
Global Steps: 9799
Valid Loss: 0.79349
Valid Accuracy: 0.69397
time stamp: 2047.8995487689972
[]
best model saved: step =  9999 dev accu =  tensor(0.7103, device='cuda:0')

Validation Results
Global Steps: 9999
Valid Loss: 0.75788
Valid Accuracy: 0.71025
time stamp: 2089.3115553855896
[]
best model saved: step =  10199 dev accu =  tensor(0.7146, device='cuda:0')

Validation Results
Global Steps: 10199
Valid Loss: 0.75055
Valid Accuracy: 0.71463
time stamp: 2130.819839000702
[]

Validation Results
Global Steps: 10399
Valid Loss: 0.75701
Valid Accuracy: 0.71051
time stamp: 2172.142016649246
[]

Validation Results
Global Steps: 10599
Valid Loss: 0.74983
Valid Accuracy: 0.71052
time stamp: 2213.478950738907
[]

Validation Results
Global Steps: 10799
Valid Loss: 0.75941
Valid Accuracy: 0.70804
time stamp: 2255.0871851444244
[]
best model saved: step =  10999 dev accu =  tensor(0.7207, device='cuda:0')

Validation Results
Global Steps: 10999
Valid Loss: 0.72227
Valid Accuracy: 0.72070
time stamp: 2296.4428431987762
[]

Validation Results
Global Steps: 11199
Valid Loss: 0.73894
Valid Accuracy: 0.71792
time stamp: 2337.784095287323
[]

Validation Results
Global Steps: 11399
Valid Loss: 0.74981
Valid Accuracy: 0.71754
time stamp: 2379.254291534424
[]
best model saved: step =  11599 dev accu =  tensor(0.7263, device='cuda:0')

Validation Results
Global Steps: 11599
Valid Loss: 0.72571
Valid Accuracy: 0.72627
time stamp: 2420.9904136657715
[]

Validation Results
Global Steps: 11799
Valid Loss: 0.73069
Valid Accuracy: 0.72091
time stamp: 2462.463531970978
[]

Validation Results
Global Steps: 11999
Valid Loss: 0.73788
Valid Accuracy: 0.71931
time stamp: 2504.0371973514557
[]
best model saved: step =  12199 dev accu =  tensor(0.7291, device='cuda:0')

Validation Results
Global Steps: 12199
Valid Loss: 0.71451
Valid Accuracy: 0.72913
time stamp: 2545.475215435028
[]
best model saved: step =  12399 dev accu =  tensor(0.7296, device='cuda:0')

Validation Results
Global Steps: 12399
Valid Loss: 0.70177
Valid Accuracy: 0.72965
time stamp: 2587.249179840088
[]
best model saved: step =  12599 dev accu =  tensor(0.7312, device='cuda:0')

Validation Results
Global Steps: 12599
Valid Loss: 0.70326
Valid Accuracy: 0.73118
time stamp: 2628.6302106380463
[]
best model saved: step =  12799 dev accu =  tensor(0.7356, device='cuda:0')

Validation Results
Global Steps: 12799
Valid Loss: 0.69438
Valid Accuracy: 0.73563
time stamp: 2669.600720643997
[]

Validation Results
Global Steps: 12999
Valid Loss: 0.71322
Valid Accuracy: 0.72862
time stamp: 2710.783149242401
[]

Validation Results
Global Steps: 13199
Valid Loss: 0.73061
Valid Accuracy: 0.72674
time stamp: 2752.648134946823
[]
best model saved: step =  13399 dev accu =  tensor(0.7419, device='cuda:0')

Validation Results
Global Steps: 13399
Valid Loss: 0.68972
Valid Accuracy: 0.74190
time stamp: 2794.487125635147
[]
best model saved: step =  13599 dev accu =  tensor(0.7441, device='cuda:0')

Validation Results
Global Steps: 13599
Valid Loss: 0.68986
Valid Accuracy: 0.74408
time stamp: 2835.8263037204742
[]

Validation Results
Global Steps: 13799
Valid Loss: 0.68762
Valid Accuracy: 0.73848
time stamp: 2877.1243896484375
[]
best model saved: step =  13999 dev accu =  tensor(0.7451, device='cuda:0')

Validation Results
Global Steps: 13999
Valid Loss: 0.67237
Valid Accuracy: 0.74515
time stamp: 2918.6353602409363
[]
best model saved: step =  14199 dev accu =  tensor(0.7495, device='cuda:0')

Validation Results
Global Steps: 14199
Valid Loss: 0.67144
Valid Accuracy: 0.74951
time stamp: 2959.748785495758
[]

Validation Results
Global Steps: 14399
Valid Loss: 0.66727
Valid Accuracy: 0.74819
time stamp: 3001.1996517181396
[]
best model saved: step =  14599 dev accu =  tensor(0.7565, device='cuda:0')

Validation Results
Global Steps: 14599
Valid Loss: 0.65846
Valid Accuracy: 0.75646
time stamp: 3042.663798570633
[]

Validation Results
Global Steps: 14799
Valid Loss: 0.68462
Valid Accuracy: 0.74636
time stamp: 3083.902161836624
[]
best model saved: step =  14999 dev accu =  tensor(0.7577, device='cuda:0')

Validation Results
Global Steps: 14999
Valid Loss: 0.64755
Valid Accuracy: 0.75772
time stamp: 3125.390632867813
[]

Validation Results
Global Steps: 15199
Valid Loss: 0.64894
Valid Accuracy: 0.75692
time stamp: 3166.609977722168
[]

Validation Results
Global Steps: 15399
Valid Loss: 0.64660
Valid Accuracy: 0.75409
time stamp: 3207.935926914215
[]
best model saved: step =  15599 dev accu =  tensor(0.7648, device='cuda:0')

Validation Results
Global Steps: 15599
Valid Loss: 0.64123
Valid Accuracy: 0.76481
time stamp: 3249.3909356594086
[]
best model saved: step =  15799 dev accu =  tensor(0.7678, device='cuda:0')

Validation Results
Global Steps: 15799
Valid Loss: 0.63058
Valid Accuracy: 0.76781
time stamp: 3290.6986327171326
[]

Validation Results
Global Steps: 15999
Valid Loss: 0.63817
Valid Accuracy: 0.76507
time stamp: 3331.9691426754
[]

Validation Results
Global Steps: 16199
Valid Loss: 0.63317
Valid Accuracy: 0.76439
time stamp: 3373.621270418167
[]

Validation Results
Global Steps: 16399
Valid Loss: 0.63691
Valid Accuracy: 0.76382
time stamp: 3415.00931930542
[]

Validation Results
Global Steps: 16599
Valid Loss: 0.61976
Valid Accuracy: 0.76618
time stamp: 3456.2609720230103
[]

Validation Results
Global Steps: 16799
Valid Loss: 0.63090
Valid Accuracy: 0.76167
time stamp: 3497.859227657318
[]
best model saved: step =  16999 dev accu =  tensor(0.7735, device='cuda:0')

Validation Results
Global Steps: 16999
Valid Loss: 0.61343
Valid Accuracy: 0.77353
time stamp: 3539.398074388504
[]

Validation Results
Global Steps: 17199
Valid Loss: 0.63157
Valid Accuracy: 0.76776
time stamp: 3580.84153342247
[]

Validation Results
Global Steps: 17399
Valid Loss: 0.61842
Valid Accuracy: 0.77109
time stamp: 3622.26025223732
[]

Validation Results
Global Steps: 17599
Valid Loss: 0.62120
Valid Accuracy: 0.77241
time stamp: 3663.535460472107
[]

Validation Results
Global Steps: 17799
Valid Loss: 0.61976
Valid Accuracy: 0.77037
time stamp: 3705.183397293091
[]
best model saved: step =  17999 dev accu =  tensor(0.7758, device='cuda:0')

Validation Results
Global Steps: 17999
Valid Loss: 0.60933
Valid Accuracy: 0.77575
time stamp: 3746.5406651496887
[]
best model saved: step =  18199 dev accu =  tensor(0.7773, device='cuda:0')

Validation Results
Global Steps: 18199
Valid Loss: 0.60417
Valid Accuracy: 0.77734
time stamp: 3787.8086171150208
[]

Validation Results
Global Steps: 18399
Valid Loss: 0.61136
Valid Accuracy: 0.77604
time stamp: 3829.3333356380463
[]

Validation Results
Global Steps: 18599
Valid Loss: 0.62026
Valid Accuracy: 0.77153
time stamp: 3870.7798161506653
[]
best model saved: step =  18799 dev accu =  tensor(0.7867, device='cuda:0')

Validation Results
Global Steps: 18799
Valid Loss: 0.57979
Valid Accuracy: 0.78666
time stamp: 3912.2653515338898
[]

Validation Results
Global Steps: 18999
Valid Loss: 0.58615
Valid Accuracy: 0.78266
time stamp: 3953.5155460834503
[]
best model saved: step =  19199 dev accu =  tensor(0.7888, device='cuda:0')

Validation Results
Global Steps: 19199
Valid Loss: 0.57885
Valid Accuracy: 0.78883
time stamp: 3994.8009555339813
[]

Validation Results
Global Steps: 19399
Valid Loss: 0.57612
Valid Accuracy: 0.78797
time stamp: 4036.333473920822
[]

Validation Results
Global Steps: 19599
Valid Loss: 0.59192
Valid Accuracy: 0.78454
time stamp: 4077.742770910263
[]
best model saved: step =  19799 dev accu =  tensor(0.7904, device='cuda:0')

Validation Results
Global Steps: 19799
Valid Loss: 0.57317
Valid Accuracy: 0.79038
time stamp: 4119.22177195549
[]
best model saved: step =  19999 dev accu =  tensor(0.7948, device='cuda:0')

Validation Results
Global Steps: 19999
Valid Loss: 0.57372
Valid Accuracy: 0.79479
time stamp: 4160.869902849197
[]

Validation Results
Global Steps: 20199
Valid Loss: 0.61610
Valid Accuracy: 0.78208
time stamp: 4202.487319946289
[]

Validation Results
Global Steps: 20399
Valid Loss: 0.59549
Valid Accuracy: 0.78719
time stamp: 4243.759062051773
[]

Validation Results
Global Steps: 20599
Valid Loss: 0.57776
Valid Accuracy: 0.78713
time stamp: 4285.247898101807
[]

Validation Results
Global Steps: 20799
Valid Loss: 0.57185
Valid Accuracy: 0.79183
time stamp: 4326.829079389572
[]
best model saved: step =  20999 dev accu =  tensor(0.8018, device='cuda:0')

Validation Results
Global Steps: 20999
Valid Loss: 0.55067
Valid Accuracy: 0.80184
time stamp: 4368.598963499069
[]

Validation Results
Global Steps: 21199
Valid Loss: 0.55965
Valid Accuracy: 0.79733
time stamp: 4409.925217866898
[]
best model saved: step =  21399 dev accu =  tensor(0.8033, device='cuda:0')

Validation Results
Global Steps: 21399
Valid Loss: 0.54778
Valid Accuracy: 0.80329
time stamp: 4451.129676103592
[]

Validation Results
Global Steps: 21599
Valid Loss: 0.54669
Valid Accuracy: 0.80121
time stamp: 4492.327125549316
[]

Validation Results
Global Steps: 21799
Valid Loss: 0.57288
Valid Accuracy: 0.79711
time stamp: 4533.482658624649
[]
best model saved: step =  21999 dev accu =  tensor(0.8043, device='cuda:0')

Validation Results
Global Steps: 21999
Valid Loss: 0.53837
Valid Accuracy: 0.80432
time stamp: 4574.870526790619
[]
best model saved: step =  22199 dev accu =  tensor(0.8057, device='cuda:0')

Validation Results
Global Steps: 22199
Valid Loss: 0.53966
Valid Accuracy: 0.80573
time stamp: 4616.290692090988
[]

Validation Results
Global Steps: 22399
Valid Loss: 0.56709
Valid Accuracy: 0.79978
time stamp: 4657.837164640427
[]
best model saved: step =  22599 dev accu =  tensor(0.8107, device='cuda:0')

Validation Results
Global Steps: 22599
Valid Loss: 0.53672
Valid Accuracy: 0.81072
time stamp: 4699.655220031738
[]

Validation Results
Global Steps: 22799
Valid Loss: 0.54048
Valid Accuracy: 0.80717
time stamp: 4741.008313417435
[]

Validation Results
Global Steps: 22999
Valid Loss: 0.54094
Valid Accuracy: 0.80374
time stamp: 4782.38124704361
[]

Validation Results
Global Steps: 23199
Valid Loss: 0.54051
Valid Accuracy: 0.80940
time stamp: 4823.399785280228
[]
best model saved: step =  23399 dev accu =  tensor(0.8122, device='cuda:0')

Validation Results
Global Steps: 23399
Valid Loss: 0.51824
Valid Accuracy: 0.81218
time stamp: 4864.64225435257
[]

Validation Results
Global Steps: 23599
Valid Loss: 0.54855
Valid Accuracy: 0.80863
time stamp: 4906.144505023956
[]
best model saved: step =  23799 dev accu =  tensor(0.8220, device='cuda:0')

Validation Results
Global Steps: 23799
Valid Loss: 0.50992
Valid Accuracy: 0.82204
time stamp: 4947.795542001724
[]

Validation Results
Global Steps: 23999
Valid Loss: 0.52370
Valid Accuracy: 0.81399
time stamp: 4989.263302564621
[]

Validation Results
Global Steps: 24199
Valid Loss: 0.51634
Valid Accuracy: 0.82039
time stamp: 5030.8379583358765
[]
best model saved: step =  24399 dev accu =  tensor(0.8244, device='cuda:0')

Validation Results
Global Steps: 24399
Valid Loss: 0.50884
Valid Accuracy: 0.82437
time stamp: 5072.248070478439
[]

Validation Results
Global Steps: 24599
Valid Loss: 0.51337
Valid Accuracy: 0.82092
time stamp: 5113.574442148209
[]

Validation Results
Global Steps: 24799
Valid Loss: 0.52101
Valid Accuracy: 0.81506
time stamp: 5154.99711060524
[]

Validation Results
Global Steps: 24999
Valid Loss: 0.51759
Valid Accuracy: 0.81639
time stamp: 5196.388089418411
[]

Validation Results
Global Steps: 25199
Valid Loss: 0.50613
Valid Accuracy: 0.82261
time stamp: 5237.611887454987
[]

Validation Results
Global Steps: 25399
Valid Loss: 0.51439
Valid Accuracy: 0.82055
time stamp: 5279.194543838501
[]

Validation Results
Global Steps: 25599
Valid Loss: 0.50021
Valid Accuracy: 0.82345
time stamp: 5320.347003936768
[]
best model saved: step =  25799 dev accu =  tensor(0.8290, device='cuda:0')

Validation Results
Global Steps: 25799
Valid Loss: 0.49367
Valid Accuracy: 0.82904
time stamp: 5361.724634885788
[]

Validation Results
Global Steps: 25999
Valid Loss: 0.48052
Valid Accuracy: 0.82549
time stamp: 5402.945588827133
[]

Validation Results
Global Steps: 26199
Valid Loss: 0.52234
Valid Accuracy: 0.81872
time stamp: 5444.363070726395
[]
best model saved: step =  26399 dev accu =  tensor(0.8312, device='cuda:0')

Validation Results
Global Steps: 26399
Valid Loss: 0.48457
Valid Accuracy: 0.83122
time stamp: 5485.383903026581
[]

Validation Results
Global Steps: 26599
Valid Loss: 0.50049
Valid Accuracy: 0.82573
time stamp: 5526.58677482605
[]

Validation Results
Global Steps: 26799
Valid Loss: 0.49532
Valid Accuracy: 0.82501
time stamp: 5568.076724767685
[]
best model saved: step =  26999 dev accu =  tensor(0.8332, device='cuda:0')

Validation Results
Global Steps: 26999
Valid Loss: 0.48620
Valid Accuracy: 0.83320
time stamp: 5609.102476835251
[]

Validation Results
Global Steps: 27199
Valid Loss: 0.48197
Valid Accuracy: 0.83160
time stamp: 5650.410370349884
[]

Validation Results
Global Steps: 27399
Valid Loss: 0.50904
Valid Accuracy: 0.82700
time stamp: 5691.578820943832
[]

Validation Results
Global Steps: 27599
Valid Loss: 0.48883
Valid Accuracy: 0.83066
time stamp: 5732.861798763275
[]

Validation Results
Global Steps: 27799
Valid Loss: 0.48332
Valid Accuracy: 0.82979
time stamp: 5774.500565767288
[]

Validation Results
Global Steps: 27999
Valid Loss: 0.48285
Valid Accuracy: 0.83241
time stamp: 5815.762362480164
[]
best model saved: step =  28199 dev accu =  tensor(0.8387, device='cuda:0')

Validation Results
Global Steps: 28199
Valid Loss: 0.47569
Valid Accuracy: 0.83867
time stamp: 5857.060765504837
[]

Validation Results
Global Steps: 28399
Valid Loss: 0.47989
Valid Accuracy: 0.83302
time stamp: 5898.678475856781
[]

Validation Results
Global Steps: 28599
Valid Loss: 0.48281
Valid Accuracy: 0.83574
time stamp: 5940.050590276718
[]

Validation Results
Global Steps: 28799
Valid Loss: 0.47359
Valid Accuracy: 0.83523
time stamp: 5981.411519765854
[]

Validation Results
Global Steps: 28999
Valid Loss: 0.48174
Valid Accuracy: 0.83297
time stamp: 6022.910611867905
[]
best model saved: step =  29199 dev accu =  tensor(0.8394, device='cuda:0')

Validation Results
Global Steps: 29199
Valid Loss: 0.46743
Valid Accuracy: 0.83944
time stamp: 6064.3934688568115
[]

Validation Results
Global Steps: 29399
Valid Loss: 0.47378
Valid Accuracy: 0.83601
time stamp: 6105.696260690689
[]

Validation Results
Global Steps: 29599
Valid Loss: 0.49353
Valid Accuracy: 0.83024
time stamp: 6147.347231864929
[]

Validation Results
Global Steps: 29799
Valid Loss: 0.46751
Valid Accuracy: 0.83897
time stamp: 6188.922475576401
[]
best model saved: step =  29999 dev accu =  tensor(0.8404, device='cuda:0')

Validation Results
Global Steps: 29999
Valid Loss: 0.45753
Valid Accuracy: 0.84045
time stamp: 6230.156845092773
total training step (k): 30.0
total training time (s): 6230.157601118088
total training time (ms): 1626311.8623046875
peak memory usage (MB): 12858
allocated memory usage (MB): 401543562
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |   12031 KB |   12858 MB |  392132 GB |  392132 GB |
|       from large pool |    6144 KB |   12846 MB |  388774 GB |  388774 GB |
|       from small pool |    5887 KB |      27 MB |    3357 GB |    3357 GB |
|---------------------------------------------------------------------------|
| Active memory         |   12031 KB |   12858 MB |  392132 GB |  392132 GB |
|       from large pool |    6144 KB |   12846 MB |  388774 GB |  388774 GB |
|       from small pool |    5887 KB |      27 MB |    3357 GB |    3357 GB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   13776 MB |   13776 MB |   13776 MB |       0 B  |
|       from large pool |   13748 MB |   13748 MB |   13748 MB |       0 B  |
|       from small pool |      28 MB |      28 MB |      28 MB |       0 B  |
|---------------------------------------------------------------------------|
| Non-releasable memory |   12545 KB |    2058 MB |  476778 GB |  476778 GB |
|       from large pool |   10240 KB |    2054 MB |  473272 GB |  473272 GB |
|       from small pool |    2305 KB |       6 MB |    3505 GB |    3505 GB |
|---------------------------------------------------------------------------|
| Allocations           |     398    |     670    |   35730 K  |   35730 K  |
|       from large pool |       2    |      93    |   13740 K  |   13740 K  |
|       from small pool |     396    |     659    |   21990 K  |   21990 K  |
|---------------------------------------------------------------------------|
| Active allocs         |     398    |     670    |   35730 K  |   35730 K  |
|       from large pool |       2    |      93    |   13740 K  |   13740 K  |
|       from small pool |     396    |     659    |   21990 K  |   21990 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      42    |      42    |      42    |       0    |
|       from large pool |      28    |      28    |      28    |       0    |
|       from small pool |      14    |      14    |      14    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       9    |      29    |   16668 K  |   16668 K  |
|       from large pool |       1    |      19    |    6228 K  |    6228 K  |
|       from small pool |       8    |      21    |   10440 K  |   10440 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

loading the best model from: ./checkpoints/checkpoints-9/lra-news1/learnable.model
Evaluation Results
Loss: 0.45814
Accuracy: 0.84096
