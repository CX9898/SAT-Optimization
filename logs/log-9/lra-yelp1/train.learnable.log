GPU list: [0, 1, 2, 3]
[
    {
        "learn_pos_emb": true,
        "tied_weights": false,
        "embedding_dim": 64,
        "transformer_dim": 64,
        "transformer_hidden_dim": 128,
        "head_dim": 32,
        "num_head": 2,
        "num_layers": 4,
        "vocab_size": 512,
        "max_seq_len": 1024,
        "dropout_prob": 0.1,
        "attention_dropout": 0.1,
        "pooling_mode": "MEAN",
        "num_classes": 2,
        "block_size": 32,
        "batch_size": 128,
        "density": 0.05,
        "mixed_precision": true,
        "random_seed": 9,
        "task": "lra-yelp1"
    },
    {
        "batch_size": 512,
        "learning_rate": 0.0007,
        "warmup": 80,
        "lr_decay": "linear",
        "weight_decay": 0,
        "eval_frequency": 200,
        "num_train_steps": 30000,
        "num_init_steps": 17000,
        "num_eval_steps": 200,
        "num_dense_train_steps": 1000,
        "patience": 10,
        "attn_loss_scale": 0.01
    }
]
attn_mask compile
attn_mask compile
attn_mask compile
attn_mask compile
DataParallel(
  (module): ModelForSC(
    (model): Model(
      (embeddings): Embeddings(
        (word_embeddings): Embedding(512, 64)
        (position_embeddings): Embedding(1024, 64)
        (dropout): Dropout(p=0.1, inplace=False)
      )
      (transformer_0): TransformerLayer(
        (norm1): LayerNorm((64,), eps=1e-05, elementwise_affine=True)
        (mha): Attention(
          (W_q): Linear(in_features=64, out_features=64, bias=True)
          (W_k): Linear(in_features=64, out_features=64, bias=True)
          (W_v): Linear(in_features=64, out_features=64, bias=True)
          (avg_pool): AvgPool2d(kernel_size=32, stride=32, padding=0)
          (MSEloss): MSELoss()
          (attn): CUDAMaskAttention()
          (ff): Linear(in_features=64, out_features=64, bias=True)
        )
        (dropout1): Dropout(p=0.1, inplace=False)
        (norm2): LayerNorm((64,), eps=1e-05, elementwise_affine=True)
        (mlpblock): Sequential(
          (0): Linear(in_features=64, out_features=128, bias=True)
          (1): GELU(approximate='none')
          (2): Dropout(p=0.1, inplace=False)
          (3): Linear(in_features=128, out_features=64, bias=True)
          (4): Dropout(p=0.1, inplace=False)
        )
      )
      (transformer_1): TransformerLayer(
        (norm1): LayerNorm((64,), eps=1e-05, elementwise_affine=True)
        (mha): Attention(
          (W_q): Linear(in_features=64, out_features=64, bias=True)
          (W_k): Linear(in_features=64, out_features=64, bias=True)
          (W_v): Linear(in_features=64, out_features=64, bias=True)
          (avg_pool): AvgPool2d(kernel_size=32, stride=32, padding=0)
          (MSEloss): MSELoss()
          (attn): CUDAMaskAttention()
          (ff): Linear(in_features=64, out_features=64, bias=True)
        )
        (dropout1): Dropout(p=0.1, inplace=False)
        (norm2): LayerNorm((64,), eps=1e-05, elementwise_affine=True)
        (mlpblock): Sequential(
          (0): Linear(in_features=64, out_features=128, bias=True)
          (1): GELU(approximate='none')
          (2): Dropout(p=0.1, inplace=False)
          (3): Linear(in_features=128, out_features=64, bias=True)
          (4): Dropout(p=0.1, inplace=False)
        )
      )
      (transformer_2): TransformerLayer(
        (norm1): LayerNorm((64,), eps=1e-05, elementwise_affine=True)
        (mha): Attention(
          (W_q): Linear(in_features=64, out_features=64, bias=True)
          (W_k): Linear(in_features=64, out_features=64, bias=True)
          (W_v): Linear(in_features=64, out_features=64, bias=True)
          (avg_pool): AvgPool2d(kernel_size=32, stride=32, padding=0)
          (MSEloss): MSELoss()
          (attn): CUDAMaskAttention()
          (ff): Linear(in_features=64, out_features=64, bias=True)
        )
        (dropout1): Dropout(p=0.1, inplace=False)
        (norm2): LayerNorm((64,), eps=1e-05, elementwise_affine=True)
        (mlpblock): Sequential(
          (0): Linear(in_features=64, out_features=128, bias=True)
          (1): GELU(approximate='none')
          (2): Dropout(p=0.1, inplace=False)
          (3): Linear(in_features=128, out_features=64, bias=True)
          (4): Dropout(p=0.1, inplace=False)
        )
      )
      (transformer_3): TransformerLayer(
        (norm1): LayerNorm((64,), eps=1e-05, elementwise_affine=True)
        (mha): Attention(
          (W_q): Linear(in_features=64, out_features=64, bias=True)
          (W_k): Linear(in_features=64, out_features=64, bias=True)
          (W_v): Linear(in_features=64, out_features=64, bias=True)
          (avg_pool): AvgPool2d(kernel_size=32, stride=32, padding=0)
          (MSEloss): MSELoss()
          (attn): CUDAMaskAttention()
          (ff): Linear(in_features=64, out_features=64, bias=True)
        )
        (dropout1): Dropout(p=0.1, inplace=False)
        (norm2): LayerNorm((64,), eps=1e-05, elementwise_affine=True)
        (mlpblock): Sequential(
          (0): Linear(in_features=64, out_features=128, bias=True)
          (1): GELU(approximate='none')
          (2): Dropout(p=0.1, inplace=False)
          (3): Linear(in_features=128, out_features=64, bias=True)
          (4): Dropout(p=0.1, inplace=False)
        )
      )
      (norm): LayerNorm((64,), eps=1e-05, elementwise_affine=True)
    )
    (seq_classifer): SCHead(
      (mlpblock): Sequential(
        (0): Linear(in_features=64, out_features=128, bias=True)
        (1): ReLU()
        (2): Linear(in_features=128, out_features=2, bias=True)
      )
    )
  )
)
parameter_size: [torch.Size([512, 64]), torch.Size([1024, 64]), torch.Size([64]), torch.Size([64]), torch.Size([32, 32]), torch.Size([64, 64]), torch.Size([64]), torch.Size([64, 64]), torch.Size([64]), torch.Size([64, 64]), torch.Size([64]), torch.Size([64, 64]), torch.Size([64]), torch.Size([64]), torch.Size([64]), torch.Size([128, 64]), torch.Size([128]), torch.Size([64, 128]), torch.Size([64]), torch.Size([64]), torch.Size([64]), torch.Size([32, 32]), torch.Size([64, 64]), torch.Size([64]), torch.Size([64, 64]), torch.Size([64]), torch.Size([64, 64]), torch.Size([64]), torch.Size([64, 64]), torch.Size([64]), torch.Size([64]), torch.Size([64]), torch.Size([128, 64]), torch.Size([128]), torch.Size([64, 128]), torch.Size([64]), torch.Size([64]), torch.Size([64]), torch.Size([32, 32]), torch.Size([64, 64]), torch.Size([64]), torch.Size([64, 64]), torch.Size([64]), torch.Size([64, 64]), torch.Size([64]), torch.Size([64, 64]), torch.Size([64]), torch.Size([64]), torch.Size([64]), torch.Size([128, 64]), torch.Size([128]), torch.Size([64, 128]), torch.Size([64]), torch.Size([64]), torch.Size([64]), torch.Size([32, 32]), torch.Size([64, 64]), torch.Size([64]), torch.Size([64, 64]), torch.Size([64]), torch.Size([64, 64]), torch.Size([64]), torch.Size([64, 64]), torch.Size([64]), torch.Size([64]), torch.Size([64]), torch.Size([128, 64]), torch.Size([128]), torch.Size([64, 128]), torch.Size([64]), torch.Size([64]), torch.Size([64]), torch.Size([128, 64]), torch.Size([128]), torch.Size([2, 128]), torch.Size([2])]
num_parameter: 244994
Loaded ../Skyformer/data/lra_processed/lra-yelp1.train.pickle... size=560000
Loaded ../Skyformer/data/lra_processed/lra-yelp1.dev.pickle... size=38000
Loaded ../Skyformer/data/lra_processed/lra-yelp1.test.pickle... size=38000
accumu_steps=1
[tensor([31.3431, 31.3431, 31.3431, 31.3431], device='cuda:0',
       grad_fn=<GatherBackward>), tensor([30.4403, 30.4403, 30.4403, 30.4403], device='cuda:0',
       grad_fn=<GatherBackward>), tensor([27.3218, 27.3218, 27.3218, 27.3218], device='cuda:0',
       grad_fn=<GatherBackward>), tensor([34.3368, 34.3368, 34.3368, 34.3368], device='cuda:0',
       grad_fn=<GatherBackward>)]
best model saved: step =  199 dev accu =  tensor(0.7135, device='cuda:0')

Validation Results
Global Steps: 199
Valid Loss: 0.56296
Valid Accuracy: 0.71354
time stamp: 163.75095677375793
[tensor([13.7028, 13.7028, 13.7028, 13.7028], device='cuda:0',
       grad_fn=<GatherBackward>), tensor([13.2490, 13.2490, 13.2490, 13.2490], device='cuda:0',
       grad_fn=<GatherBackward>), tensor([11.7301, 11.7301, 11.7301, 11.7301], device='cuda:0',
       grad_fn=<GatherBackward>), tensor([15.1624, 15.1625, 15.1624, 15.1624], device='cuda:0',
       grad_fn=<GatherBackward>)]

Validation Results
Global Steps: 399
Valid Loss: 0.58708
Valid Accuracy: 0.69903
time stamp: 325.4349856376648
[tensor([6.9152, 6.9153, 6.9153, 6.9152], device='cuda:0',
       grad_fn=<GatherBackward>), tensor([6.6732, 6.6732, 6.6732, 6.6732], device='cuda:0',
       grad_fn=<GatherBackward>), tensor([5.8708, 5.8709, 5.8709, 5.8708], device='cuda:0',
       grad_fn=<GatherBackward>), tensor([7.6936, 7.6936, 7.6936, 7.6936], device='cuda:0',
       grad_fn=<GatherBackward>)]

Validation Results
Global Steps: 599
Valid Loss: 0.56672
Valid Accuracy: 0.70093
time stamp: 487.6163489818573
[tensor([3.9099, 3.9099, 3.9099, 3.9099], device='cuda:0',
       grad_fn=<GatherBackward>), tensor([3.7738, 3.7738, 3.7738, 3.7738], device='cuda:0',
       grad_fn=<GatherBackward>), tensor([3.3185, 3.3185, 3.3185, 3.3185], device='cuda:0',
       grad_fn=<GatherBackward>), tensor([4.3612, 4.3612, 4.3612, 4.3612], device='cuda:0',
       grad_fn=<GatherBackward>)]
best model saved: step =  799 dev accu =  tensor(0.7342, device='cuda:0')

Validation Results
Global Steps: 799
Valid Loss: 0.52581
Valid Accuracy: 0.73423
time stamp: 650.775276184082
[tensor([2.4210, 2.4210, 2.4210, 2.4210], device='cuda:0',
       grad_fn=<GatherBackward>), tensor([2.3410, 2.3409, 2.3409, 2.3409], device='cuda:0',
       grad_fn=<GatherBackward>), tensor([2.0668, 2.0668, 2.0667, 2.0668], device='cuda:0',
       grad_fn=<GatherBackward>), tensor([2.7024, 2.7024, 2.7024, 2.7024], device='cuda:0',
       grad_fn=<GatherBackward>)]
best model saved: step =  999 dev accu =  tensor(0.7369, device='cuda:0')

Validation Results
Global Steps: 999
Valid Loss: 0.52098
Valid Accuracy: 0.73690
time stamp: 813.5290985107422
[tensor([1.6130, 1.6130, 1.6130, 1.6130], device='cuda:0',
       grad_fn=<GatherBackward>), tensor([1.5639, 1.5639, 1.5640, 1.5639], device='cuda:0',
       grad_fn=<GatherBackward>), tensor([1.3905, 1.3905, 1.3905, 1.3905], device='cuda:0',
       grad_fn=<GatherBackward>), tensor([1.7996, 1.7996, 1.7996, 1.7996], device='cuda:0',
       grad_fn=<GatherBackward>)]

Validation Results
Global Steps: 1199
Valid Loss: 0.52665
Valid Accuracy: 0.73381
time stamp: 977.7936451435089
[tensor([1.1401, 1.1401, 1.1401, 1.1401], device='cuda:0',
       grad_fn=<GatherBackward>), tensor([1.1088, 1.1087, 1.1087, 1.1087], device='cuda:0',
       grad_fn=<GatherBackward>), tensor([0.9944, 0.9944, 0.9944, 0.9944], device='cuda:0',
       grad_fn=<GatherBackward>), tensor([1.2704, 1.2704, 1.2704, 1.2704], device='cuda:0',
       grad_fn=<GatherBackward>)]
best model saved: step =  1399 dev accu =  tensor(0.7399, device='cuda:0')

Validation Results
Global Steps: 1399
Valid Loss: 0.52437
Valid Accuracy: 0.73987
time stamp: 1141.6170949935913
[tensor([0.8449, 0.8449, 0.8449, 0.8449], device='cuda:0',
       grad_fn=<GatherBackward>), tensor([0.8240, 0.8240, 0.8240, 0.8240], device='cuda:0',
       grad_fn=<GatherBackward>), tensor([0.7458, 0.7458, 0.7458, 0.7458], device='cuda:0',
       grad_fn=<GatherBackward>), tensor([0.9400, 0.9400, 0.9400, 0.9400], device='cuda:0',
       grad_fn=<GatherBackward>)]

Validation Results
Global Steps: 1599
Valid Loss: 0.53720
Valid Accuracy: 0.72661
time stamp: 1305.829419851303
[tensor([0.6501, 0.6501, 0.6501, 0.6501], device='cuda:0',
       grad_fn=<GatherBackward>), tensor([0.6355, 0.6355, 0.6355, 0.6355], device='cuda:0',
       grad_fn=<GatherBackward>), tensor([0.5802, 0.5802, 0.5802, 0.5802], device='cuda:0',
       grad_fn=<GatherBackward>), tensor([0.7221, 0.7220, 0.7220, 0.7221], device='cuda:0',
       grad_fn=<GatherBackward>)]
best model saved: step =  1799 dev accu =  tensor(0.7403, device='cuda:0')

Validation Results
Global Steps: 1799
Valid Loss: 0.52246
Valid Accuracy: 0.74031
time stamp: 1471.1635417938232
[tensor([0.5151, 0.5151, 0.5151, 0.5151], device='cuda:0',
       grad_fn=<GatherBackward>), tensor([0.5044, 0.5044, 0.5044, 0.5044], device='cuda:0',
       grad_fn=<GatherBackward>), tensor([0.4640, 0.4640, 0.4640, 0.4640], device='cuda:0',
       grad_fn=<GatherBackward>), tensor([0.5712, 0.5712, 0.5712, 0.5712], device='cuda:0',
       grad_fn=<GatherBackward>)]
best model saved: step =  1999 dev accu =  tensor(0.7435, device='cuda:0')

Validation Results
Global Steps: 1999
Valid Loss: 0.51498
Valid Accuracy: 0.74354
time stamp: 1635.395323753357
[tensor([0.4175, 0.4175, 0.4175, 0.4175], device='cuda:0',
       grad_fn=<GatherBackward>), tensor([0.4094, 0.4094, 0.4094, 0.4094], device='cuda:0',
       grad_fn=<GatherBackward>), tensor([0.3789, 0.3789, 0.3789, 0.3789], device='cuda:0',
       grad_fn=<GatherBackward>), tensor([0.4624, 0.4624, 0.4624, 0.4624], device='cuda:0',
       grad_fn=<GatherBackward>)]

Validation Results
Global Steps: 2199
Valid Loss: 0.51679
Valid Accuracy: 0.74249
time stamp: 1799.7135055065155
[tensor([0.3444, 0.3444, 0.3444, 0.3444], device='cuda:0',
       grad_fn=<GatherBackward>), tensor([0.3379, 0.3379, 0.3379, 0.3379], device='cuda:0',
       grad_fn=<GatherBackward>), tensor([0.3142, 0.3142, 0.3142, 0.3142], device='cuda:0',
       grad_fn=<GatherBackward>), tensor([0.3809, 0.3809, 0.3809, 0.3809], device='cuda:0',
       grad_fn=<GatherBackward>)]
best model saved: step =  2399 dev accu =  tensor(0.7440, device='cuda:0')

Validation Results
Global Steps: 2399
Valid Loss: 0.51271
Valid Accuracy: 0.74399
time stamp: 1964.4904062747955
[tensor([0.2878, 0.2878, 0.2878, 0.2878], device='cuda:0',
       grad_fn=<GatherBackward>), tensor([0.2825, 0.2825, 0.2825, 0.2825], device='cuda:0',
       grad_fn=<GatherBackward>), tensor([0.2636, 0.2636, 0.2636, 0.2636], device='cuda:0',
       grad_fn=<GatherBackward>), tensor([0.3181, 0.3181, 0.3181, 0.3181], device='cuda:0',
       grad_fn=<GatherBackward>)]

Validation Results
Global Steps: 2599
Valid Loss: 0.51760
Valid Accuracy: 0.74359
time stamp: 2129.086036682129
[tensor([0.2429, 0.2429, 0.2429, 0.2429], device='cuda:0',
       grad_fn=<GatherBackward>), tensor([0.2385, 0.2385, 0.2385, 0.2385], device='cuda:0',
       grad_fn=<GatherBackward>), tensor([0.2229, 0.2229, 0.2229, 0.2229], device='cuda:0',
       grad_fn=<GatherBackward>), tensor([0.2683, 0.2683, 0.2683, 0.2683], device='cuda:0',
       grad_fn=<GatherBackward>)]
best model saved: step =  2799 dev accu =  tensor(0.7451, device='cuda:0')

Validation Results
Global Steps: 2799
Valid Loss: 0.51002
Valid Accuracy: 0.74513
time stamp: 2293.728474378586
[tensor([0.2065, 0.2065, 0.2065, 0.2065], device='cuda:0',
       grad_fn=<GatherBackward>), tensor([0.2028, 0.2028, 0.2028, 0.2028], device='cuda:0',
       grad_fn=<GatherBackward>), tensor([0.1897, 0.1897, 0.1897, 0.1897], device='cuda:0',
       grad_fn=<GatherBackward>), tensor([0.2280, 0.2280, 0.2280, 0.2281], device='cuda:0',
       grad_fn=<GatherBackward>)]
best model saved: step =  2999 dev accu =  tensor(0.7456, device='cuda:0')

Validation Results
Global Steps: 2999
Valid Loss: 0.51722
Valid Accuracy: 0.74561
time stamp: 2458.2824745178223
[tensor([0.1765, 0.1765, 0.1765, 0.1765], device='cuda:0',
       grad_fn=<GatherBackward>), tensor([0.1734, 0.1734, 0.1733, 0.1734], device='cuda:0',
       grad_fn=<GatherBackward>), tensor([0.1621, 0.1621, 0.1621, 0.1621], device='cuda:0',
       grad_fn=<GatherBackward>), tensor([0.1949, 0.1949, 0.1949, 0.1949], device='cuda:0',
       grad_fn=<GatherBackward>)]

Validation Results
Global Steps: 3199
Valid Loss: 0.52563
Valid Accuracy: 0.73715
time stamp: 2622.686475753784
[tensor([0.1514, 0.1514, 0.1514, 0.1514], device='cuda:0',
       grad_fn=<GatherBackward>), tensor([0.1488, 0.1488, 0.1488, 0.1488], device='cuda:0',
       grad_fn=<GatherBackward>), tensor([0.1390, 0.1390, 0.1390, 0.1390], device='cuda:0',
       grad_fn=<GatherBackward>), tensor([0.1673, 0.1673, 0.1673, 0.1673], device='cuda:0',
       grad_fn=<GatherBackward>)]

Validation Results
Global Steps: 3399
Valid Loss: 0.51685
Valid Accuracy: 0.74424
time stamp: 2788.27126288414
module.model.transformer_0.mha.pattern saved
module.model.transformer_1.mha.pattern saved
module.model.transformer_2.mha.pattern saved
module.model.transformer_3.mha.pattern saved
./pickle/lra-yelp1/module.model.transformer_0.mha.pattern.pickle
tensor([ 231,   66,   99,  594,    0,  495,  396,  825,  792,  957,  693,  297,
         528,  198,  759,  990,  561,  726,  891,  330,  132,  429,  462,  924,
         363,   33,  858,  627,  165, 1023,  264,  660,  201,  294,  859,  890,
         233,  295,  235,  359,  278,  712,  125,  931,   12,  384,  506,  847,
         542,  976,  438], device='cuda:0')
tensor(51, device='cuda:0')
block_attn_mask compile
./pickle/lra-yelp1/module.model.transformer_1.mha.pattern.pickle
tensor([ 990,  264,  924,  363,  660,  858,  759,  957,   99,  330,  528,  594,
         198,  891, 1023,  495,  297,  165,  462,  726,  396,  231,  429,  627,
         693,  132,  792,   33,   66,  825,  561,    0,  140,  388,  638,  979,
         222,  966,  372,  651,  506,  847,  798,  984,  539,  880,  510,  975,
         479, 1006,  727], device='cuda:0')
tensor(51, device='cuda:0')
block_attn_mask compile
./pickle/lra-yelp1/module.model.transformer_2.mha.pattern.pickle
tensor([ 297,   99,  132,  429,   66,   33,  792,  165,  693,  396,  726,  264,
         231,  363,  594,  924,  561,  825, 1023,  957,  627,  330,  528,  990,
         891,    0,  198,  858,  462,  495,  660,  759,    7,  224,  433,  557,
         349,  938,   73,  290,  237,  423,  118,  707,  365,  427,  407,  748,
          44,  385,  894], device='cuda:0')
tensor(51, device='cuda:0')
block_attn_mask compile
./pickle/lra-yelp1/module.model.transformer_3.mha.pattern.pickle
tensor([ 462,   99,  132,  726,  627,  660, 1023,  891,  231,  792,  924,  495,
         990,  297,  594,   33,  957,   66,  825,  561,  429,  363,  396,  330,
         858,  693,    0,  759,  165,  528,  264,  198,  632,  787,   34,   65,
          72,  258,   73,  290,   21,  672,  668,  916,  476,  910,  302,  457,
         505,  815,   74], device='cuda:0')
tensor(51, device='cuda:0')
block_attn_mask compile
total pattern searching time (s): 0.09354639053344727
[]

Validation Results
Global Steps: 3599
Valid Loss: 0.52643
Valid Accuracy: 0.73475
time stamp: 2823.3702478408813
[]
best model saved: step =  3799 dev accu =  tensor(0.7457, device='cuda:0')

Validation Results
Global Steps: 3799
Valid Loss: 0.51442
Valid Accuracy: 0.74570
time stamp: 2858.381417989731
[]

Validation Results
Global Steps: 3999
Valid Loss: 0.51069
Valid Accuracy: 0.74416
time stamp: 2892.9276218414307
[]

Validation Results
Global Steps: 4199
Valid Loss: 0.51041
Valid Accuracy: 0.74485
time stamp: 2927.444086790085
[]
best model saved: step =  4399 dev accu =  tensor(0.7524, device='cuda:0')

Validation Results
Global Steps: 4399
Valid Loss: 0.49983
Valid Accuracy: 0.75241
time stamp: 2962.6357469558716
[]

Validation Results
Global Steps: 4599
Valid Loss: 0.50938
Valid Accuracy: 0.74733
time stamp: 2997.271582365036
[]
best model saved: step =  4799 dev accu =  tensor(0.7530, device='cuda:0')

Validation Results
Global Steps: 4799
Valid Loss: 0.50064
Valid Accuracy: 0.75305
time stamp: 3032.0552957057953
[]

Validation Results
Global Steps: 4999
Valid Loss: 0.49861
Valid Accuracy: 0.75166
time stamp: 3066.5998964309692
[]
best model saved: step =  5199 dev accu =  tensor(0.7596, device='cuda:0')

Validation Results
Global Steps: 5199
Valid Loss: 0.48785
Valid Accuracy: 0.75955
time stamp: 3101.5383036136627
[]

Validation Results
Global Steps: 5399
Valid Loss: 0.49351
Valid Accuracy: 0.75506
time stamp: 3136.515421628952
[]

Validation Results
Global Steps: 5599
Valid Loss: 0.50435
Valid Accuracy: 0.74877
time stamp: 3171.6310374736786
[]
best model saved: step =  5799 dev accu =  tensor(0.7615, device='cuda:0')

Validation Results
Global Steps: 5799
Valid Loss: 0.48615
Valid Accuracy: 0.76152
time stamp: 3206.451018810272
[]
best model saved: step =  5999 dev accu =  tensor(0.7630, device='cuda:0')

Validation Results
Global Steps: 5999
Valid Loss: 0.48477
Valid Accuracy: 0.76298
time stamp: 3241.3047304153442
[]

Validation Results
Global Steps: 6199
Valid Loss: 0.49037
Valid Accuracy: 0.75861
time stamp: 3276.2334048748016
[]

Validation Results
Global Steps: 6399
Valid Loss: 0.48523
Valid Accuracy: 0.76033
time stamp: 3311.0054762363434
[]

Validation Results
Global Steps: 6599
Valid Loss: 0.48969
Valid Accuracy: 0.76179
time stamp: 3345.757215976715
[]
best model saved: step =  6799 dev accu =  tensor(0.7672, device='cuda:0')

Validation Results
Global Steps: 6799
Valid Loss: 0.47586
Valid Accuracy: 0.76721
time stamp: 3380.652500629425
[]

Validation Results
Global Steps: 6999
Valid Loss: 0.47865
Valid Accuracy: 0.76714
time stamp: 3415.1021201610565
[]
best model saved: step =  7199 dev accu =  tensor(0.7675, device='cuda:0')

Validation Results
Global Steps: 7199
Valid Loss: 0.47550
Valid Accuracy: 0.76750
time stamp: 3449.9111456871033
[]

Validation Results
Global Steps: 7399
Valid Loss: 0.48834
Valid Accuracy: 0.75748
time stamp: 3484.875851392746
[]

Validation Results
Global Steps: 7599
Valid Loss: 0.47381
Valid Accuracy: 0.76668
time stamp: 3519.644160270691
[]

Validation Results
Global Steps: 7799
Valid Loss: 0.48536
Valid Accuracy: 0.76139
time stamp: 3554.9077820777893
[]
best model saved: step =  7999 dev accu =  tensor(0.7688, device='cuda:0')

Validation Results
Global Steps: 7999
Valid Loss: 0.47383
Valid Accuracy: 0.76877
time stamp: 3589.634403705597
[]

Validation Results
Global Steps: 8199
Valid Loss: 0.47957
Valid Accuracy: 0.76613
time stamp: 3624.41317486763
[]
best model saved: step =  8399 dev accu =  tensor(0.7719, device='cuda:0')

Validation Results
Global Steps: 8399
Valid Loss: 0.47053
Valid Accuracy: 0.77187
time stamp: 3658.8439741134644
[]

Validation Results
Global Steps: 8599
Valid Loss: 0.48874
Valid Accuracy: 0.75800
time stamp: 3693.9071729183197
[]

Validation Results
Global Steps: 8799
Valid Loss: 0.47050
Valid Accuracy: 0.77041
time stamp: 3728.717073202133
[]

Validation Results
Global Steps: 8999
Valid Loss: 0.48131
Valid Accuracy: 0.76546
time stamp: 3763.5324075222015
[]

Validation Results
Global Steps: 9199
Valid Loss: 0.49462
Valid Accuracy: 0.75297
time stamp: 3798.312953710556
[]
best model saved: step =  9399 dev accu =  tensor(0.7743, device='cuda:0')

Validation Results
Global Steps: 9399
Valid Loss: 0.46464
Valid Accuracy: 0.77429
time stamp: 3833.5409440994263
[]

Validation Results
Global Steps: 9599
Valid Loss: 0.46649
Valid Accuracy: 0.77225
time stamp: 3868.8418819904327
[]
best model saved: step =  9799 dev accu =  tensor(0.7754, device='cuda:0')

Validation Results
Global Steps: 9799
Valid Loss: 0.46294
Valid Accuracy: 0.77535
time stamp: 3903.6935563087463
[]

Validation Results
Global Steps: 9999
Valid Loss: 0.47134
Valid Accuracy: 0.76991
time stamp: 3938.76894903183
[]

Validation Results
Global Steps: 10199
Valid Loss: 0.48649
Valid Accuracy: 0.76140
time stamp: 3973.5056829452515
[]

Validation Results
Global Steps: 10399
Valid Loss: 0.47452
Valid Accuracy: 0.76855
time stamp: 4008.5268137454987
[]
best model saved: step =  10599 dev accu =  tensor(0.7770, device='cuda:0')

Validation Results
Global Steps: 10599
Valid Loss: 0.46216
Valid Accuracy: 0.77700
time stamp: 4042.9899163246155
[]

Validation Results
Global Steps: 10799
Valid Loss: 0.46501
Valid Accuracy: 0.77488
time stamp: 4077.5729327201843
[]

Validation Results
Global Steps: 10999
Valid Loss: 0.46486
Valid Accuracy: 0.77679
time stamp: 4112.741639137268
[]
best model saved: step =  11199 dev accu =  tensor(0.7775, device='cuda:0')

Validation Results
Global Steps: 11199
Valid Loss: 0.45953
Valid Accuracy: 0.77754
time stamp: 4147.568564176559
[]

Validation Results
Global Steps: 11399
Valid Loss: 0.46598
Valid Accuracy: 0.77599
time stamp: 4182.446894407272
[]
best model saved: step =  11599 dev accu =  tensor(0.7781, device='cuda:0')

Validation Results
Global Steps: 11599
Valid Loss: 0.45974
Valid Accuracy: 0.77806
time stamp: 4217.403599739075
[]

Validation Results
Global Steps: 11799
Valid Loss: 0.46073
Valid Accuracy: 0.77658
time stamp: 4252.525748491287
[]
best model saved: step =  11999 dev accu =  tensor(0.7790, device='cuda:0')

Validation Results
Global Steps: 11999
Valid Loss: 0.45840
Valid Accuracy: 0.77896
time stamp: 4287.274950265884
[]
best model saved: step =  12199 dev accu =  tensor(0.7799, device='cuda:0')

Validation Results
Global Steps: 12199
Valid Loss: 0.45987
Valid Accuracy: 0.77990
time stamp: 4322.128836631775
[]
best model saved: step =  12399 dev accu =  tensor(0.7851, device='cuda:0')

Validation Results
Global Steps: 12399
Valid Loss: 0.45313
Valid Accuracy: 0.78508
time stamp: 4356.741300582886
[]

Validation Results
Global Steps: 12599
Valid Loss: 0.45406
Valid Accuracy: 0.78054
time stamp: 4391.728319168091
[]

Validation Results
Global Steps: 12799
Valid Loss: 0.45485
Valid Accuracy: 0.78002
time stamp: 4426.555898427963
[]

Validation Results
Global Steps: 12999
Valid Loss: 0.45368
Valid Accuracy: 0.78143
time stamp: 4461.507385253906
[]

Validation Results
Global Steps: 13199
Valid Loss: 0.45350
Valid Accuracy: 0.78059
time stamp: 4496.785211086273
[]

Validation Results
Global Steps: 13399
Valid Loss: 0.48205
Valid Accuracy: 0.76591
time stamp: 4531.844354629517
[]

Validation Results
Global Steps: 13599
Valid Loss: 0.45505
Valid Accuracy: 0.78166
time stamp: 4566.934085607529
[]

Validation Results
Global Steps: 13799
Valid Loss: 0.45218
Valid Accuracy: 0.78187
time stamp: 4601.747774600983
[]

Validation Results
Global Steps: 13999
Valid Loss: 0.45199
Valid Accuracy: 0.78147
time stamp: 4636.4199323654175
[]

Validation Results
Global Steps: 14199
Valid Loss: 0.46831
Valid Accuracy: 0.77111
time stamp: 4671.286064863205
[]

Validation Results
Global Steps: 14399
Valid Loss: 0.45159
Valid Accuracy: 0.78326
time stamp: 4706.730843782425
[]

Validation Results
Global Steps: 14599
Valid Loss: 0.45740
Valid Accuracy: 0.77889
time stamp: 4741.590757846832
[]

Validation Results
Global Steps: 14799
Valid Loss: 0.45534
Valid Accuracy: 0.78194
time stamp: 4776.591336488724
[]

Validation Results
Global Steps: 14999
Valid Loss: 0.44801
Valid Accuracy: 0.78323
time stamp: 4811.75318646431
[]

Validation Results
Global Steps: 15199
Valid Loss: 0.45137
Valid Accuracy: 0.78405
time stamp: 4846.75793504715
[]

Validation Results
Global Steps: 15399
Valid Loss: 0.45334
Valid Accuracy: 0.78321
time stamp: 4881.64399433136
[]

Validation Results
Global Steps: 15599
Valid Loss: 0.44920
Valid Accuracy: 0.78360
time stamp: 4916.761344194412
[]

Validation Results
Global Steps: 15799
Valid Loss: 0.45888
Valid Accuracy: 0.77969
time stamp: 4951.507674455643
[]

Validation Results
Global Steps: 15999
Valid Loss: 0.44513
Valid Accuracy: 0.78497
time stamp: 4986.341378211975
[]

Validation Results
Global Steps: 16199
Valid Loss: 0.44659
Valid Accuracy: 0.78475
time stamp: 5021.129540920258
[]
best model saved: step =  16399 dev accu =  tensor(0.7868, device='cuda:0')

Validation Results
Global Steps: 16399
Valid Loss: 0.44429
Valid Accuracy: 0.78680
time stamp: 5056.123993873596
[]

Validation Results
Global Steps: 16599
Valid Loss: 0.44767
Valid Accuracy: 0.78374
time stamp: 5090.7570786476135
[]

Validation Results
Global Steps: 16799
Valid Loss: 0.44989
Valid Accuracy: 0.78605
time stamp: 5125.575429439545
[]
best model saved: step =  16999 dev accu =  tensor(0.7872, device='cuda:0')

Validation Results
Global Steps: 16999
Valid Loss: 0.44428
Valid Accuracy: 0.78725
time stamp: 5160.254639148712
[]
best model saved: step =  17199 dev accu =  tensor(0.7901, device='cuda:0')

Validation Results
Global Steps: 17199
Valid Loss: 0.44054
Valid Accuracy: 0.79006
time stamp: 5195.140034675598
[]

Validation Results
Global Steps: 17399
Valid Loss: 0.44525
Valid Accuracy: 0.78418
time stamp: 5229.986455917358
[]

Validation Results
Global Steps: 17599
Valid Loss: 0.44488
Valid Accuracy: 0.78584
time stamp: 5265.812625646591
[]

Validation Results
Global Steps: 17799
Valid Loss: 0.44285
Valid Accuracy: 0.78813
time stamp: 5300.635773181915
[]
best model saved: step =  17999 dev accu =  tensor(0.7908, device='cuda:0')

Validation Results
Global Steps: 17999
Valid Loss: 0.43788
Valid Accuracy: 0.79076
time stamp: 5335.747252941132
[]

Validation Results
Global Steps: 18199
Valid Loss: 0.44271
Valid Accuracy: 0.78916
time stamp: 5370.223971128464
[]
best model saved: step =  18399 dev accu =  tensor(0.7923, device='cuda:0')

Validation Results
Global Steps: 18399
Valid Loss: 0.43766
Valid Accuracy: 0.79233
time stamp: 5404.619171619415
[]

Validation Results
Global Steps: 18599
Valid Loss: 0.44280
Valid Accuracy: 0.79187
time stamp: 5439.66833114624
[]

Validation Results
Global Steps: 18799
Valid Loss: 0.44178
Valid Accuracy: 0.78951
time stamp: 5474.3713800907135
[]

Validation Results
Global Steps: 18999
Valid Loss: 0.43992
Valid Accuracy: 0.79158
time stamp: 5509.235410451889
[]
best model saved: step =  19199 dev accu =  tensor(0.7979, device='cuda:0')

Validation Results
Global Steps: 19199
Valid Loss: 0.43283
Valid Accuracy: 0.79786
time stamp: 5544.244350910187
[]

Validation Results
Global Steps: 19399
Valid Loss: 0.44422
Valid Accuracy: 0.78771
time stamp: 5579.147542715073
[]

Validation Results
Global Steps: 19599
Valid Loss: 0.43546
Valid Accuracy: 0.79442
time stamp: 5613.968414783478
[]

Validation Results
Global Steps: 19799
Valid Loss: 0.43379
Valid Accuracy: 0.79509
time stamp: 5649.035332202911
[]

Validation Results
Global Steps: 19999
Valid Loss: 0.43639
Valid Accuracy: 0.79372
time stamp: 5683.791995763779
[]

Validation Results
Global Steps: 20199
Valid Loss: 0.43776
Valid Accuracy: 0.79511
time stamp: 5718.347318887711
[]
best model saved: step =  20399 dev accu =  tensor(0.7982, device='cuda:0')

Validation Results
Global Steps: 20399
Valid Loss: 0.42782
Valid Accuracy: 0.79821
time stamp: 5752.939496040344
[]

Validation Results
Global Steps: 20599
Valid Loss: 0.43750
Valid Accuracy: 0.79475
time stamp: 5788.510425329208
[]

Validation Results
Global Steps: 20799
Valid Loss: 0.43032
Valid Accuracy: 0.79473
time stamp: 5823.157447099686
[]

Validation Results
Global Steps: 20999
Valid Loss: 0.44232
Valid Accuracy: 0.79134
time stamp: 5858.095351457596
[]
best model saved: step =  21199 dev accu =  tensor(0.8007, device='cuda:0')

Validation Results
Global Steps: 21199
Valid Loss: 0.42657
Valid Accuracy: 0.80070
time stamp: 5893.113569736481
[]
best model saved: step =  21399 dev accu =  tensor(0.8016, device='cuda:0')

Validation Results
Global Steps: 21399
Valid Loss: 0.41971
Valid Accuracy: 0.80159
time stamp: 5927.8944876194
[]

Validation Results
Global Steps: 21599
Valid Loss: 0.41966
Valid Accuracy: 0.80049
time stamp: 5963.008054256439
[]

Validation Results
Global Steps: 21799
Valid Loss: 0.42176
Valid Accuracy: 0.80153
time stamp: 5997.959984064102
[]
best model saved: step =  21999 dev accu =  tensor(0.8042, device='cuda:0')

Validation Results
Global Steps: 21999
Valid Loss: 0.41953
Valid Accuracy: 0.80415
time stamp: 6033.267254829407
[]
best model saved: step =  22199 dev accu =  tensor(0.8053, device='cuda:0')

Validation Results
Global Steps: 22199
Valid Loss: 0.41576
Valid Accuracy: 0.80525
time stamp: 6067.99250793457
[]

Validation Results
Global Steps: 22399
Valid Loss: 0.41949
Valid Accuracy: 0.80243
time stamp: 6103.2447736263275
[]

Validation Results
Global Steps: 22599
Valid Loss: 0.42106
Valid Accuracy: 0.80290
time stamp: 6138.15088224411
[]
best model saved: step =  22799 dev accu =  tensor(0.8078, device='cuda:0')

Validation Results
Global Steps: 22799
Valid Loss: 0.41286
Valid Accuracy: 0.80781
time stamp: 6172.602774620056
[]

Validation Results
Global Steps: 22999
Valid Loss: 0.42149
Valid Accuracy: 0.80236
time stamp: 6207.999836444855
[]

Validation Results
Global Steps: 23199
Valid Loss: 0.42167
Valid Accuracy: 0.80438
time stamp: 6242.721055984497
[]

Validation Results
Global Steps: 23399
Valid Loss: 0.41230
Valid Accuracy: 0.80578
time stamp: 6277.759461641312
[]

Validation Results
Global Steps: 23599
Valid Loss: 0.41794
Valid Accuracy: 0.80339
time stamp: 6312.601982831955
[]
best model saved: step =  23799 dev accu =  tensor(0.8087, device='cuda:0')

Validation Results
Global Steps: 23799
Valid Loss: 0.41212
Valid Accuracy: 0.80870
time stamp: 6347.094543933868
[]

Validation Results
Global Steps: 23999
Valid Loss: 0.41413
Valid Accuracy: 0.80738
time stamp: 6381.977966070175
[]
best model saved: step =  24199 dev accu =  tensor(0.8091, device='cuda:0')

Validation Results
Global Steps: 24199
Valid Loss: 0.41431
Valid Accuracy: 0.80912
time stamp: 6417.170623779297
[]
best model saved: step =  24399 dev accu =  tensor(0.8115, device='cuda:0')

Validation Results
Global Steps: 24399
Valid Loss: 0.40912
Valid Accuracy: 0.81154
time stamp: 6452.406457901001
[]
best model saved: step =  24599 dev accu =  tensor(0.8154, device='cuda:0')

Validation Results
Global Steps: 24599
Valid Loss: 0.40388
Valid Accuracy: 0.81539
time stamp: 6487.1783764362335
[]

Validation Results
Global Steps: 24799
Valid Loss: 0.40390
Valid Accuracy: 0.81292
time stamp: 6522.122039556503
[]
best model saved: step =  24999 dev accu =  tensor(0.8160, device='cuda:0')

Validation Results
Global Steps: 24999
Valid Loss: 0.39614
Valid Accuracy: 0.81597
time stamp: 6556.669717550278
[]

Validation Results
Global Steps: 25199
Valid Loss: 0.40430
Valid Accuracy: 0.81584
time stamp: 6592.049122810364
[]
best model saved: step =  25399 dev accu =  tensor(0.8179, device='cuda:0')

Validation Results
Global Steps: 25399
Valid Loss: 0.39437
Valid Accuracy: 0.81790
time stamp: 6626.872170448303
[]

Validation Results
Global Steps: 25599
Valid Loss: 0.40030
Valid Accuracy: 0.81744
time stamp: 6662.0905504226685
[]
best model saved: step =  25799 dev accu =  tensor(0.8200, device='cuda:0')

Validation Results
Global Steps: 25799
Valid Loss: 0.39047
Valid Accuracy: 0.81998
time stamp: 6697.078460216522
[]

Validation Results
Global Steps: 25999
Valid Loss: 0.39297
Valid Accuracy: 0.81719
time stamp: 6731.61438536644
[]
best model saved: step =  26199 dev accu =  tensor(0.8229, device='cuda:0')

Validation Results
Global Steps: 26199
Valid Loss: 0.38923
Valid Accuracy: 0.82292
time stamp: 6766.580568552017
[]

Validation Results
Global Steps: 26399
Valid Loss: 0.39051
Valid Accuracy: 0.82290
time stamp: 6801.4550659656525
[]

Validation Results
Global Steps: 26599
Valid Loss: 0.39255
Valid Accuracy: 0.81917
time stamp: 6836.220185279846
[]

Validation Results
Global Steps: 26799
Valid Loss: 0.38709
Valid Accuracy: 0.82131
time stamp: 6870.970511436462
[]
best model saved: step =  26999 dev accu =  tensor(0.8243, device='cuda:0')

Validation Results
Global Steps: 26999
Valid Loss: 0.38420
Valid Accuracy: 0.82435
time stamp: 6905.710385560989
[]

Validation Results
Global Steps: 27199
Valid Loss: 0.42755
Valid Accuracy: 0.80539
time stamp: 6940.705919504166
[]

Validation Results
Global Steps: 27399
Valid Loss: 0.38943
Valid Accuracy: 0.82310
time stamp: 6975.745592355728
[]
best model saved: step =  27599 dev accu =  tensor(0.8281, device='cuda:0')

Validation Results
Global Steps: 27599
Valid Loss: 0.37636
Valid Accuracy: 0.82813
time stamp: 7010.57489657402
[]
best model saved: step =  27799 dev accu =  tensor(0.8283, device='cuda:0')

Validation Results
Global Steps: 27799
Valid Loss: 0.38113
Valid Accuracy: 0.82826
time stamp: 7045.45623588562
[]

Validation Results
Global Steps: 27999
Valid Loss: 0.38364
Valid Accuracy: 0.82546
time stamp: 7080.957906961441
[]
best model saved: step =  28199 dev accu =  tensor(0.8331, device='cuda:0')

Validation Results
Global Steps: 28199
Valid Loss: 0.36864
Valid Accuracy: 0.83310
time stamp: 7115.755702972412
[]

Validation Results
Global Steps: 28399
Valid Loss: 0.37523
Valid Accuracy: 0.83057
time stamp: 7150.767612934113
[]

Validation Results
Global Steps: 28599
Valid Loss: 0.37928
Valid Accuracy: 0.82785
time stamp: 7185.786886692047
[]

Validation Results
Global Steps: 28799
Valid Loss: 0.38410
Valid Accuracy: 0.82902
time stamp: 7220.7924637794495
[]

Validation Results
Global Steps: 28999
Valid Loss: 0.37134
Valid Accuracy: 0.83184
time stamp: 7255.634917020798
[]

Validation Results
Global Steps: 29199
Valid Loss: 0.37324
Valid Accuracy: 0.83185
time stamp: 7290.34445810318
[]

Validation Results
Global Steps: 29399
Valid Loss: 0.37351
Valid Accuracy: 0.83135
time stamp: 7324.873494625092
[]
best model saved: step =  29599 dev accu =  tensor(0.8373, device='cuda:0')

Validation Results
Global Steps: 29599
Valid Loss: 0.36398
Valid Accuracy: 0.83729
time stamp: 7359.588931560516
[]

Validation Results
Global Steps: 29799
Valid Loss: 0.36677
Valid Accuracy: 0.83678
time stamp: 7394.330600976944
[]
best model saved: step =  29999 dev accu =  tensor(0.8375, device='cuda:0')

Validation Results
Global Steps: 29999
Valid Loss: 0.36719
Valid Accuracy: 0.83753
time stamp: 7428.8870844841
total training step (k): 30.0
total training time (s): 7428.88770699501
total training time (ms): 1624766.3837890625
peak memory usage (MB): 12858
allocated memory usage (MB): 481737969
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |   12024 KB |   12858 MB |  470447 GB |  470447 GB |
|       from large pool |    6144 KB |   12846 MB |  466806 GB |  466806 GB |
|       from small pool |    5880 KB |      27 MB |    3640 GB |    3640 GB |
|---------------------------------------------------------------------------|
| Active memory         |   12024 KB |   12858 MB |  470447 GB |  470447 GB |
|       from large pool |    6144 KB |   12846 MB |  466806 GB |  466806 GB |
|       from small pool |    5880 KB |      27 MB |    3640 GB |    3640 GB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   13776 MB |   13776 MB |   13776 MB |       0 B  |
|       from large pool |   13748 MB |   13748 MB |   13748 MB |       0 B  |
|       from small pool |      28 MB |      28 MB |      28 MB |       0 B  |
|---------------------------------------------------------------------------|
| Non-releasable memory |   12551 KB |    2073 MB |  459816 GB |  459816 GB |
|       from large pool |   10240 KB |    2070 MB |  456024 GB |  456024 GB |
|       from small pool |    2311 KB |       6 MB |    3792 GB |    3792 GB |
|---------------------------------------------------------------------------|
| Allocations           |     398    |     670    |   35690 K  |   35690 K  |
|       from large pool |       2    |      93    |   13500 K  |   13499 K  |
|       from small pool |     396    |     659    |   22190 K  |   22190 K  |
|---------------------------------------------------------------------------|
| Active allocs         |     398    |     670    |   35690 K  |   35690 K  |
|       from large pool |       2    |      93    |   13500 K  |   13499 K  |
|       from small pool |     396    |     659    |   22190 K  |   22190 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      42    |      42    |      42    |       0    |
|       from large pool |      28    |      28    |      28    |       0    |
|       from small pool |      14    |      14    |      14    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       9    |      37    |   16570 K  |   16570 K  |
|       from large pool |       1    |      20    |    5214 K  |    5214 K  |
|       from small pool |       8    |      26    |   11355 K  |   11355 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

loading the best model from: ./checkpoints/checkpoints-9/lra-yelp1/learnable.model
Evaluation Results
Loss: 0.36751
Accuracy: 0.83792
