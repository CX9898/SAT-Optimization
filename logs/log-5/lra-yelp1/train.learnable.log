GPU list: [0, 1, 2, 3]
[
    {
        "learn_pos_emb": true,
        "tied_weights": false,
        "embedding_dim": 64,
        "transformer_dim": 64,
        "transformer_hidden_dim": 128,
        "head_dim": 32,
        "num_head": 2,
        "num_layers": 4,
        "vocab_size": 512,
        "max_seq_len": 1024,
        "dropout_prob": 0.1,
        "attention_dropout": 0.1,
        "pooling_mode": "MEAN",
        "num_classes": 2,
        "block_size": 32,
        "batch_size": 128,
        "density": 0.05,
        "mixed_precision": true,
        "random_seed": 5,
        "task": "lra-yelp1"
    },
    {
        "batch_size": 512,
        "learning_rate": 0.0007,
        "warmup": 80,
        "lr_decay": "linear",
        "weight_decay": 0,
        "eval_frequency": 200,
        "num_train_steps": 30000,
        "num_init_steps": 17000,
        "num_eval_steps": 200,
        "num_dense_train_steps": 1000,
        "patience": 10,
        "attn_loss_scale": 0.01
    }
]
attn_mask compile
attn_mask compile
attn_mask compile
attn_mask compile
DataParallel(
  (module): ModelForSC(
    (model): Model(
      (embeddings): Embeddings(
        (word_embeddings): Embedding(512, 64)
        (position_embeddings): Embedding(1024, 64)
        (dropout): Dropout(p=0.1, inplace=False)
      )
      (transformer_0): TransformerLayer(
        (norm1): LayerNorm((64,), eps=1e-05, elementwise_affine=True)
        (mha): Attention(
          (W_q): Linear(in_features=64, out_features=64, bias=True)
          (W_k): Linear(in_features=64, out_features=64, bias=True)
          (W_v): Linear(in_features=64, out_features=64, bias=True)
          (avg_pool): AvgPool2d(kernel_size=32, stride=32, padding=0)
          (MSEloss): MSELoss()
          (attn): CUDAMaskAttention()
          (ff): Linear(in_features=64, out_features=64, bias=True)
        )
        (dropout1): Dropout(p=0.1, inplace=False)
        (norm2): LayerNorm((64,), eps=1e-05, elementwise_affine=True)
        (mlpblock): Sequential(
          (0): Linear(in_features=64, out_features=128, bias=True)
          (1): GELU(approximate='none')
          (2): Dropout(p=0.1, inplace=False)
          (3): Linear(in_features=128, out_features=64, bias=True)
          (4): Dropout(p=0.1, inplace=False)
        )
      )
      (transformer_1): TransformerLayer(
        (norm1): LayerNorm((64,), eps=1e-05, elementwise_affine=True)
        (mha): Attention(
          (W_q): Linear(in_features=64, out_features=64, bias=True)
          (W_k): Linear(in_features=64, out_features=64, bias=True)
          (W_v): Linear(in_features=64, out_features=64, bias=True)
          (avg_pool): AvgPool2d(kernel_size=32, stride=32, padding=0)
          (MSEloss): MSELoss()
          (attn): CUDAMaskAttention()
          (ff): Linear(in_features=64, out_features=64, bias=True)
        )
        (dropout1): Dropout(p=0.1, inplace=False)
        (norm2): LayerNorm((64,), eps=1e-05, elementwise_affine=True)
        (mlpblock): Sequential(
          (0): Linear(in_features=64, out_features=128, bias=True)
          (1): GELU(approximate='none')
          (2): Dropout(p=0.1, inplace=False)
          (3): Linear(in_features=128, out_features=64, bias=True)
          (4): Dropout(p=0.1, inplace=False)
        )
      )
      (transformer_2): TransformerLayer(
        (norm1): LayerNorm((64,), eps=1e-05, elementwise_affine=True)
        (mha): Attention(
          (W_q): Linear(in_features=64, out_features=64, bias=True)
          (W_k): Linear(in_features=64, out_features=64, bias=True)
          (W_v): Linear(in_features=64, out_features=64, bias=True)
          (avg_pool): AvgPool2d(kernel_size=32, stride=32, padding=0)
          (MSEloss): MSELoss()
          (attn): CUDAMaskAttention()
          (ff): Linear(in_features=64, out_features=64, bias=True)
        )
        (dropout1): Dropout(p=0.1, inplace=False)
        (norm2): LayerNorm((64,), eps=1e-05, elementwise_affine=True)
        (mlpblock): Sequential(
          (0): Linear(in_features=64, out_features=128, bias=True)
          (1): GELU(approximate='none')
          (2): Dropout(p=0.1, inplace=False)
          (3): Linear(in_features=128, out_features=64, bias=True)
          (4): Dropout(p=0.1, inplace=False)
        )
      )
      (transformer_3): TransformerLayer(
        (norm1): LayerNorm((64,), eps=1e-05, elementwise_affine=True)
        (mha): Attention(
          (W_q): Linear(in_features=64, out_features=64, bias=True)
          (W_k): Linear(in_features=64, out_features=64, bias=True)
          (W_v): Linear(in_features=64, out_features=64, bias=True)
          (avg_pool): AvgPool2d(kernel_size=32, stride=32, padding=0)
          (MSEloss): MSELoss()
          (attn): CUDAMaskAttention()
          (ff): Linear(in_features=64, out_features=64, bias=True)
        )
        (dropout1): Dropout(p=0.1, inplace=False)
        (norm2): LayerNorm((64,), eps=1e-05, elementwise_affine=True)
        (mlpblock): Sequential(
          (0): Linear(in_features=64, out_features=128, bias=True)
          (1): GELU(approximate='none')
          (2): Dropout(p=0.1, inplace=False)
          (3): Linear(in_features=128, out_features=64, bias=True)
          (4): Dropout(p=0.1, inplace=False)
        )
      )
      (norm): LayerNorm((64,), eps=1e-05, elementwise_affine=True)
    )
    (seq_classifer): SCHead(
      (mlpblock): Sequential(
        (0): Linear(in_features=64, out_features=128, bias=True)
        (1): ReLU()
        (2): Linear(in_features=128, out_features=2, bias=True)
      )
    )
  )
)
parameter_size: [torch.Size([512, 64]), torch.Size([1024, 64]), torch.Size([64]), torch.Size([64]), torch.Size([32, 32]), torch.Size([64, 64]), torch.Size([64]), torch.Size([64, 64]), torch.Size([64]), torch.Size([64, 64]), torch.Size([64]), torch.Size([64, 64]), torch.Size([64]), torch.Size([64]), torch.Size([64]), torch.Size([128, 64]), torch.Size([128]), torch.Size([64, 128]), torch.Size([64]), torch.Size([64]), torch.Size([64]), torch.Size([32, 32]), torch.Size([64, 64]), torch.Size([64]), torch.Size([64, 64]), torch.Size([64]), torch.Size([64, 64]), torch.Size([64]), torch.Size([64, 64]), torch.Size([64]), torch.Size([64]), torch.Size([64]), torch.Size([128, 64]), torch.Size([128]), torch.Size([64, 128]), torch.Size([64]), torch.Size([64]), torch.Size([64]), torch.Size([32, 32]), torch.Size([64, 64]), torch.Size([64]), torch.Size([64, 64]), torch.Size([64]), torch.Size([64, 64]), torch.Size([64]), torch.Size([64, 64]), torch.Size([64]), torch.Size([64]), torch.Size([64]), torch.Size([128, 64]), torch.Size([128]), torch.Size([64, 128]), torch.Size([64]), torch.Size([64]), torch.Size([64]), torch.Size([32, 32]), torch.Size([64, 64]), torch.Size([64]), torch.Size([64, 64]), torch.Size([64]), torch.Size([64, 64]), torch.Size([64]), torch.Size([64, 64]), torch.Size([64]), torch.Size([64]), torch.Size([64]), torch.Size([128, 64]), torch.Size([128]), torch.Size([64, 128]), torch.Size([64]), torch.Size([64]), torch.Size([64]), torch.Size([128, 64]), torch.Size([128]), torch.Size([2, 128]), torch.Size([2])]
num_parameter: 244994
Loaded ../Skyformer/data/lra_processed/lra-yelp1.train.pickle... size=560000
Loaded ../Skyformer/data/lra_processed/lra-yelp1.dev.pickle... size=38000
Loaded ../Skyformer/data/lra_processed/lra-yelp1.test.pickle... size=38000
accumu_steps=1
[tensor([33.1281, 33.1281, 33.1281, 33.1281], device='cuda:0',
       grad_fn=<GatherBackward>), tensor([25.1407, 25.1407, 25.1407, 25.1408], device='cuda:0',
       grad_fn=<GatherBackward>), tensor([29.2779, 29.2779, 29.2779, 29.2779], device='cuda:0',
       grad_fn=<GatherBackward>), tensor([32.9065, 32.9065, 32.9065, 32.9064], device='cuda:0',
       grad_fn=<GatherBackward>)]
best model saved: step =  199 dev accu =  tensor(0.7174, device='cuda:0')

Validation Results
Global Steps: 199
Valid Loss: 0.55543
Valid Accuracy: 0.71737
time stamp: 163.605295419693
[tensor([14.6048, 14.6048, 14.6048, 14.6048], device='cuda:0',
       grad_fn=<GatherBackward>), tensor([10.7080, 10.7080, 10.7080, 10.7080], device='cuda:0',
       grad_fn=<GatherBackward>), tensor([12.7131, 12.7131, 12.7131, 12.7131], device='cuda:0',
       grad_fn=<GatherBackward>), tensor([14.4360, 14.4360, 14.4360, 14.4360], device='cuda:0',
       grad_fn=<GatherBackward>)]
best model saved: step =  399 dev accu =  tensor(0.7288, device='cuda:0')

Validation Results
Global Steps: 399
Valid Loss: 0.54128
Valid Accuracy: 0.72877
time stamp: 326.4335181713104
[tensor([7.4181, 7.4181, 7.4181, 7.4181], device='cuda:0',
       grad_fn=<GatherBackward>), tensor([5.3427, 5.3427, 5.3428, 5.3427], device='cuda:0',
       grad_fn=<GatherBackward>), tensor([6.3988, 6.3988, 6.3988, 6.3988], device='cuda:0',
       grad_fn=<GatherBackward>), tensor([7.2855, 7.2855, 7.2854, 7.2855], device='cuda:0',
       grad_fn=<GatherBackward>)]

Validation Results
Global Steps: 599
Valid Loss: 0.54343
Valid Accuracy: 0.72687
time stamp: 488.9334361553192
[tensor([4.2171, 4.2171, 4.2171, 4.2171], device='cuda:0',
       grad_fn=<GatherBackward>), tensor([3.0196, 3.0196, 3.0196, 3.0196], device='cuda:0',
       grad_fn=<GatherBackward>), tensor([3.6183, 3.6183, 3.6183, 3.6183], device='cuda:0',
       grad_fn=<GatherBackward>), tensor([4.1090, 4.1090, 4.1090, 4.1090], device='cuda:0',
       grad_fn=<GatherBackward>)]

Validation Results
Global Steps: 799
Valid Loss: 0.53269
Valid Accuracy: 0.72838
time stamp: 651.577714920044
[tensor([2.6241, 2.6240, 2.6240, 2.6241], device='cuda:0',
       grad_fn=<GatherBackward>), tensor([1.8833, 1.8833, 1.8833, 1.8833], device='cuda:0',
       grad_fn=<GatherBackward>), tensor([2.2443, 2.2443, 2.2443, 2.2443], device='cuda:0',
       grad_fn=<GatherBackward>), tensor([2.5335, 2.5335, 2.5335, 2.5335], device='cuda:0',
       grad_fn=<GatherBackward>)]
best model saved: step =  999 dev accu =  tensor(0.7290, device='cuda:0')

Validation Results
Global Steps: 999
Valid Loss: 0.53884
Valid Accuracy: 0.72900
time stamp: 814.2165894508362
[tensor([1.7562, 1.7562, 1.7562, 1.7562], device='cuda:0',
       grad_fn=<GatherBackward>), tensor([1.2697, 1.2697, 1.2697, 1.2697], device='cuda:0',
       grad_fn=<GatherBackward>), tensor([1.4990, 1.4990, 1.4990, 1.4990], device='cuda:0',
       grad_fn=<GatherBackward>), tensor([1.6790, 1.6790, 1.6791, 1.6790], device='cuda:0',
       grad_fn=<GatherBackward>)]
best model saved: step =  1199 dev accu =  tensor(0.7372, device='cuda:0')

Validation Results
Global Steps: 1199
Valid Loss: 0.51914
Valid Accuracy: 0.73723
time stamp: 977.56844830513
[tensor([1.2463, 1.2463, 1.2463, 1.2463], device='cuda:0',
       grad_fn=<GatherBackward>), tensor([0.9098, 0.9098, 0.9098, 0.9098], device='cuda:0',
       grad_fn=<GatherBackward>), tensor([1.0622, 1.0622, 1.0622, 1.0622], device='cuda:0',
       grad_fn=<GatherBackward>), tensor([1.1800, 1.1800, 1.1800, 1.1800], device='cuda:0',
       grad_fn=<GatherBackward>)]

Validation Results
Global Steps: 1399
Valid Loss: 0.53844
Valid Accuracy: 0.72445
time stamp: 1141.1810204982758
[tensor([0.9269, 0.9270, 0.9270, 0.9270], device='cuda:0',
       grad_fn=<GatherBackward>), tensor([0.6834, 0.6834, 0.6834, 0.6834], device='cuda:0',
       grad_fn=<GatherBackward>), tensor([0.7889, 0.7889, 0.7889, 0.7889], device='cuda:0',
       grad_fn=<GatherBackward>), tensor([0.8696, 0.8696, 0.8696, 0.8696], device='cuda:0',
       grad_fn=<GatherBackward>)]
best model saved: step =  1599 dev accu =  tensor(0.7396, device='cuda:0')

Validation Results
Global Steps: 1599
Valid Loss: 0.51878
Valid Accuracy: 0.73962
time stamp: 1305.7449810504913
[tensor([0.7154, 0.7154, 0.7154, 0.7154], device='cuda:0',
       grad_fn=<GatherBackward>), tensor([0.5322, 0.5322, 0.5322, 0.5322], device='cuda:0',
       grad_fn=<GatherBackward>), tensor([0.6080, 0.6080, 0.6080, 0.6080], device='cuda:0',
       grad_fn=<GatherBackward>), tensor([0.6658, 0.6658, 0.6658, 0.6658], device='cuda:0',
       grad_fn=<GatherBackward>)]
best model saved: step =  1799 dev accu =  tensor(0.7399, device='cuda:0')

Validation Results
Global Steps: 1799
Valid Loss: 0.51586
Valid Accuracy: 0.73985
time stamp: 1469.8418712615967
[tensor([0.5682, 0.5682, 0.5682, 0.5682], device='cuda:0',
       grad_fn=<GatherBackward>), tensor([0.4258, 0.4258, 0.4258, 0.4258], device='cuda:0',
       grad_fn=<GatherBackward>), tensor([0.4822, 0.4822, 0.4822, 0.4822], device='cuda:0',
       grad_fn=<GatherBackward>), tensor([0.5254, 0.5255, 0.5255, 0.5255], device='cuda:0',
       grad_fn=<GatherBackward>)]
best model saved: step =  1999 dev accu =  tensor(0.7414, device='cuda:0')

Validation Results
Global Steps: 1999
Valid Loss: 0.51609
Valid Accuracy: 0.74136
time stamp: 1633.4792861938477
[tensor([0.4614, 0.4614, 0.4614, 0.4614], device='cuda:0',
       grad_fn=<GatherBackward>), tensor([0.3478, 0.3478, 0.3478, 0.3478], device='cuda:0',
       grad_fn=<GatherBackward>), tensor([0.3909, 0.3909, 0.3909, 0.3909], device='cuda:0',
       grad_fn=<GatherBackward>), tensor([0.4246, 0.4246, 0.4246, 0.4246], device='cuda:0',
       grad_fn=<GatherBackward>)]

Validation Results
Global Steps: 2199
Valid Loss: 0.51953
Valid Accuracy: 0.74036
time stamp: 1797.7709033489227
[tensor([0.3811, 0.3811, 0.3811, 0.3811], device='cuda:0',
       grad_fn=<GatherBackward>), tensor([0.2884, 0.2884, 0.2883, 0.2883], device='cuda:0',
       grad_fn=<GatherBackward>), tensor([0.3224, 0.3224, 0.3224, 0.3224], device='cuda:0',
       grad_fn=<GatherBackward>), tensor([0.3495, 0.3495, 0.3495, 0.3495], device='cuda:0',
       grad_fn=<GatherBackward>)]

Validation Results
Global Steps: 2399
Valid Loss: 0.51992
Valid Accuracy: 0.74121
time stamp: 1961.657550573349
[tensor([0.3187, 0.3187, 0.3187, 0.3187], device='cuda:0',
       grad_fn=<GatherBackward>), tensor([0.2418, 0.2418, 0.2418, 0.2418], device='cuda:0',
       grad_fn=<GatherBackward>), tensor([0.2692, 0.2692, 0.2692, 0.2692], device='cuda:0',
       grad_fn=<GatherBackward>), tensor([0.2918, 0.2918, 0.2918, 0.2918], device='cuda:0',
       grad_fn=<GatherBackward>)]
best model saved: step =  2599 dev accu =  tensor(0.7433, device='cuda:0')

Validation Results
Global Steps: 2599
Valid Loss: 0.51089
Valid Accuracy: 0.74329
time stamp: 2127.1524267196655
[tensor([0.2691, 0.2691, 0.2691, 0.2691], device='cuda:0',
       grad_fn=<GatherBackward>), tensor([0.2044, 0.2044, 0.2044, 0.2044], device='cuda:0',
       grad_fn=<GatherBackward>), tensor([0.2270, 0.2270, 0.2270, 0.2270], device='cuda:0',
       grad_fn=<GatherBackward>), tensor([0.2462, 0.2462, 0.2462, 0.2462], device='cuda:0',
       grad_fn=<GatherBackward>)]
best model saved: step =  2799 dev accu =  tensor(0.7453, device='cuda:0')

Validation Results
Global Steps: 2799
Valid Loss: 0.51345
Valid Accuracy: 0.74532
time stamp: 2291.4586753845215
[tensor([0.2288, 0.2288, 0.2288, 0.2288], device='cuda:0',
       grad_fn=<GatherBackward>), tensor([0.1739, 0.1739, 0.1739, 0.1739], device='cuda:0',
       grad_fn=<GatherBackward>), tensor([0.1928, 0.1928, 0.1928, 0.1928], device='cuda:0',
       grad_fn=<GatherBackward>), tensor([0.2094, 0.2094, 0.2094, 0.2094], device='cuda:0',
       grad_fn=<GatherBackward>)]

Validation Results
Global Steps: 2999
Valid Loss: 0.52002
Valid Accuracy: 0.73520
time stamp: 2455.3783366680145
[tensor([0.1956, 0.1956, 0.1956, 0.1956], device='cuda:0',
       grad_fn=<GatherBackward>), tensor([0.1486, 0.1486, 0.1486, 0.1486], device='cuda:0',
       grad_fn=<GatherBackward>), tensor([0.1646, 0.1646, 0.1646, 0.1646], device='cuda:0',
       grad_fn=<GatherBackward>), tensor([0.1792, 0.1792, 0.1792, 0.1792], device='cuda:0',
       grad_fn=<GatherBackward>)]

Validation Results
Global Steps: 3199
Valid Loss: 0.51306
Valid Accuracy: 0.74216
time stamp: 2619.6661026477814
[tensor([0.1677, 0.1677, 0.1677, 0.1677], device='cuda:0',
       grad_fn=<GatherBackward>), tensor([0.1273, 0.1273, 0.1273, 0.1273], device='cuda:0',
       grad_fn=<GatherBackward>), tensor([0.1410, 0.1410, 0.1410, 0.1410], device='cuda:0',
       grad_fn=<GatherBackward>), tensor([0.1540, 0.1540, 0.1540, 0.1540], device='cuda:0',
       grad_fn=<GatherBackward>)]

Validation Results
Global Steps: 3399
Valid Loss: 0.51101
Valid Accuracy: 0.74528
time stamp: 2784.7944610118866
[tensor([0.1442, 0.1442, 0.1442, 0.1442], device='cuda:0',
       grad_fn=<GatherBackward>), tensor([0.1094, 0.1094, 0.1094, 0.1094], device='cuda:0',
       grad_fn=<GatherBackward>), tensor([0.1212, 0.1212, 0.1212, 0.1212], device='cuda:0',
       grad_fn=<GatherBackward>), tensor([0.1327, 0.1327, 0.1327, 0.1327], device='cuda:0',
       grad_fn=<GatherBackward>)]

Validation Results
Global Steps: 3599
Valid Loss: 0.51903
Valid Accuracy: 0.74279
time stamp: 2949.666978120804
[tensor([0.1243, 0.1243, 0.1243, 0.1243], device='cuda:0',
       grad_fn=<GatherBackward>), tensor([0.0941, 0.0941, 0.0941, 0.0941], device='cuda:0',
       grad_fn=<GatherBackward>), tensor([0.1043, 0.1043, 0.1043, 0.1043], device='cuda:0',
       grad_fn=<GatherBackward>), tensor([0.1146, 0.1146, 0.1146, 0.1146], device='cuda:0',
       grad_fn=<GatherBackward>)]
best model saved: step =  3799 dev accu =  tensor(0.7455, device='cuda:0')

Validation Results
Global Steps: 3799
Valid Loss: 0.51257
Valid Accuracy: 0.74550
time stamp: 3113.665679216385
[tensor([0.1072, 0.1072, 0.1072, 0.1072], device='cuda:0',
       grad_fn=<GatherBackward>), tensor([0.0810, 0.0810, 0.0810, 0.0810], device='cuda:0',
       grad_fn=<GatherBackward>), tensor([0.0900, 0.0899, 0.0900, 0.0899], device='cuda:0',
       grad_fn=<GatherBackward>), tensor([0.0992, 0.0992, 0.0992, 0.0992], device='cuda:0',
       grad_fn=<GatherBackward>)]
best model saved: step =  3999 dev accu =  tensor(0.7461, device='cuda:0')

Validation Results
Global Steps: 3999
Valid Loss: 0.50617
Valid Accuracy: 0.74612
time stamp: 3279.771189928055
[tensor([0.0925, 0.0925, 0.0925, 0.0925], device='cuda:0',
       grad_fn=<GatherBackward>), tensor([0.0698, 0.0698, 0.0698, 0.0698], device='cuda:0',
       grad_fn=<GatherBackward>), tensor([0.0776, 0.0776, 0.0776, 0.0776], device='cuda:0',
       grad_fn=<GatherBackward>), tensor([0.0858, 0.0858, 0.0858, 0.0858], device='cuda:0',
       grad_fn=<GatherBackward>)]

Validation Results
Global Steps: 4199
Valid Loss: 0.51299
Valid Accuracy: 0.74521
time stamp: 3444.1926503181458
[tensor([0.0798, 0.0798, 0.0798, 0.0798], device='cuda:0',
       grad_fn=<GatherBackward>), tensor([0.0602, 0.0602, 0.0602, 0.0602], device='cuda:0',
       grad_fn=<GatherBackward>), tensor([0.0670, 0.0670, 0.0670, 0.0670], device='cuda:0',
       grad_fn=<GatherBackward>), tensor([0.0743, 0.0743, 0.0743, 0.0743], device='cuda:0',
       grad_fn=<GatherBackward>)]
best model saved: step =  4399 dev accu =  tensor(0.7483, device='cuda:0')

Validation Results
Global Steps: 4399
Valid Loss: 0.51670
Valid Accuracy: 0.74834
time stamp: 3609.3096306324005
[tensor([0.0689, 0.0689, 0.0689, 0.0689], device='cuda:0',
       grad_fn=<GatherBackward>), tensor([0.0519, 0.0519, 0.0519, 0.0519], device='cuda:0',
       grad_fn=<GatherBackward>), tensor([0.0578, 0.0578, 0.0578, 0.0578], device='cuda:0',
       grad_fn=<GatherBackward>), tensor([0.0644, 0.0644, 0.0644, 0.0644], device='cuda:0',
       grad_fn=<GatherBackward>)]

Validation Results
Global Steps: 4599
Valid Loss: 0.50723
Valid Accuracy: 0.74758
time stamp: 3774.385726213455
[tensor([0.0595, 0.0595, 0.0595, 0.0595], device='cuda:0',
       grad_fn=<GatherBackward>), tensor([0.0447, 0.0447, 0.0447, 0.0447], device='cuda:0',
       grad_fn=<GatherBackward>), tensor([0.0499, 0.0499, 0.0499, 0.0499], device='cuda:0',
       grad_fn=<GatherBackward>), tensor([0.0557, 0.0557, 0.0557, 0.0557], device='cuda:0',
       grad_fn=<GatherBackward>)]

Validation Results
Global Steps: 4799
Valid Loss: 0.51845
Valid Accuracy: 0.74514
time stamp: 3938.6525626182556
[tensor([0.0513, 0.0513, 0.0513, 0.0513], device='cuda:0',
       grad_fn=<GatherBackward>), tensor([0.0385, 0.0385, 0.0385, 0.0385], device='cuda:0',
       grad_fn=<GatherBackward>), tensor([0.0430, 0.0430, 0.0430, 0.0430], device='cuda:0',
       grad_fn=<GatherBackward>), tensor([0.0482, 0.0482, 0.0482, 0.0482], device='cuda:0',
       grad_fn=<GatherBackward>)]

Validation Results
Global Steps: 4999
Valid Loss: 0.51153
Valid Accuracy: 0.74830
time stamp: 4103.919373035431
[tensor([0.0442, 0.0442, 0.0442, 0.0442], device='cuda:0',
       grad_fn=<GatherBackward>), tensor([0.0331, 0.0331, 0.0331, 0.0331], device='cuda:0',
       grad_fn=<GatherBackward>), tensor([0.0371, 0.0371, 0.0371, 0.0371], device='cuda:0',
       grad_fn=<GatherBackward>), tensor([0.0417, 0.0417, 0.0417, 0.0417], device='cuda:0',
       grad_fn=<GatherBackward>)]
best model saved: step =  5199 dev accu =  tensor(0.7502, device='cuda:0')

Validation Results
Global Steps: 5199
Valid Loss: 0.50165
Valid Accuracy: 0.75017
time stamp: 4268.447667360306
[tensor([0.0381, 0.0381, 0.0381, 0.0381], device='cuda:0',
       grad_fn=<GatherBackward>), tensor([0.0285, 0.0285, 0.0285, 0.0285], device='cuda:0',
       grad_fn=<GatherBackward>), tensor([0.0320, 0.0320, 0.0320, 0.0320], device='cuda:0',
       grad_fn=<GatherBackward>), tensor([0.0361, 0.0361, 0.0361, 0.0361], device='cuda:0',
       grad_fn=<GatherBackward>)]

Validation Results
Global Steps: 5399
Valid Loss: 0.49834
Valid Accuracy: 0.75015
time stamp: 4433.378574371338
[tensor([0.0328, 0.0328, 0.0328, 0.0328], device='cuda:0',
       grad_fn=<GatherBackward>), tensor([0.0245, 0.0245, 0.0245, 0.0245], device='cuda:0',
       grad_fn=<GatherBackward>), tensor([0.0275, 0.0275, 0.0275, 0.0275], device='cuda:0',
       grad_fn=<GatherBackward>), tensor([0.0311, 0.0311, 0.0311, 0.0311], device='cuda:0',
       grad_fn=<GatherBackward>)]
best model saved: step =  5599 dev accu =  tensor(0.7507, device='cuda:0')

Validation Results
Global Steps: 5599
Valid Loss: 0.50626
Valid Accuracy: 0.75066
time stamp: 4598.3181848526
[tensor([0.0282, 0.0282, 0.0282, 0.0282], device='cuda:0',
       grad_fn=<GatherBackward>), tensor([0.0210, 0.0210, 0.0210, 0.0210], device='cuda:0',
       grad_fn=<GatherBackward>), tensor([0.0237, 0.0237, 0.0237, 0.0237], device='cuda:0',
       grad_fn=<GatherBackward>), tensor([0.0269, 0.0269, 0.0269, 0.0269], device='cuda:0',
       grad_fn=<GatherBackward>)]
best model saved: step =  5799 dev accu =  tensor(0.7520, device='cuda:0')

Validation Results
Global Steps: 5799
Valid Loss: 0.50198
Valid Accuracy: 0.75198
time stamp: 4763.473909139633
[tensor([0.0243, 0.0243, 0.0243, 0.0243], device='cuda:0',
       grad_fn=<GatherBackward>), tensor([0.0180, 0.0180, 0.0180, 0.0180], device='cuda:0',
       grad_fn=<GatherBackward>), tensor([0.0204, 0.0204, 0.0204, 0.0204], device='cuda:0',
       grad_fn=<GatherBackward>), tensor([0.0232, 0.0232, 0.0232, 0.0232], device='cuda:0',
       grad_fn=<GatherBackward>)]
best model saved: step =  5999 dev accu =  tensor(0.7531, device='cuda:0')

Validation Results
Global Steps: 5999
Valid Loss: 0.49639
Valid Accuracy: 0.75307
time stamp: 4928.349187135696
[tensor([0.0209, 0.0209, 0.0209, 0.0209], device='cuda:0',
       grad_fn=<GatherBackward>), tensor([0.0155, 0.0155, 0.0155, 0.0155], device='cuda:0',
       grad_fn=<GatherBackward>), tensor([0.0175, 0.0175, 0.0175, 0.0175], device='cuda:0',
       grad_fn=<GatherBackward>), tensor([0.0200, 0.0200, 0.0200, 0.0200], device='cuda:0',
       grad_fn=<GatherBackward>)]

Validation Results
Global Steps: 6199
Valid Loss: 0.49630
Valid Accuracy: 0.75216
time stamp: 5093.438106298447
[tensor([0.0179, 0.0179, 0.0179, 0.0179], device='cuda:0',
       grad_fn=<GatherBackward>), tensor([0.0133, 0.0133, 0.0133, 0.0133], device='cuda:0',
       grad_fn=<GatherBackward>), tensor([0.0150, 0.0150, 0.0150, 0.0150], device='cuda:0',
       grad_fn=<GatherBackward>), tensor([0.0172, 0.0172, 0.0172, 0.0172], device='cuda:0',
       grad_fn=<GatherBackward>)]
best model saved: step =  6399 dev accu =  tensor(0.7537, device='cuda:0')

Validation Results
Global Steps: 6399
Valid Loss: 0.49638
Valid Accuracy: 0.75367
time stamp: 5257.957043170929
[tensor([0.0154, 0.0154, 0.0154, 0.0154], device='cuda:0',
       grad_fn=<GatherBackward>), tensor([0.0114, 0.0114, 0.0114, 0.0114], device='cuda:0',
       grad_fn=<GatherBackward>), tensor([0.0129, 0.0129, 0.0129, 0.0129], device='cuda:0',
       grad_fn=<GatherBackward>), tensor([0.0148, 0.0148, 0.0148, 0.0148], device='cuda:0',
       grad_fn=<GatherBackward>)]

Validation Results
Global Steps: 6599
Valid Loss: 0.49682
Valid Accuracy: 0.75255
time stamp: 5423.6436421871185
[tensor([0.0132, 0.0132, 0.0132, 0.0132], device='cuda:0',
       grad_fn=<GatherBackward>), tensor([0.0097, 0.0097, 0.0097, 0.0097], device='cuda:0',
       grad_fn=<GatherBackward>), tensor([0.0111, 0.0111, 0.0111, 0.0111], device='cuda:0',
       grad_fn=<GatherBackward>), tensor([0.0127, 0.0127, 0.0127, 0.0127], device='cuda:0',
       grad_fn=<GatherBackward>)]

Validation Results
Global Steps: 6799
Valid Loss: 0.50469
Valid Accuracy: 0.75086
time stamp: 5588.929943561554
[tensor([0.0113, 0.0113, 0.0113, 0.0113], device='cuda:0',
       grad_fn=<GatherBackward>), tensor([0.0083, 0.0083, 0.0083, 0.0083], device='cuda:0',
       grad_fn=<GatherBackward>), tensor([0.0095, 0.0095, 0.0095, 0.0095], device='cuda:0',
       grad_fn=<GatherBackward>), tensor([0.0109, 0.0109, 0.0109, 0.0109], device='cuda:0',
       grad_fn=<GatherBackward>)]

Validation Results
Global Steps: 6999
Valid Loss: 0.49382
Valid Accuracy: 0.75180
time stamp: 5755.41440486908
[tensor([0.0097, 0.0097, 0.0097, 0.0097], device='cuda:0',
       grad_fn=<GatherBackward>), tensor([0.0071, 0.0071, 0.0071, 0.0071], device='cuda:0',
       grad_fn=<GatherBackward>), tensor([0.0081, 0.0081, 0.0081, 0.0081], device='cuda:0',
       grad_fn=<GatherBackward>), tensor([0.0093, 0.0093, 0.0093, 0.0093], device='cuda:0',
       grad_fn=<GatherBackward>)]

Validation Results
Global Steps: 7199
Valid Loss: 0.49368
Valid Accuracy: 0.75354
time stamp: 5920.0222153663635
[tensor([0.0083, 0.0083, 0.0083, 0.0083], device='cuda:0',
       grad_fn=<GatherBackward>), tensor([0.0061, 0.0061, 0.0061, 0.0061], device='cuda:0',
       grad_fn=<GatherBackward>), tensor([0.0069, 0.0069, 0.0069, 0.0069], device='cuda:0',
       grad_fn=<GatherBackward>), tensor([0.0080, 0.0080, 0.0080, 0.0080], device='cuda:0',
       grad_fn=<GatherBackward>)]

Validation Results
Global Steps: 7399
Valid Loss: 0.50414
Valid Accuracy: 0.75097
time stamp: 6084.465748548508
[tensor([0.0071, 0.0071, 0.0071, 0.0071], device='cuda:0',
       grad_fn=<GatherBackward>), tensor([0.0052, 0.0052, 0.0052, 0.0052], device='cuda:0',
       grad_fn=<GatherBackward>), tensor([0.0059, 0.0059, 0.0059, 0.0059], device='cuda:0',
       grad_fn=<GatherBackward>), tensor([0.0068, 0.0068, 0.0068, 0.0068], device='cuda:0',
       grad_fn=<GatherBackward>)]

Validation Results
Global Steps: 7599
Valid Loss: 0.50264
Valid Accuracy: 0.75081
time stamp: 6248.778616905212
[tensor([0.0060, 0.0060, 0.0060, 0.0060], device='cuda:0',
       grad_fn=<GatherBackward>), tensor([0.0044, 0.0044, 0.0044, 0.0044], device='cuda:0',
       grad_fn=<GatherBackward>), tensor([0.0051, 0.0051, 0.0051, 0.0051], device='cuda:0',
       grad_fn=<GatherBackward>), tensor([0.0059, 0.0058, 0.0058, 0.0059], device='cuda:0',
       grad_fn=<GatherBackward>)]
best model saved: step =  7799 dev accu =  tensor(0.7541, device='cuda:0')

Validation Results
Global Steps: 7799
Valid Loss: 0.49701
Valid Accuracy: 0.75405
time stamp: 6414.426488399506
[tensor([0.0051, 0.0051, 0.0051, 0.0051], device='cuda:0',
       grad_fn=<GatherBackward>), tensor([0.0038, 0.0038, 0.0038, 0.0038], device='cuda:0',
       grad_fn=<GatherBackward>), tensor([0.0043, 0.0043, 0.0043, 0.0043], device='cuda:0',
       grad_fn=<GatherBackward>), tensor([0.0050, 0.0050, 0.0050, 0.0050], device='cuda:0',
       grad_fn=<GatherBackward>)]

Validation Results
Global Steps: 7999
Valid Loss: 0.49334
Valid Accuracy: 0.75394
time stamp: 6579.415308475494
[tensor([0.0044, 0.0044, 0.0044, 0.0044], device='cuda:0',
       grad_fn=<GatherBackward>), tensor([0.0032, 0.0032, 0.0032, 0.0032], device='cuda:0',
       grad_fn=<GatherBackward>), tensor([0.0037, 0.0037, 0.0037, 0.0037], device='cuda:0',
       grad_fn=<GatherBackward>), tensor([0.0043, 0.0043, 0.0043, 0.0043], device='cuda:0',
       grad_fn=<GatherBackward>)]
best model saved: step =  8199 dev accu =  tensor(0.7558, device='cuda:0')

Validation Results
Global Steps: 8199
Valid Loss: 0.49365
Valid Accuracy: 0.75579
time stamp: 6744.4706594944
[tensor([0.0037, 0.0037, 0.0037, 0.0037], device='cuda:0',
       grad_fn=<GatherBackward>), tensor([0.0027, 0.0027, 0.0027, 0.0027], device='cuda:0',
       grad_fn=<GatherBackward>), tensor([0.0031, 0.0031, 0.0031, 0.0031], device='cuda:0',
       grad_fn=<GatherBackward>), tensor([0.0036, 0.0036, 0.0036, 0.0036], device='cuda:0',
       grad_fn=<GatherBackward>)]
best model saved: step =  8399 dev accu =  tensor(0.7567, device='cuda:0')

Validation Results
Global Steps: 8399
Valid Loss: 0.49029
Valid Accuracy: 0.75669
time stamp: 6909.615197181702
[tensor([0.0032, 0.0032, 0.0032, 0.0032], device='cuda:0',
       grad_fn=<GatherBackward>), tensor([0.0023, 0.0023, 0.0023, 0.0023], device='cuda:0',
       grad_fn=<GatherBackward>), tensor([0.0027, 0.0027, 0.0027, 0.0027], device='cuda:0',
       grad_fn=<GatherBackward>), tensor([0.0031, 0.0031, 0.0031, 0.0031], device='cuda:0',
       grad_fn=<GatherBackward>)]
best model saved: step =  8599 dev accu =  tensor(0.7579, device='cuda:0')

Validation Results
Global Steps: 8599
Valid Loss: 0.49686
Valid Accuracy: 0.75793
time stamp: 7074.713322639465
[tensor([0.0027, 0.0027, 0.0027, 0.0027], device='cuda:0',
       grad_fn=<GatherBackward>), tensor([0.0020, 0.0020, 0.0020, 0.0020], device='cuda:0',
       grad_fn=<GatherBackward>), tensor([0.0023, 0.0023, 0.0023, 0.0023], device='cuda:0',
       grad_fn=<GatherBackward>), tensor([0.0026, 0.0026, 0.0026, 0.0026], device='cuda:0',
       grad_fn=<GatherBackward>)]

Validation Results
Global Steps: 8799
Valid Loss: 0.49010
Valid Accuracy: 0.75700
time stamp: 7241.042409896851
[tensor([0.0023, 0.0023, 0.0023, 0.0023], device='cuda:0',
       grad_fn=<GatherBackward>), tensor([0.0017, 0.0017, 0.0017, 0.0017], device='cuda:0',
       grad_fn=<GatherBackward>), tensor([0.0019, 0.0019, 0.0019, 0.0019], device='cuda:0',
       grad_fn=<GatherBackward>), tensor([0.0023, 0.0023, 0.0023, 0.0023], device='cuda:0',
       grad_fn=<GatherBackward>)]

Validation Results
Global Steps: 8999
Valid Loss: 0.48983
Valid Accuracy: 0.75750
time stamp: 7406.10134267807
[tensor([0.0020, 0.0020, 0.0020, 0.0020], device='cuda:0',
       grad_fn=<GatherBackward>), tensor([0.0014, 0.0014, 0.0014, 0.0014], device='cuda:0',
       grad_fn=<GatherBackward>), tensor([0.0017, 0.0017, 0.0017, 0.0017], device='cuda:0',
       grad_fn=<GatherBackward>), tensor([0.0019, 0.0019, 0.0019, 0.0019], device='cuda:0',
       grad_fn=<GatherBackward>)]

Validation Results
Global Steps: 9199
Valid Loss: 0.49574
Valid Accuracy: 0.75356
time stamp: 7570.5173461437225
[tensor([0.0017, 0.0017, 0.0017, 0.0017], device='cuda:0',
       grad_fn=<GatherBackward>), tensor([0.0012, 0.0012, 0.0012, 0.0012], device='cuda:0',
       grad_fn=<GatherBackward>), tensor([0.0014, 0.0014, 0.0014, 0.0014], device='cuda:0',
       grad_fn=<GatherBackward>), tensor([0.0016, 0.0016, 0.0016, 0.0016], device='cuda:0',
       grad_fn=<GatherBackward>)]

Validation Results
Global Steps: 9399
Valid Loss: 0.48986
Valid Accuracy: 0.75728
time stamp: 7734.87836766243
[tensor([0.0014, 0.0014, 0.0014, 0.0014], device='cuda:0',
       grad_fn=<GatherBackward>), tensor([0.0010, 0.0010, 0.0010, 0.0010], device='cuda:0',
       grad_fn=<GatherBackward>), tensor([0.0012, 0.0012, 0.0012, 0.0012], device='cuda:0',
       grad_fn=<GatherBackward>), tensor([0.0014, 0.0014, 0.0014, 0.0014], device='cuda:0',
       grad_fn=<GatherBackward>)]
best model saved: step =  9599 dev accu =  tensor(0.7590, device='cuda:0')

Validation Results
Global Steps: 9599
Valid Loss: 0.48770
Valid Accuracy: 0.75904
time stamp: 7899.6445326805115
[tensor([0.0012, 0.0012, 0.0012, 0.0012], device='cuda:0',
       grad_fn=<GatherBackward>), tensor([0.0009, 0.0009, 0.0009, 0.0009], device='cuda:0',
       grad_fn=<GatherBackward>), tensor([0.0010, 0.0010, 0.0010, 0.0010], device='cuda:0',
       grad_fn=<GatherBackward>), tensor([0.0012, 0.0012, 0.0012, 0.0012], device='cuda:0',
       grad_fn=<GatherBackward>)]

Validation Results
Global Steps: 9799
Valid Loss: 0.49005
Valid Accuracy: 0.75808
time stamp: 8064.541338682175
[tensor([0.0010, 0.0010, 0.0010, 0.0010], device='cuda:0',
       grad_fn=<GatherBackward>), tensor([0.0007, 0.0007, 0.0007, 0.0007], device='cuda:0',
       grad_fn=<GatherBackward>), tensor([0.0009, 0.0009, 0.0009, 0.0009], device='cuda:0',
       grad_fn=<GatherBackward>), tensor([0.0010, 0.0010, 0.0010, 0.0010], device='cuda:0',
       grad_fn=<GatherBackward>)]

Validation Results
Global Steps: 9999
Valid Loss: 0.50444
Valid Accuracy: 0.75421
time stamp: 8230.836645841599
[tensor([0.0009, 0.0009, 0.0009, 0.0009], device='cuda:0',
       grad_fn=<GatherBackward>), tensor([0.0006, 0.0006, 0.0006, 0.0006], device='cuda:0',
       grad_fn=<GatherBackward>), tensor([0.0007, 0.0007, 0.0007, 0.0007], device='cuda:0',
       grad_fn=<GatherBackward>), tensor([0.0008, 0.0008, 0.0008, 0.0008], device='cuda:0',
       grad_fn=<GatherBackward>)]

Validation Results
Global Steps: 10199
Valid Loss: 0.49525
Valid Accuracy: 0.75809
time stamp: 8396.382719039917
module.model.transformer_0.mha.pattern saved
module.model.transformer_1.mha.pattern saved
module.model.transformer_2.mha.pattern saved
module.model.transformer_3.mha.pattern saved
./pickle/lra-yelp1/module.model.transformer_0.mha.pattern.pickle
tensor([ 990,  363, 1023,  528,  957,   99,  396,  858,    0,  891,  792,  561,
         165,  231,  297,  660,  330,  594,  429,  759,  132,  495,  627,  693,
         825,   33,  726,  462,  198,  264,   66,  924,  767, 1015,  169,  293,
         793,  824,  529,  560,  405,  684,  697,  821,  764,  919,  146,  580,
         570,  849,   24], device='cuda:0')
tensor(51, device='cuda:0')
block_attn_mask compile
./pickle/lra-yelp1/module.model.transformer_1.mha.pattern.pickle
tensor([  66,  297,  825,  528,  759,  231,  462,  858,  330,  726,  363,  396,
         429,  660,  198,  561,  132,  264,  627,  891,   99,  495,  990,  924,
         792,  165,  594,    0,  957, 1023,   33,  693,   24,  768,  795,  888,
          21,  672,  507,  879,  830,  985,  137,  292,    3,   96,  794,  856,
          50,  577,   15], device='cuda:0')
tensor(51, device='cuda:0')
block_attn_mask compile
./pickle/lra-yelp1/module.model.transformer_2.mha.pattern.pickle
tensor([ 198,   66,  528,  759,  264,  561,  231,  297,  462,    0,  627,  825,
         924,  858,  363,  330,  594,  132,  726,   33,  990, 1023,   99,  660,
         792,  396,  693,  495,  165,  891,  429,  957,  270,  456,  797,  952,
         893,  955,  277,  680,  861,  954,  377,  811,  186,  837,  148,  644,
         281,  808,  176], device='cuda:0')
tensor(51, device='cuda:0')
block_attn_mask compile
./pickle/lra-yelp1/module.model.transformer_3.mha.pattern.pickle
tensor([ 627,    0,  363,  660,  429,  825,  198,  792,  528,  924,   99,  462,
          33,  396,  594,  759,   66,  330,  165,  957,  231,  693,  990, 1023,
         264,  891,  858,  132,  297,  561,  726,  495,  217,  806,   89,  802,
          39,  225,   14,  448,  133,  164,  278,  712,  205,  422,  281,  808,
         731,  886,   31], device='cuda:0')
tensor(51, device='cuda:0')
block_attn_mask compile
total pattern searching time (s): 0.09463787078857422
[]

Validation Results
Global Steps: 10399
Valid Loss: 0.51146
Valid Accuracy: 0.74597
time stamp: 8459.428773880005
[]

Validation Results
Global Steps: 10599
Valid Loss: 0.50118
Valid Accuracy: 0.75158
time stamp: 8493.533282279968
[]

Validation Results
Global Steps: 10799
Valid Loss: 0.49688
Valid Accuracy: 0.75580
time stamp: 8528.30352139473
[]
best model saved: step =  10999 dev accu =  tensor(0.7610, device='cuda:0')

Validation Results
Global Steps: 10999
Valid Loss: 0.48784
Valid Accuracy: 0.76101
time stamp: 8563.11163020134
[]

Validation Results
Global Steps: 11199
Valid Loss: 0.48998
Valid Accuracy: 0.76040
time stamp: 8597.500203847885
[]

Validation Results
Global Steps: 11399
Valid Loss: 0.48979
Valid Accuracy: 0.76076
time stamp: 8632.08348441124
[]
best model saved: step =  11599 dev accu =  tensor(0.7632, device='cuda:0')

Validation Results
Global Steps: 11599
Valid Loss: 0.48307
Valid Accuracy: 0.76315
time stamp: 8666.849508047104
[]
best model saved: step =  11799 dev accu =  tensor(0.7649, device='cuda:0')

Validation Results
Global Steps: 11799
Valid Loss: 0.48451
Valid Accuracy: 0.76488
time stamp: 8701.513095378876
[]

Validation Results
Global Steps: 11999
Valid Loss: 0.48180
Valid Accuracy: 0.76281
time stamp: 8736.447412014008
[]
best model saved: step =  12199 dev accu =  tensor(0.7693, device='cuda:0')

Validation Results
Global Steps: 12199
Valid Loss: 0.47767
Valid Accuracy: 0.76930
time stamp: 8771.350221395493
[]

Validation Results
Global Steps: 12399
Valid Loss: 0.47648
Valid Accuracy: 0.76727
time stamp: 8805.72613286972
[]

Validation Results
Global Steps: 12599
Valid Loss: 0.47494
Valid Accuracy: 0.76751
time stamp: 8840.348052024841
[]

Validation Results
Global Steps: 12799
Valid Loss: 0.48223
Valid Accuracy: 0.76506
time stamp: 8874.799649477005
[]
best model saved: step =  12999 dev accu =  tensor(0.7726, device='cuda:0')

Validation Results
Global Steps: 12999
Valid Loss: 0.46830
Valid Accuracy: 0.77257
time stamp: 8909.103306293488
[]

Validation Results
Global Steps: 13199
Valid Loss: 0.47678
Valid Accuracy: 0.76780
time stamp: 8944.1301612854
[]
best model saved: step =  13399 dev accu =  tensor(0.7754, device='cuda:0')

Validation Results
Global Steps: 13399
Valid Loss: 0.46626
Valid Accuracy: 0.77541
time stamp: 8978.661140680313
[]

Validation Results
Global Steps: 13599
Valid Loss: 0.47799
Valid Accuracy: 0.76873
time stamp: 9013.532425165176
[]

Validation Results
Global Steps: 13799
Valid Loss: 0.46369
Valid Accuracy: 0.77406
time stamp: 9047.944974899292
[]
best model saved: step =  13999 dev accu =  tensor(0.7766, device='cuda:0')

Validation Results
Global Steps: 13999
Valid Loss: 0.46198
Valid Accuracy: 0.77662
time stamp: 9082.371435403824
[]
best model saved: step =  14199 dev accu =  tensor(0.7771, device='cuda:0')

Validation Results
Global Steps: 14199
Valid Loss: 0.46246
Valid Accuracy: 0.77711
time stamp: 9117.081285476685
[]

Validation Results
Global Steps: 14399
Valid Loss: 0.47001
Valid Accuracy: 0.77293
time stamp: 9151.858644723892
[]

Validation Results
Global Steps: 14599
Valid Loss: 0.48072
Valid Accuracy: 0.77199
time stamp: 9186.325855731964
[]

Validation Results
Global Steps: 14799
Valid Loss: 0.46264
Valid Accuracy: 0.77655
time stamp: 9220.845086574554
[]

Validation Results
Global Steps: 14999
Valid Loss: 0.46200
Valid Accuracy: 0.77667
time stamp: 9255.663311004639
[]
best model saved: step =  15199 dev accu =  tensor(0.7802, device='cuda:0')

Validation Results
Global Steps: 15199
Valid Loss: 0.46465
Valid Accuracy: 0.78023
time stamp: 9290.52479672432
[]
best model saved: step =  15399 dev accu =  tensor(0.7810, device='cuda:0')

Validation Results
Global Steps: 15399
Valid Loss: 0.45961
Valid Accuracy: 0.78099
time stamp: 9325.419396162033
[]

Validation Results
Global Steps: 15599
Valid Loss: 0.45760
Valid Accuracy: 0.78051
time stamp: 9360.021810770035
[]

Validation Results
Global Steps: 15799
Valid Loss: 0.46044
Valid Accuracy: 0.77953
time stamp: 9394.705291509628
[]

Validation Results
Global Steps: 15999
Valid Loss: 0.46588
Valid Accuracy: 0.77530
time stamp: 9429.153590679169
[]
best model saved: step =  16199 dev accu =  tensor(0.7831, device='cuda:0')

Validation Results
Global Steps: 16199
Valid Loss: 0.45472
Valid Accuracy: 0.78308
time stamp: 9463.409254789352
[]

Validation Results
Global Steps: 16399
Valid Loss: 0.46064
Valid Accuracy: 0.78059
time stamp: 9498.052047491074
[]
best model saved: step =  16599 dev accu =  tensor(0.7839, device='cuda:0')

Validation Results
Global Steps: 16599
Valid Loss: 0.45365
Valid Accuracy: 0.78392
time stamp: 9533.106486082077
[]

Validation Results
Global Steps: 16799
Valid Loss: 0.45203
Valid Accuracy: 0.78249
time stamp: 9567.723477363586
[]

Validation Results
Global Steps: 16999
Valid Loss: 0.45542
Valid Accuracy: 0.77972
time stamp: 9602.4133644104
[]

Validation Results
Global Steps: 17199
Valid Loss: 0.45817
Valid Accuracy: 0.78101
time stamp: 9636.722927331924
[]
best model saved: step =  17399 dev accu =  tensor(0.7854, device='cuda:0')

Validation Results
Global Steps: 17399
Valid Loss: 0.45037
Valid Accuracy: 0.78540
time stamp: 9671.291304826736
[]

Validation Results
Global Steps: 17599
Valid Loss: 0.45115
Valid Accuracy: 0.78442
time stamp: 9706.35030913353
[]

Validation Results
Global Steps: 17799
Valid Loss: 0.44980
Valid Accuracy: 0.78492
time stamp: 9740.885435819626
[]

Validation Results
Global Steps: 17999
Valid Loss: 0.44775
Valid Accuracy: 0.78442
time stamp: 9775.421550273895
[]

Validation Results
Global Steps: 18199
Valid Loss: 0.45111
Valid Accuracy: 0.78248
time stamp: 9809.84300661087
[]
best model saved: step =  18399 dev accu =  tensor(0.7863, device='cuda:0')

Validation Results
Global Steps: 18399
Valid Loss: 0.44442
Valid Accuracy: 0.78631
time stamp: 9844.474354743958
[]

Validation Results
Global Steps: 18599
Valid Loss: 0.46145
Valid Accuracy: 0.78138
time stamp: 9879.023607969284
[]
best model saved: step =  18799 dev accu =  tensor(0.7874, device='cuda:0')

Validation Results
Global Steps: 18799
Valid Loss: 0.44778
Valid Accuracy: 0.78738
time stamp: 9913.67142701149
[]

Validation Results
Global Steps: 18999
Valid Loss: 0.46179
Valid Accuracy: 0.77890
time stamp: 9948.334856271744
[]

Validation Results
Global Steps: 19199
Valid Loss: 0.45375
Valid Accuracy: 0.78333
time stamp: 9983.143636465073
[]
best model saved: step =  19399 dev accu =  tensor(0.7894, device='cuda:0')

Validation Results
Global Steps: 19399
Valid Loss: 0.44219
Valid Accuracy: 0.78937
time stamp: 10017.80147266388
[]

Validation Results
Global Steps: 19599
Valid Loss: 0.44281
Valid Accuracy: 0.78848
time stamp: 10052.270636081696
[]

Validation Results
Global Steps: 19799
Valid Loss: 0.45094
Valid Accuracy: 0.78681
time stamp: 10086.75618314743
[]

Validation Results
Global Steps: 19999
Valid Loss: 0.44987
Valid Accuracy: 0.78887
time stamp: 10121.373745203018
[]

Validation Results
Global Steps: 20199
Valid Loss: 0.46712
Valid Accuracy: 0.78024
time stamp: 10156.162902355194
[]
best model saved: step =  20399 dev accu =  tensor(0.7898, device='cuda:0')

Validation Results
Global Steps: 20399
Valid Loss: 0.44607
Valid Accuracy: 0.78980
time stamp: 10190.739912748337
[]

Validation Results
Global Steps: 20599
Valid Loss: 0.45314
Valid Accuracy: 0.78559
time stamp: 10224.848326206207
[]
best model saved: step =  20799 dev accu =  tensor(0.7924, device='cuda:0')

Validation Results
Global Steps: 20799
Valid Loss: 0.44424
Valid Accuracy: 0.79237
time stamp: 10259.438049316406
[]

Validation Results
Global Steps: 20999
Valid Loss: 0.46128
Valid Accuracy: 0.78167
time stamp: 10293.94089102745
[]

Validation Results
Global Steps: 21199
Valid Loss: 0.44441
Valid Accuracy: 0.79104
time stamp: 10328.191577196121
[]

Validation Results
Global Steps: 21399
Valid Loss: 0.44457
Valid Accuracy: 0.79103
time stamp: 10362.622189760208
[]
best model saved: step =  21599 dev accu =  tensor(0.7934, device='cuda:0')

Validation Results
Global Steps: 21599
Valid Loss: 0.43924
Valid Accuracy: 0.79342
time stamp: 10397.08911705017
[]

Validation Results
Global Steps: 21799
Valid Loss: 0.43803
Valid Accuracy: 0.79214
time stamp: 10431.608884811401
[]

Validation Results
Global Steps: 21999
Valid Loss: 0.44157
Valid Accuracy: 0.79200
time stamp: 10466.379155158997
[]
best model saved: step =  22199 dev accu =  tensor(0.7950, device='cuda:0')

Validation Results
Global Steps: 22199
Valid Loss: 0.43660
Valid Accuracy: 0.79497
time stamp: 10501.077344417572
[]

Validation Results
Global Steps: 22399
Valid Loss: 0.44776
Valid Accuracy: 0.78958
time stamp: 10535.072583675385
[]

Validation Results
Global Steps: 22599
Valid Loss: 0.43736
Valid Accuracy: 0.79392
time stamp: 10569.381208658218
[]

Validation Results
Global Steps: 22799
Valid Loss: 0.43550
Valid Accuracy: 0.79441
time stamp: 10603.759702682495
[]
best model saved: step =  22999 dev accu =  tensor(0.7969, device='cuda:0')

Validation Results
Global Steps: 22999
Valid Loss: 0.43508
Valid Accuracy: 0.79687
time stamp: 10638.547592878342
[]

Validation Results
Global Steps: 23199
Valid Loss: 0.44738
Valid Accuracy: 0.78764
time stamp: 10673.137119293213
[]

Validation Results
Global Steps: 23399
Valid Loss: 0.43948
Valid Accuracy: 0.79280
time stamp: 10708.110743522644
[]
best model saved: step =  23599 dev accu =  tensor(0.7987, device='cuda:0')

Validation Results
Global Steps: 23599
Valid Loss: 0.43100
Valid Accuracy: 0.79865
time stamp: 10742.825023174286
[]

Validation Results
Global Steps: 23799
Valid Loss: 0.43276
Valid Accuracy: 0.79755
time stamp: 10777.192473649979
[]
best model saved: step =  23999 dev accu =  tensor(0.7999, device='cuda:0')

Validation Results
Global Steps: 23999
Valid Loss: 0.43053
Valid Accuracy: 0.79994
time stamp: 10811.629802465439
[]

Validation Results
Global Steps: 24199
Valid Loss: 0.43557
Valid Accuracy: 0.79448
time stamp: 10846.133777618408
[]

Validation Results
Global Steps: 24399
Valid Loss: 0.43282
Valid Accuracy: 0.79732
time stamp: 10880.74806547165
[]
best model saved: step =  24599 dev accu =  tensor(0.8006, device='cuda:0')

Validation Results
Global Steps: 24599
Valid Loss: 0.42851
Valid Accuracy: 0.80059
time stamp: 10915.229058027267
[]
best model saved: step =  24799 dev accu =  tensor(0.8021, device='cuda:0')

Validation Results
Global Steps: 24799
Valid Loss: 0.42378
Valid Accuracy: 0.80208
time stamp: 10949.590521335602
[]

Validation Results
Global Steps: 24999
Valid Loss: 0.43133
Valid Accuracy: 0.79757
time stamp: 10984.335884332657
[]

Validation Results
Global Steps: 25199
Valid Loss: 0.42773
Valid Accuracy: 0.80145
time stamp: 11018.986850261688
[]

Validation Results
Global Steps: 25399
Valid Loss: 0.42416
Valid Accuracy: 0.80163
time stamp: 11053.31743144989
[]
best model saved: step =  25599 dev accu =  tensor(0.8022, device='cuda:0')

Validation Results
Global Steps: 25599
Valid Loss: 0.43073
Valid Accuracy: 0.80216
time stamp: 11088.170866250992
[]
best model saved: step =  25799 dev accu =  tensor(0.8024, device='cuda:0')

Validation Results
Global Steps: 25799
Valid Loss: 0.43217
Valid Accuracy: 0.80238
time stamp: 11122.897432804108
[]

Validation Results
Global Steps: 25999
Valid Loss: 0.43182
Valid Accuracy: 0.79879
time stamp: 11157.196675300598
[]

Validation Results
Global Steps: 26199
Valid Loss: 0.43093
Valid Accuracy: 0.79854
time stamp: 11191.585235357285
[]

Validation Results
Global Steps: 26399
Valid Loss: 0.42463
Valid Accuracy: 0.80156
time stamp: 11226.098186969757
[]
best model saved: step =  26599 dev accu =  tensor(0.8029, device='cuda:0')

Validation Results
Global Steps: 26599
Valid Loss: 0.42245
Valid Accuracy: 0.80286
time stamp: 11260.376475572586
[]

Validation Results
Global Steps: 26799
Valid Loss: 0.42328
Valid Accuracy: 0.80254
time stamp: 11294.973245382309
[]
best model saved: step =  26999 dev accu =  tensor(0.8034, device='cuda:0')

Validation Results
Global Steps: 26999
Valid Loss: 0.42205
Valid Accuracy: 0.80343
time stamp: 11329.268199682236
[]

Validation Results
Global Steps: 27199
Valid Loss: 0.42198
Valid Accuracy: 0.80241
time stamp: 11363.888590574265
[]
best model saved: step =  27399 dev accu =  tensor(0.8042, device='cuda:0')

Validation Results
Global Steps: 27399
Valid Loss: 0.41695
Valid Accuracy: 0.80416
time stamp: 11398.479914188385
[]
best model saved: step =  27599 dev accu =  tensor(0.8050, device='cuda:0')

Validation Results
Global Steps: 27599
Valid Loss: 0.41607
Valid Accuracy: 0.80497
time stamp: 11432.779156446457
[]

Validation Results
Global Steps: 27799
Valid Loss: 0.42540
Valid Accuracy: 0.80167
time stamp: 11467.405095100403
[]

Validation Results
Global Steps: 27999
Valid Loss: 0.43148
Valid Accuracy: 0.80065
time stamp: 11501.814153671265
[]

Validation Results
Global Steps: 28199
Valid Loss: 0.43096
Valid Accuracy: 0.79888
time stamp: 11536.414789676666
[]
best model saved: step =  28399 dev accu =  tensor(0.8083, device='cuda:0')

Validation Results
Global Steps: 28399
Valid Loss: 0.41613
Valid Accuracy: 0.80828
time stamp: 11570.84413099289
[]

Validation Results
Global Steps: 28599
Valid Loss: 0.41659
Valid Accuracy: 0.80698
time stamp: 11605.34109044075
[]

Validation Results
Global Steps: 28799
Valid Loss: 0.43813
Valid Accuracy: 0.80478
time stamp: 11639.740112781525
[]
best model saved: step =  28999 dev accu =  tensor(0.8084, device='cuda:0')

Validation Results
Global Steps: 28999
Valid Loss: 0.40639
Valid Accuracy: 0.80838
time stamp: 11674.274760007858
[]
best model saved: step =  29199 dev accu =  tensor(0.8115, device='cuda:0')

Validation Results
Global Steps: 29199
Valid Loss: 0.40741
Valid Accuracy: 0.81152
time stamp: 11708.572820663452
[]

Validation Results
Global Steps: 29399
Valid Loss: 0.41602
Valid Accuracy: 0.80926
time stamp: 11743.166205883026
[]

Validation Results
Global Steps: 29599
Valid Loss: 0.40762
Valid Accuracy: 0.81137
time stamp: 11777.696135759354
[]
best model saved: step =  29799 dev accu =  tensor(0.8124, device='cuda:0')

Validation Results
Global Steps: 29799
Valid Loss: 0.40571
Valid Accuracy: 0.81238
time stamp: 11812.120902776718
[]

Validation Results
Global Steps: 29999
Valid Loss: 0.41575
Valid Accuracy: 0.80868
time stamp: 11846.41811466217
total training step (k): 30.0
total training time (s): 11846.418825387955
total training time (ms): 1991340.099609375
peak memory usage (MB): 12858
allocated memory usage (MB): 718808010
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |   12024 KB |   12858 MB |  701960 GB |  701960 GB |
|       from large pool |    6144 KB |   12846 MB |  698124 GB |  698124 GB |
|       from small pool |    5880 KB |      27 MB |    3836 GB |    3836 GB |
|---------------------------------------------------------------------------|
| Active memory         |   12024 KB |   12858 MB |  701960 GB |  701960 GB |
|       from large pool |    6144 KB |   12846 MB |  698124 GB |  698124 GB |
|       from small pool |    5880 KB |      27 MB |    3836 GB |    3836 GB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   13776 MB |   13776 MB |   13776 MB |       0 B  |
|       from large pool |   13748 MB |   13748 MB |   13748 MB |       0 B  |
|       from small pool |      28 MB |      28 MB |      28 MB |       0 B  |
|---------------------------------------------------------------------------|
| Non-releasable memory |   10503 KB |    2073 MB |  394786 GB |  394786 GB |
|       from large pool |   10240 KB |    2070 MB |  390499 GB |  390499 GB |
|       from small pool |     263 KB |       6 MB |    4287 GB |    4287 GB |
|---------------------------------------------------------------------------|
| Allocations           |     398    |     670    |   35613 K  |   35612 K  |
|       from large pool |       2    |      93    |   13500 K  |   13500 K  |
|       from small pool |     396    |     659    |   22112 K  |   22112 K  |
|---------------------------------------------------------------------------|
| Active allocs         |     398    |     670    |   35613 K  |   35612 K  |
|       from large pool |       2    |      93    |   13500 K  |   13500 K  |
|       from small pool |     396    |     659    |   22112 K  |   22112 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      42    |      42    |      42    |       0    |
|       from large pool |      28    |      28    |      28    |       0    |
|       from small pool |      14    |      14    |      14    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       8    |      35    |   17833 K  |   17833 K  |
|       from large pool |       1    |      20    |    5273 K  |    5273 K  |
|       from small pool |       7    |      24    |   12560 K  |   12560 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

loading the best model from: ./checkpoints/checkpoints-5/lra-yelp1/learnable.model
Evaluation Results
Loss: 0.40605
Accuracy: 0.81221
